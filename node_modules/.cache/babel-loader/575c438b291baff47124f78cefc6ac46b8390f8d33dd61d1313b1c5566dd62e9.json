{"ast":null,"code":"\"use strict\";\n\nrequire(\"core-js/modules/es.object.define-property.js\");\nvar _interopRequireDefault = require(\"/Users/yeiccie/Documents/work_space/second-hand-mall/manage_code/node_modules/@babel/runtime/helpers/interopRequireDefault.js\")[\"default\"];\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports[\"default\"] = void 0;\nvar _regeneratorRuntime2 = _interopRequireDefault(require(\"/Users/yeiccie/Documents/work_space/second-hand-mall/manage_code/node_modules/@babel/runtime/helpers/regeneratorRuntime.js\"));\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"/Users/yeiccie/Documents/work_space/second-hand-mall/manage_code/node_modules/@babel/runtime/helpers/asyncToGenerator.js\"));\nrequire(\"core-js/modules/es.array.push.js\");\nrequire(\"core-js/modules/es.date.to-json.js\");\nrequire(\"core-js/modules/es.json.stringify.js\");\nrequire(\"core-js/modules/es.object.keys.js\");\nvar _toolUtil = _interopRequireDefault(require(\"@/utils/toolUtil.js\"));\nvar _config = _interopRequireDefault(require(\"@/utils/config.js\"));\nvar _http = _interopRequireDefault(require(\"@/utils/http.js\"));\nvar _avatar = _interopRequireDefault(require(\"@/assets/img/avatar.png\"));\nvar _default = exports[\"default\"] = {\n  namespaced: true,\n  state: {\n    session: {},\n    username: '管理员',\n    avatar: ''\n  },\n  getters: {\n    session: function session(state) {\n      if (!state.session.id) {\n        return _toolUtil[\"default\"].storageGet('back_session') ? JSON.parse(_toolUtil[\"default\"].storageGet('back_session')) : {};\n      }\n      return state.session;\n    },\n    avatar: function avatar(state) {\n      var key;\n      if (_toolUtil[\"default\"].storageGet('sessionTable') == 'yonghu') {\n        key = 'touxiang';\n      }\n      var avatar = state.session[key];\n      state.avatar = avatar;\n      return avatar ? _config[\"default\"].get().url + avatar : _avatar[\"default\"];\n    }\n  },\n  actions: {\n    getSession: function getSession(_ref) {\n      return (0, _asyncToGenerator2[\"default\"])(/*#__PURE__*/(0, _regeneratorRuntime2[\"default\"])().mark(function _callee() {\n        var commit, sessionTable, res;\n        return (0, _regeneratorRuntime2[\"default\"])().wrap(function _callee$(_context) {\n          while (1) switch (_context.prev = _context.next) {\n            case 0:\n              commit = _ref.commit;\n              sessionTable = _toolUtil[\"default\"].storageGet('sessionTable');\n              if (sessionTable) {\n                _context.next = 5;\n                break;\n              }\n              router.push('/login');\n              return _context.abrupt(\"return\");\n            case 5:\n              _context.next = 7;\n              return _http[\"default\"].get(\"\".concat(sessionTable, \"/session\"));\n            case 7:\n              res = _context.sent;\n              if (res.data.code == 0) {\n                localStorage.setItem('admin_userid', res.data.data.id);\n                commit('set_session', res.data.data);\n              }\n              return _context.abrupt(\"return\", res);\n            case 10:\n            case \"end\":\n              return _context.stop();\n          }\n        }, _callee);\n      }))();\n    },\n    update: function update(_ref2, data) {\n      return (0, _asyncToGenerator2[\"default\"])(/*#__PURE__*/(0, _regeneratorRuntime2[\"default\"])().mark(function _callee2() {\n        var commit, res;\n        return (0, _regeneratorRuntime2[\"default\"])().wrap(function _callee2$(_context2) {\n          while (1) switch (_context2.prev = _context2.next) {\n            case 0:\n              commit = _ref2.commit;\n              _context2.next = 3;\n              return _http[\"default\"].post(\"\".concat(_toolUtil[\"default\"].storageGet('sessionTable'), \"/update\"), data);\n            case 3:\n              res = _context2.sent;\n              if (res.data.code == 0) {\n                commit('assign_session', data);\n              }\n              return _context2.abrupt(\"return\", res);\n            case 6:\n            case \"end\":\n              return _context2.stop();\n          }\n        }, _callee2);\n      }))();\n    },\n    loginOut: function loginOut(_ref3, data) {\n      return (0, _asyncToGenerator2[\"default\"])(/*#__PURE__*/(0, _regeneratorRuntime2[\"default\"])().mark(function _callee3() {\n        var commit;\n        return (0, _regeneratorRuntime2[\"default\"])().wrap(function _callee3$(_context3) {\n          while (1) switch (_context3.prev = _context3.next) {\n            case 0:\n              commit = _ref3.commit;\n              commit('loginOut');\n            case 2:\n            case \"end\":\n              return _context3.stop();\n          }\n        }, _callee3);\n      }))();\n    }\n  },\n  mutations: {\n    set_session: function set_session(state, data) {\n      state.session = data;\n      _toolUtil[\"default\"].storageSet('back_session', JSON.stringify(state.session));\n    },\n    assign_session: function assign_session(state, data) {\n      Object.assign(state.session, JSON.parse(JSON.stringify(data)));\n      _toolUtil[\"default\"].storageSet('back_session', JSON.stringify(state.session));\n    },\n    loginOut: function loginOut(state, data) {\n      state.session = {}, state.username = '管理员', state.avatar = '';\n    }\n  }\n};","map":{"version":3,"names":["_toolUtil","_interopRequireDefault","require","_config","_http","_avatar","_default","exports","namespaced","state","session","username","avatar","getters","id","toolUtil","storageGet","JSON","parse","key","config","get","url","default_avatar","actions","getSession","_ref","_asyncToGenerator2","_regeneratorRuntime2","mark","_callee","commit","sessionTable","res","wrap","_callee$","_context","prev","next","router","push","abrupt","http","concat","sent","data","code","localStorage","setItem","stop","update","_ref2","_callee2","_callee2$","_context2","post","loginOut","_ref3","_callee3","_callee3$","_context3","mutations","set_session","storageSet","stringify","assign_session","Object","assign"],"sources":["/Users/yeiccie/Documents/work_space/second-hand-mall/manage_code/src/store/modules/user.js"],"sourcesContent":["import toolUtil from '@/utils/toolUtil.js'\r\nimport config from '@/utils/config.js'\r\nimport http from '@/utils/http.js'\r\nimport default_avatar from \"@/assets/img/avatar.png\"\r\n\r\nexport default {\r\n    namespaced: true,\r\n    state:{\r\n        session:{},\r\n        username:'管理员',\r\n        avatar:''\r\n    },\r\n    getters:{\r\n        session(state){\r\n            if(!state.session.id){\r\n                return toolUtil.storageGet('back_session')?JSON.parse(toolUtil.storageGet('back_session')):{}\r\n            }\r\n            return state.session\r\n        },\r\n        avatar(state){\r\n            let key;\r\n            if(toolUtil.storageGet('sessionTable') == 'yonghu'){\r\n                key = 'touxiang'\r\n            }\r\n            let avatar = state.session[key]\r\n            state.avatar = avatar\r\n            return avatar?config.get().url+avatar:default_avatar\r\n        },\r\n    },\r\n    actions:{\r\n        async getSession({commit}){\r\n            let sessionTable = toolUtil.storageGet('sessionTable')\r\n            if(!sessionTable){\r\n                router.push('/login')\r\n                return\r\n            }\r\n            let res = await http.get(`${sessionTable}/session`)\r\n            if(res.data.code==0){\r\n                localStorage.setItem('admin_userid',res.data.data.id)\r\n                commit('set_session',res.data.data)\r\n            }\r\n            return res\r\n        },\r\n        async update({commit},data){\r\n            let res = await http.post(`${toolUtil.storageGet('sessionTable')}/update`,data)\r\n            if(res.data.code==0){\r\n                commit('assign_session',data)\r\n            }\r\n            return res\r\n        },\r\n        async loginOut({commit},data){\r\n            commit('loginOut')\r\n        }\r\n    },\r\n    mutations:{\r\n        set_session(state,data){\r\n            state.session = data\r\n            toolUtil.storageSet('back_session',JSON.stringify(state.session))\r\n        },\r\n        assign_session(state,data){\r\n            Object.assign(state.session,JSON.parse(JSON.stringify(data)))\r\n            toolUtil.storageSet('back_session',JSON.stringify(state.session))\r\n        },\r\n        loginOut(state,data){\r\n            state.session={},\r\n            state.username='管理员',\r\n            state.avatar=''\r\n        }\r\n    }\r\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}