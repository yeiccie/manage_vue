/*! @vuemap/vue-amap v2.1.12 */(function(_,y){typeof exports=="object"&&typeof module!="undefined"?y(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],y):(_=typeof globalThis!="undefined"?globalThis:_||self,y(_.VueAMap={},_.Vue))})(this,function(_,y){"use strict";const _o=(t=[])=>{const e=[];return{install:n=>{e.includes(n)||(e.push(n),t.forEach(o=>n.use(o)))}}};function Rt(){const t=[],e="0123456789abcdef";for(let n=0;n<36;n++)t[n]=e.charAt(Math.floor(Math.random()*16));return t[8]=t[13]=t[18]=t[23]="-",t.join("")}function J(t){return t?t instanceof AMap.Map:!1}function Q(t){return t?t instanceof AMap.OverlayGroup:!1}function Mo(t){return t?t instanceof AMap.IndoorMap:!1}function Vr(t){return t?t instanceof AMap.LabelsLayer:!1}function et(t){return t?t instanceof AMap.VectorLayer:!1}function Ue(t){if(!t||t.length<4)return t;const e=t.substring(3,t.length);return t[2].toLowerCase()+e}const Ze=/^on[A-Z]+/;function On(t,e){if(!t)throw new Error("\u8BF7\u4F20\u5165url");const n=document.createElement("script");n.type="text/javascript",n.async=!0,n.defer=!0,n.src=t,document.body.appendChild(n),e&&n.addEventListener("load",()=>{e()})}function Ge(t){return Array.isArray(t)?t.map(Ge):t.toArray()}function kn(t){return t&&t.charAt(0).toUpperCase()+t.slice(1)}function Ye(t,e,n){!t||!t.on||t.on(e,n)}function Ln(t,e,n){!t||!t.off||t.off(e,n)}function Hr(t){return new AMap.Pixel(t[0],t[1])}function Xr(t){return new AMap.Size(t[0],t[1])}function Kr(t){return Array.isArray(t)?t:[t.getX(),t.getY()]}function Bt(t){return new AMap.LngLat(t[0],t[1])}function Jr(t){if(t)return Array.isArray(t)?t.slice():[t.getLng(),t.getLat()]}function Qr(t){return new AMap.Bounds(Bt(t[0]),Bt(t[1]))}const Z=3.141592653589793,Ve=6378245,He=.006693421622965943,Xe=Z*3e3/180;function ts(t,e,n){const o=Z/180*e,i=Math.pow(2,n),a=Math.floor((t+180)/360*i),r=Math.floor((1-Math.asinh(Math.tan(o))/Z)/2*i);return[a,r]}function es(t,e,n){const o=Math.pow(2,n),i=t/o*360-180,a=Math.atan(Math.sinh(Z*(1-2*e/o)))*180/Z;return[i,a]}function ns(t,e){const n=Co(t,e);return xo(n.lng,n.lat)}function os(t,e){const n=Ao(t,e);return Eo(n.lng,n.lat)}function Ao(t,e){let n=wo(t-105,e-35),o=So(t-105,e-35);const i=e/180*Z;let a=Math.sin(i);a=1-He*a*a;const r=Math.sqrt(a);n=n*180/(Ve*(1-He)/(a*r)*Z),o=o*180/(Ve/r*Math.cos(i)*Z);const s=e+n;return{lng:t+o,lat:s}}function xo(t,e){const n=is(t,e),o=t*2-n.lng,i=e*2-n.lat;return{lng:o,lat:i}}function Eo(t,e){const n=Math.sqrt(t*t+e*e)+2e-5*Math.sin(e*Xe),o=Math.atan2(e,t)+3e-6*Math.cos(t*Xe),i=n*Math.cos(o)+.0065,a=n*Math.sin(o)+.006;return{lng:i,lat:a}}function Co(t,e){const n=t-.0065,o=e-.006,i=Math.sqrt(n*n+o*o)-2e-5*Math.sin(o*Xe),a=Math.atan2(o,n)-3e-6*Math.cos(n*Xe),r=i*Math.cos(a),s=i*Math.sin(a);return{lng:r,lat:s}}function is(t,e){let n=wo(t-105,e-35),o=So(t-105,e-35);const i=e/180*Z;let a=Math.sin(i);a=1-He*a*a;const r=Math.sqrt(a);n=n*180/(Ve*(1-He)/(a*r)*Z),o=o*180/(Ve/r*Math.cos(i)*Z);const s=e+n;return{lng:t+o,lat:s}}function wo(t,e){let n=-100+2*t+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return n+=(20*Math.sin(6*t*Z)+20*Math.sin(2*t*Z))*2/3,n+=(20*Math.sin(e*Z)+40*Math.sin(e/3*Z))*2/3,n+=(160*Math.sin(e/12*Z)+320*Math.sin(e*Z/30))*2/3,n}function So(t,e){let n=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return n+=(20*Math.sin(6*t*Z)+20*Math.sin(2*t*Z))*2/3,n+=(20*Math.sin(t*Z)+40*Math.sin(t/3*Z))*2/3,n+=(150*Math.sin(t/12*Z)+300*Math.sin(t/30*Z))*2/3,n}const Oo={visible:{type:Boolean,default:!0},zIndex:{type:Number},reEventWhenUpdate:{type:Boolean,default:!1},extraOptions:{type:Object}},R=t=>Object.assign({},Oo,t);var as=y.defineComponent({inject:{parentInstance:{default:null}},inheritAttrs:!1,props:{visible:{type:Boolean,default:!0},zIndex:{type:Number},reEventWhenUpdate:{type:Boolean,default:!1},extraOptions:{type:Object}},emits:["init"],data(){return{needInitComponents:[],unwatchFns:[],propsRedirect:{},converters:{},isDestroy:!1,cacheEvents:{},isMounted:!1}},created(){this.$amapComponent=null,this.$parentComponent=null},mounted(){this.parentInstance&&(this.parentInstance.$amapComponent?this.register():this.parentInstance.addChildComponent(this.register))},beforeUnmount(){this.$amapComponent&&(this.unregisterEvents(),this.unwatchFns.forEach(t=>t()),this.unwatchFns=[],this.destroyComponent(),this.isDestroy=!0)},beforeUpdate(){this.reEventWhenUpdate&&this.isMounted&&this.$amapComponent&&this.unregisterEvents()},updated(){this.reEventWhenUpdate&&this.isMounted&&this.$amapComponent&&this.registerEvents()},methods:{getHandlerFun(t){return this[`__${t}`]?this[`__${t}`]:this.$amapComponent?this.$amapComponent[`set${kn(t)}`]:null},convertProps(){const t={},{$props:e,propsRedirect:n}=this;this.extraOptions&&Object.assign(t,this.extraOptions);const o=Object.keys(e).reduce((i,a)=>{let r=a;const s=this.convertSignalProp(r,e[r]);return s===void 0||(n&&n[a]&&(r=n[r]),t[r]=s),i},t);return Object.keys(o).forEach(i=>{o[i]=this.convertProxyToRaw(o[i])}),o},convertProxyToRaw(t){return y.isProxy(t)?y.toRaw(t):y.unref(t)},convertSignalProp(t,e){return this.converters&&this.converters[t]?this.converters[t].call(this,e):e},registerEvents(){const t=this.$attrs;Object.keys(t).forEach(e=>{if(Ze.test(e)){const n=Ue(e);Ye(this.$amapComponent,n,t[e]),this.cacheEvents[n]=t[e]}})},unregisterEvents(){Object.keys(this.cacheEvents).forEach(t=>{Ln(this.$amapComponent,t,this.cacheEvents[t]),delete this.cacheEvents[t]})},setPropWatchers(){const{propsRedirect:t,$props:e}=this;Object.keys(e).forEach(n=>{let o=n;t&&t[n]&&(o=t[n]);const i=this.getHandlerFun(o);if(!i)return;const a={deep:!1},r=Object.prototype.toString.call(e[n]);(r==="[object Object]"||r==="[object Array]")&&(a.deep=!0);const s=this.$watch(n,l=>{i.call(this.$amapComponent,this.convertProxyToRaw(this.convertSignalProp(n,l)))},a);this.unwatchFns.push(s)})},initProps(){["editable","visible","zooms"].forEach(t=>{if(this[t]!==void 0){const e=this.getHandlerFun(t);e&&e.call(this.$amapComponent,this.convertProxyToRaw(this.convertSignalProp(t,this[t])))}})},lazyRegister(){const t=this.parentInstance;t&&t.addChildComponent&&t.addChildComponent(this)},addChildComponent(t){this.needInitComponents.push(t)},createChildren(){for(;this.needInitComponents.length>0;)this.needInitComponents[0](),this.needInitComponents.splice(0,1)},register(){this.parentInstance&&!this.$parentComponent&&(this.$parentComponent=this.parentInstance.$amapComponent);const t=this.__initComponent&&this.__initComponent(this.convertProps());t&&t.then?t.then(e=>this.registerRest(e)):this.registerRest(t)},registerRest(t){!this.$amapComponent&&t&&(this.$amapComponent=t),this.registerEvents(),this.initProps(),this.setPropWatchers(),this.$emit("init",this.$amapComponent,this),this.$nextTick(()=>{this.createChildren()}),this.isMounted=!0},$$getInstance(){return this.$amapComponent},destroyComponent(){this.$amapComponent.setMap&&this.$amapComponent.setMap(null),this.$amapComponent.close&&this.$amapComponent.close(),this.$amapComponent.editor&&this.$amapComponent.editor.close()},__visible(t){this.$amapComponent&&this.$amapComponent.show&&this.$amapComponent.hide&&(t===!1?this.$amapComponent.hide():this.$amapComponent.show())},__zIndex(t){this.$amapComponent&&this.$amapComponent.setzIndex&&this.$amapComponent.setzIndex(t)}}});const Nt="parentInstance",B=(t,e)=>{let n=y.getCurrentInstance(),{props:o,attrs:i}=n,a=y.inject(Nt,void 0);const r=e.emits;let s=!1,l;y.onMounted(()=>{a?a.$amapComponent?u():a.addChildComponent(u):e.isRoot&&u()}),y.onBeforeUnmount(()=>{l&&(C(),b(),e.destroyComponent?e.destroyComponent():N(),e.provideData&&(e.provideData.isDestroy=!0),a=void 0,o=void 0,i=void 0,n=void 0,l=void 0)}),y.onBeforeUpdate(()=>{o.reEventWhenUpdate&&s&&l&&C()}),y.onUpdated(()=>{o.reEventWhenUpdate&&s&&l&&x()});const u=()=>{const E=c();t(E,a==null?void 0:a.$amapComponent).then(T=>{l=T,x(),p(),A(),Object.assign(n.ctx,n.exposed),r("init",l,n.ctx),y.nextTick(()=>{S()}).then(),s=!0})},p=()=>{["editable","visible","zooms"].forEach(E=>{if(o[E]!==void 0){const T=M(E);T&&T.call(l,v(m(E,o[E])))}})},d=e.propsRedirect||{},c=()=>{const E={};return o.extraOptions&&Object.assign(E,o.extraOptions),Object.keys(o).forEach(T=>{let D=T;const I=m(D,o[D]);I!==void 0&&(d&&d[T]&&(D=d[D]),E[D]=I)}),E},f=e.converts||{},m=(E,T)=>f&&f[E]?f[E].call(void 0,T):T,v=E=>y.isProxy(E)?y.toRaw(E):y.unref(E);let h=[],g=Object.assign({__visible:E=>{l&&l.show&&l.hide&&(E?l.show():l.hide())},__zIndex(E){l&&l.setzIndex&&l.setzIndex(E)}},e.watchRedirectFn||{});const A=()=>{Object.keys(o).forEach(E=>{let T=E;d&&d[E]&&(T=d[E]);const D=M(T);if(!D)return;const I={deep:!1},tt=Object.prototype.toString.call(o[E]);(tt==="[object Object]"||tt==="[object Array]")&&(I.deep=!0);const Ct=y.watch(()=>o[E],wt=>{D.call(l,v(m(E,wt)))},I);h.push(Ct)})},b=()=>{h.forEach(E=>E()),h=[],g=void 0},M=E=>g[`__${E}`]?g[`__${E}`]:l?l[`set${kn(E)}`]:null,w={},x=()=>{Object.keys(i).forEach(E=>{if(Ze.test(E)){const T=Ue(E);Ye(l,T,i[E]),w[T]=i[E]}})},C=()=>{Object.keys(w).forEach(E=>{Ln(l,E,w[E]),delete w[E]})},S=()=>{const E=e.needInitComponents||[];for(;E.length>0;)E[0](),E.splice(0,1)},N=()=>{l&&(l.setMap&&l.setMap(null),l.close&&l.close(),l.editor&&l.editor.close())};function F(){return l}return{$$getInstance:F,parentInstance:a,isMounted:s}};var z,Ke=z||(z={});Ke.notload="notload",Ke.loading="loading",Ke.loaded="loaded",Ke.failed="failed";let W={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},V={AMap:z.notload,AMapUI:z.notload,Loca:z.notload},pt={AMap:[],AMapUI:[],Loca:[]},$n=[];function rs(t){typeof t=="function"&&(V.AMap===z.loaded?t(window.AMap):$n.push(t))}function Ft(t){let e=[];return t.AMapUI&&e.push(ss(t.AMapUI)),t.Loca&&e.push(ls(t.Loca)),Promise.all(e)}function ss(t){return new Promise((e,n)=>{let o=[];if(t.plugins)for(var i=0;i<t.plugins.length;i+=1)W.AMapUI.plugins.indexOf(t.plugins[i])==-1&&o.push(t.plugins[i]);if(V.AMapUI===z.failed)n("\u524D\u6B21\u8BF7\u6C42 AMapUI \u5931\u8D25");else if(V.AMapUI===z.notload){V.AMapUI=z.loading,W.AMapUI.version=t.version||W.AMapUI.version,i=W.AMapUI.version;let a=document.body||document.head,r=document.createElement("script");r.type="text/javascript",r.src=`https://webapi.amap.com/ui/${i}/main.js`,r.onerror=()=>{V.AMapUI=z.failed,n("\u8BF7\u6C42 AMapUI \u5931\u8D25")},r.onload=()=>{if(V.AMapUI=z.loaded,o.length)window.AMapUI.loadUI(o,function(){for(let s=0,l=o.length;s<l;s++){let u=o[s].split("/").slice(-1)[0];window.AMapUI[u]=arguments[s]}for(e();pt.AMapUI.length;)pt.AMapUI.splice(0,1)[0]()});else for(e();pt.AMapUI.length;)pt.AMapUI.splice(0,1)[0]()},a.appendChild(r)}else V.AMapUI===z.loaded?t.version&&t.version!==W.AMapUI.version?n("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):o.length?window.AMapUI.loadUI(o,function(){for(let a=0,r=o.length;a<r;a++){let s=o[a].split("/").slice(-1)[0];window.AMapUI[s]=arguments[a]}e()}):e():t.version&&t.version!==W.AMapUI.version?n("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C AMapUI \u6DF7\u7528"):pt.AMapUI.push(a=>{a?n(a):o.length?window.AMapUI.loadUI(o,function(){for(let r=0,s=o.length;r<s;r++){let l=o[r].split("/").slice(-1)[0];window.AMapUI[l]=arguments[r]}e()}):e()})})}function ls(t){return new Promise((e,n)=>{if(V.Loca===z.failed)n("\u524D\u6B21\u8BF7\u6C42 Loca \u5931\u8D25");else if(V.Loca===z.notload){V.Loca=z.loading,W.Loca.version=t.version||W.Loca.version;let r=W.Loca.version;var o=W.AMap.version.startsWith("2"),i=r.startsWith("2");if(o&&!i||!o&&i)n("JSAPI \u4E0E Loca \u7248\u672C\u4E0D\u5BF9\u5E94\uFF01\uFF01");else{o=W.key,i=document.body||document.head;var a=document.createElement("script");a.type="text/javascript",a.src=`https://webapi.amap.com/loca?v=${r}&key=${o}`,a.onerror=()=>{V.Loca=z.failed,n("\u8BF7\u6C42 AMapUI \u5931\u8D25")},a.onload=()=>{for(V.Loca=z.loaded,e();pt.Loca.length;)pt.Loca.splice(0,1)[0]()},i.appendChild(a)}}else V.Loca===z.loaded?t.version&&t.version!==W.Loca.version?n("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):e():t.version&&t.version!==W.Loca.version?n("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C Loca \u6DF7\u7528"):pt.Loca.push(r=>{r?n(r):n()})})}var ko={load:function(t){if(typeof window=="undefined")throw Error("AMap JSAPI can only be used in Browser.");return new Promise((e,n)=>{if(V.AMap==z.failed)n("");else if(V.AMap==z.notload){let{key:r,version:s,plugins:l}=t;if(r){window.AMap&&location.host!=="lbs.amap.com"&&n("\u7981\u6B62\u591A\u79CDAPI\u52A0\u8F7D\u65B9\u5F0F\u6DF7\u7528"),W.key=r,W.AMap.version=s||W.AMap.version,W.AMap.plugins=l||W.AMap.plugins,V.AMap=z.loading;var o=document.body||document.head;window.___onAPILoaded=function(u){if(delete window.___onAPILoaded,u)V.AMap=z.failed,n(u);else for(V.AMap=z.loaded,Ft(t).then(()=>{e(window.AMap)}).catch(n);$n.length;)$n.splice(0,1)[0]()};var i=document.createElement("script");i.type="text/javascript",i.src="https://webapi.amap.com/maps?callback=___onAPILoaded&v="+W.AMap.version+"&key="+r+"&plugin="+W.AMap.plugins.join(","),i.onerror=u=>{V.AMap=z.failed,n(u)},o.appendChild(i)}else n("\u8BF7\u586B\u5199key")}else if(V.AMap==z.loaded)if(t.key&&t.key!==W.key)n("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(t.version&&t.version!==W.AMap.version)n("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{if(o=[],t.plugins)for(i=0;i<t.plugins.length;i+=1)W.AMap.plugins.indexOf(t.plugins[i])==-1&&o.push(t.plugins[i]);o.length?window.AMap.plugin(o,()=>{Ft(t).then(()=>{e(window.AMap)}).catch(n)}):Ft(t).then(()=>{e(window.AMap)}).catch(n)}else if(t.key&&t.key!==W.key)n("\u591A\u4E2A\u4E0D\u4E00\u81F4\u7684 key");else if(t.version&&t.version!==W.AMap.version)n("\u4E0D\u5141\u8BB8\u591A\u4E2A\u7248\u672C JSAPI \u6DF7\u7528");else{var a=[];if(t.plugins)for(i=0;i<t.plugins.length;i+=1)W.AMap.plugins.indexOf(t.plugins[i])==-1&&a.push(t.plugins[i]);rs(()=>{a.length?window.AMap.plugin(a,()=>{Ft(t).then(()=>{e(window.AMap)}).catch(n)}):Ft(t).then(()=>{e(window.AMap)}).catch(n)})}})},reset:function(){delete window.AMap,delete window.AMapUI,delete window.Loca,W={key:"",AMap:{version:"1.4.15",plugins:[]},AMapUI:{version:"1.1",plugins:[]},Loca:{version:"1.3.2"}},V={AMap:z.notload,AMapUI:z.notload,Loca:z.notload},pt={AMap:[],AMapUI:[],Loca:[]}}},Lo=typeof global=="object"&&global&&global.Object===Object&&global,us=typeof self=="object"&&self&&self.Object===Object&&self,bt=Lo||us||Function("return this")(),Je=bt.Symbol,$o=Object.prototype,cs=$o.hasOwnProperty,ps=$o.toString,Dt=Je?Je.toStringTag:void 0;function hs(t){var e=cs.call(t,Dt),n=t[Dt];try{t[Dt]=void 0;var o=!0}catch(a){}var i=ps.call(t);return o&&(e?t[Dt]=n:delete t[Dt]),i}var ds=Object.prototype,fs=ds.toString;function ms(t){return fs.call(t)}var ys="[object Null]",gs="[object Undefined]",Io=Je?Je.toStringTag:void 0;function jt(t){return t==null?t===void 0?gs:ys:Io&&Io in Object(t)?hs(t):ms(t)}function St(t){return t!=null&&typeof t=="object"}var vs="[object Symbol]";function bs(t){return typeof t=="symbol"||St(t)&&jt(t)==vs}var In=Array.isArray,_s=/\s/;function Ms(t){for(var e=t.length;e--&&_s.test(t.charAt(e)););return e}var As=/^\s+/;function xs(t){return t&&t.slice(0,Ms(t)+1).replace(As,"")}function ut(t){var e=typeof t;return t!=null&&(e=="object"||e=="function")}var Po=NaN,Es=/^[-+]0x[0-9a-f]+$/i,Cs=/^0b[01]+$/i,ws=/^0o[0-7]+$/i,Ss=parseInt;function To(t){if(typeof t=="number")return t;if(bs(t))return Po;if(ut(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=ut(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=xs(t);var n=Cs.test(t);return n||ws.test(t)?Ss(t.slice(2),n?2:8):Es.test(t)?Po:+t}function Ro(t){return t}var Os="[object AsyncFunction]",ks="[object Function]",Ls="[object GeneratorFunction]",$s="[object Proxy]";function Pn(t){if(!ut(t))return!1;var e=jt(t);return e==ks||e==Ls||e==Os||e==$s}var Tn=bt["__core-js_shared__"],Bo=function(){var t=/[^.]+$/.exec(Tn&&Tn.keys&&Tn.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}();function Is(t){return!!Bo&&Bo in t}var Ps=Function.prototype,Ts=Ps.toString;function Rs(t){if(t!=null){try{return Ts.call(t)}catch(e){}try{return t+""}catch(e){}}return""}var Bs=/[\\^$.*+?()[\]{}|]/g,Ns=/^\[object .+?Constructor\]$/,Fs=Function.prototype,Ds=Object.prototype,js=Fs.toString,zs=Ds.hasOwnProperty,Ws=RegExp("^"+js.call(zs).replace(Bs,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function qs(t){if(!ut(t)||Is(t))return!1;var e=Pn(t)?Ws:Ns;return e.test(Rs(t))}function Us(t,e){return t==null?void 0:t[e]}function Rn(t,e){var n=Us(t,e);return qs(n)?n:void 0}var No=Object.create,Zs=function(){function t(){}return function(e){if(!ut(e))return{};if(No)return No(e);t.prototype=e;var n=new t;return t.prototype=void 0,n}}();function Gs(t,e,n){switch(n.length){case 0:return t.call(e);case 1:return t.call(e,n[0]);case 2:return t.call(e,n[0],n[1]);case 3:return t.call(e,n[0],n[1],n[2])}return t.apply(e,n)}function Ys(t,e){var n=-1,o=t.length;for(e||(e=Array(o));++n<o;)e[n]=t[n];return e}var Vs=800,Hs=16,Xs=Date.now;function Ks(t){var e=0,n=0;return function(){var o=Xs(),i=Hs-(o-n);if(n=o,i>0){if(++e>=Vs)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}function Js(t){return function(){return t}}var Qe=function(){try{var t=Rn(Object,"defineProperty");return t({},"",{}),t}catch(e){}}(),Qs=Qe?function(t,e){return Qe(t,"toString",{configurable:!0,enumerable:!1,value:Js(e),writable:!0})}:Ro,tl=Ks(Qs),el=9007199254740991,nl=/^(?:0|[1-9]\d*)$/;function Fo(t,e){var n=typeof t;return e=e==null?el:e,!!e&&(n=="number"||n!="symbol"&&nl.test(t))&&t>-1&&t%1==0&&t<e}function Bn(t,e,n){e=="__proto__"&&Qe?Qe(t,e,{configurable:!0,enumerable:!0,value:n,writable:!0}):t[e]=n}function tn(t,e){return t===e||t!==t&&e!==e}var ol=Object.prototype,il=ol.hasOwnProperty;function al(t,e,n){var o=t[e];(!(il.call(t,e)&&tn(o,n))||n===void 0&&!(e in t))&&Bn(t,e,n)}function rl(t,e,n,o){var i=!n;n||(n={});for(var a=-1,r=e.length;++a<r;){var s=e[a],l=o?o(n[s],t[s],s,n,t):void 0;l===void 0&&(l=t[s]),i?Bn(n,s,l):al(n,s,l)}return n}var Do=Math.max;function sl(t,e,n){return e=Do(e===void 0?t.length-1:e,0),function(){for(var o=arguments,i=-1,a=Do(o.length-e,0),r=Array(a);++i<a;)r[i]=o[e+i];i=-1;for(var s=Array(e+1);++i<e;)s[i]=o[i];return s[e]=n(r),Gs(t,this,s)}}function ll(t,e){return tl(sl(t,e,Ro),t+"")}var ul=9007199254740991;function jo(t){return typeof t=="number"&&t>-1&&t%1==0&&t<=ul}function Nn(t){return t!=null&&jo(t.length)&&!Pn(t)}function cl(t,e,n){if(!ut(n))return!1;var o=typeof e;return(o=="number"?Nn(n)&&Fo(e,n.length):o=="string"&&e in n)?tn(n[e],t):!1}function pl(t){return ll(function(e,n){var o=-1,i=n.length,a=i>1?n[i-1]:void 0,r=i>2?n[2]:void 0;for(a=t.length>3&&typeof a=="function"?(i--,a):void 0,r&&cl(n[0],n[1],r)&&(a=i<3?void 0:a,i=1),e=Object(e);++o<i;){var s=n[o];s&&t(e,s,o,a)}return e})}var hl=Object.prototype;function zo(t){var e=t&&t.constructor,n=typeof e=="function"&&e.prototype||hl;return t===n}function dl(t,e){for(var n=-1,o=Array(t);++n<t;)o[n]=e(n);return o}var fl="[object Arguments]";function Wo(t){return St(t)&&jt(t)==fl}var qo=Object.prototype,ml=qo.hasOwnProperty,yl=qo.propertyIsEnumerable,Fn=Wo(function(){return arguments}())?Wo:function(t){return St(t)&&ml.call(t,"callee")&&!yl.call(t,"callee")};function gl(){return!1}var Uo=typeof _=="object"&&_&&!_.nodeType&&_,Zo=Uo&&typeof module=="object"&&module&&!module.nodeType&&module,vl=Zo&&Zo.exports===Uo,Go=vl?bt.Buffer:void 0,bl=Go?Go.isBuffer:void 0,Yo=bl||gl,_l="[object Arguments]",Ml="[object Array]",Al="[object Boolean]",xl="[object Date]",El="[object Error]",Cl="[object Function]",wl="[object Map]",Sl="[object Number]",Ol="[object Object]",kl="[object RegExp]",Ll="[object Set]",$l="[object String]",Il="[object WeakMap]",Pl="[object ArrayBuffer]",Tl="[object DataView]",Rl="[object Float32Array]",Bl="[object Float64Array]",Nl="[object Int8Array]",Fl="[object Int16Array]",Dl="[object Int32Array]",jl="[object Uint8Array]",zl="[object Uint8ClampedArray]",Wl="[object Uint16Array]",ql="[object Uint32Array]",U={};U[Rl]=U[Bl]=U[Nl]=U[Fl]=U[Dl]=U[jl]=U[zl]=U[Wl]=U[ql]=!0,U[_l]=U[Ml]=U[Pl]=U[Al]=U[Tl]=U[xl]=U[El]=U[Cl]=U[wl]=U[Sl]=U[Ol]=U[kl]=U[Ll]=U[$l]=U[Il]=!1;function Ul(t){return St(t)&&jo(t.length)&&!!U[jt(t)]}function Zl(t){return function(e){return t(e)}}var Vo=typeof _=="object"&&_&&!_.nodeType&&_,zt=Vo&&typeof module=="object"&&module&&!module.nodeType&&module,Gl=zt&&zt.exports===Vo,Dn=Gl&&Lo.process,Ho=function(){try{var t=zt&&zt.require&&zt.require("util").types;return t||Dn&&Dn.binding&&Dn.binding("util")}catch(e){}}(),Xo=Ho&&Ho.isTypedArray,Ko=Xo?Zl(Xo):Ul,Yl=Object.prototype,Vl=Yl.hasOwnProperty;function Hl(t,e){var n=In(t),o=!n&&Fn(t),i=!n&&!o&&Yo(t),a=!n&&!o&&!i&&Ko(t),r=n||o||i||a,s=r?dl(t.length,String):[],l=s.length;for(var u in t)(e||Vl.call(t,u))&&!(r&&(u=="length"||i&&(u=="offset"||u=="parent")||a&&(u=="buffer"||u=="byteLength"||u=="byteOffset")||Fo(u,l)))&&s.push(u);return s}function Xl(t,e){return function(n){return t(e(n))}}function Kl(t){var e=[];if(t!=null)for(var n in Object(t))e.push(n);return e}var Jl=Object.prototype,Ql=Jl.hasOwnProperty;function tu(t){if(!ut(t))return Kl(t);var e=zo(t),n=[];for(var o in t)o=="constructor"&&(e||!Ql.call(t,o))||n.push(o);return n}function Jo(t){return Nn(t)?Hl(t,!0):tu(t)}var Wt=Rn(Object,"create");function eu(){this.__data__=Wt?Wt(null):{},this.size=0}function nu(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e}var ou="__lodash_hash_undefined__",iu=Object.prototype,au=iu.hasOwnProperty;function ru(t){var e=this.__data__;if(Wt){var n=e[t];return n===ou?void 0:n}return au.call(e,t)?e[t]:void 0}var su=Object.prototype,lu=su.hasOwnProperty;function uu(t){var e=this.__data__;return Wt?e[t]!==void 0:lu.call(e,t)}var cu="__lodash_hash_undefined__";function pu(t,e){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=Wt&&e===void 0?cu:e,this}function _t(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}_t.prototype.clear=eu,_t.prototype.delete=nu,_t.prototype.get=ru,_t.prototype.has=uu,_t.prototype.set=pu;function hu(){this.__data__=[],this.size=0}function en(t,e){for(var n=t.length;n--;)if(tn(t[n][0],e))return n;return-1}var du=Array.prototype,fu=du.splice;function mu(t){var e=this.__data__,n=en(e,t);if(n<0)return!1;var o=e.length-1;return n==o?e.pop():fu.call(e,n,1),--this.size,!0}function yu(t){var e=this.__data__,n=en(e,t);return n<0?void 0:e[n][1]}function gu(t){return en(this.__data__,t)>-1}function vu(t,e){var n=this.__data__,o=en(n,t);return o<0?(++this.size,n.push([t,e])):n[o][1]=e,this}function ht(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}ht.prototype.clear=hu,ht.prototype.delete=mu,ht.prototype.get=yu,ht.prototype.has=gu,ht.prototype.set=vu;var Qo=Rn(bt,"Map");function bu(){this.size=0,this.__data__={hash:new _t,map:new(Qo||ht),string:new _t}}function _u(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function nn(t,e){var n=t.__data__;return _u(e)?n[typeof e=="string"?"string":"hash"]:n.map}function Mu(t){var e=nn(this,t).delete(t);return this.size-=e?1:0,e}function Au(t){return nn(this,t).get(t)}function xu(t){return nn(this,t).has(t)}function Eu(t,e){var n=nn(this,t),o=n.size;return n.set(t,e),this.size+=n.size==o?0:1,this}function Ot(t){var e=-1,n=t==null?0:t.length;for(this.clear();++e<n;){var o=t[e];this.set(o[0],o[1])}}Ot.prototype.clear=bu,Ot.prototype.delete=Mu,Ot.prototype.get=Au,Ot.prototype.has=xu,Ot.prototype.set=Eu;var ti=Xl(Object.getPrototypeOf,Object),Cu="[object Object]",wu=Function.prototype,Su=Object.prototype,ei=wu.toString,Ou=Su.hasOwnProperty,ku=ei.call(Object);function Lu(t){if(!St(t)||jt(t)!=Cu)return!1;var e=ti(t);if(e===null)return!0;var n=Ou.call(e,"constructor")&&e.constructor;return typeof n=="function"&&n instanceof n&&ei.call(n)==ku}function $u(){this.__data__=new ht,this.size=0}function Iu(t){var e=this.__data__,n=e.delete(t);return this.size=e.size,n}function Pu(t){return this.__data__.get(t)}function Tu(t){return this.__data__.has(t)}var Ru=200;function Bu(t,e){var n=this.__data__;if(n instanceof ht){var o=n.__data__;if(!Qo||o.length<Ru-1)return o.push([t,e]),this.size=++n.size,this;n=this.__data__=new Ot(o)}return n.set(t,e),this.size=n.size,this}function kt(t){var e=this.__data__=new ht(t);this.size=e.size}kt.prototype.clear=$u,kt.prototype.delete=Iu,kt.prototype.get=Pu,kt.prototype.has=Tu,kt.prototype.set=Bu;var ni=typeof _=="object"&&_&&!_.nodeType&&_,oi=ni&&typeof module=="object"&&module&&!module.nodeType&&module,Nu=oi&&oi.exports===ni,ii=Nu?bt.Buffer:void 0,ai=ii?ii.allocUnsafe:void 0;function Fu(t,e){if(e)return t.slice();var n=t.length,o=ai?ai(n):new t.constructor(n);return t.copy(o),o}var ri=bt.Uint8Array;function Du(t){var e=new t.constructor(t.byteLength);return new ri(e).set(new ri(t)),e}function ju(t,e){var n=e?Du(t.buffer):t.buffer;return new t.constructor(n,t.byteOffset,t.length)}function zu(t){return typeof t.constructor=="function"&&!zo(t)?Zs(ti(t)):{}}function Wu(t){return function(e,n,o){for(var i=-1,a=Object(e),r=o(e),s=r.length;s--;){var l=r[t?s:++i];if(n(a[l],l,a)===!1)break}return e}}var qu=Wu(),jn=function(){return bt.Date.now()},Uu="Expected a function",Zu=Math.max,Gu=Math.min;function Mt(t,e,n){var o,i,a,r,s,l,u=0,p=!1,d=!1,c=!0;if(typeof t!="function")throw new TypeError(Uu);e=To(e)||0,ut(n)&&(p=!!n.leading,d="maxWait"in n,a=d?Zu(To(n.maxWait)||0,e):a,c="trailing"in n?!!n.trailing:c);function f(x){var C=o,S=i;return o=i=void 0,u=x,r=t.apply(S,C),r}function m(x){return u=x,s=setTimeout(g,e),p?f(x):r}function v(x){var C=x-l,S=x-u,N=e-C;return d?Gu(N,a-S):N}function h(x){var C=x-l,S=x-u;return l===void 0||C>=e||C<0||d&&S>=a}function g(){var x=jn();if(h(x))return A(x);s=setTimeout(g,v(x))}function A(x){return s=void 0,c&&o?f(x):(o=i=void 0,r)}function b(){s!==void 0&&clearTimeout(s),u=0,o=l=i=s=void 0}function M(){return s===void 0?r:A(jn())}function w(){var x=jn(),C=h(x);if(o=arguments,i=this,l=x,C){if(s===void 0)return m(l);if(d)return clearTimeout(s),s=setTimeout(g,e),f(l)}return s===void 0&&(s=setTimeout(g,e)),r}return w.cancel=b,w.flush=M,w}function zn(t,e,n){(n!==void 0&&!tn(t[e],n)||n===void 0&&!(e in t))&&Bn(t,e,n)}function Yu(t){return St(t)&&Nn(t)}function Wn(t,e){if(!(e==="constructor"&&typeof t[e]=="function")&&e!="__proto__")return t[e]}function Vu(t){return rl(t,Jo(t))}function Hu(t,e,n,o,i,a,r){var s=Wn(t,n),l=Wn(e,n),u=r.get(l);if(u){zn(t,n,u);return}var p=a?a(s,l,n+"",t,e,r):void 0,d=p===void 0;if(d){var c=In(l),f=!c&&Yo(l),m=!c&&!f&&Ko(l);p=l,c||f||m?In(s)?p=s:Yu(s)?p=Ys(s):f?(d=!1,p=Fu(l,!0)):m?(d=!1,p=ju(l,!0)):p=[]:Lu(l)||Fn(l)?(p=s,Fn(s)?p=Vu(s):(!ut(s)||Pn(s))&&(p=zu(l))):d=!1}d&&(r.set(l,p),i(p,l,o,a,r),r.delete(l)),zn(t,n,p)}function si(t,e,n,o,i){t!==e&&qu(e,function(a,r){if(i||(i=new kt),ut(a))Hu(t,e,r,n,si,o,i);else{var s=o?o(Wn(t,r),a,r+"",t,e,i):void 0;s===void 0&&(s=a),zn(t,r,s)}},Jo)}var on=pl(function(t,e,n){si(t,e,n)});const Xu={key:"",version:"2.0",plugins:[],serviceHost:"",securityJsCode:""};function Ku(t={}){return t=on({},Xu,t),t.serviceHost?window._AMapSecurityConfig={serviceHost:t.serviceHost}:t.securityJsCode&&(window._AMapSecurityConfig={securityJsCode:t.securityJsCode}),ko.load(t)}const Ju=ko.reset;_.lazyAMapApiLoaderInstance=null;const Qu=t=>{_.lazyAMapApiLoaderInstance||(_.lazyAMapApiLoaderInstance||(t.offline?_.lazyAMapApiLoaderInstance=new Promise(e=>{console.log("@vuemap/vue-amap\u79BB\u7EBF\u90E8\u7F72"),e(window.AMap)}):_.lazyAMapApiLoaderInstance=Ku(t)),_.lazyAMapApiLoaderInstance.then())},tc=R({vid:{type:String},center:{type:Array},zoom:{type:Number},rotation:{type:Number},pitch:{type:Number},viewMode:{type:String},features:{type:Array},layers:{type:Array},zooms:{type:Array},resizeEnable:{type:Boolean,default:!0},dragEnable:{type:Boolean,default:!0},zoomEnable:{type:Boolean,default:!0},jogEnable:{type:Boolean,default:!0},pitchEnable:{type:Boolean,default:!0},rotateEnable:{type:Boolean,default:!0},animateEnable:{type:Boolean,default:!0},keyboardEnable:{type:Boolean,default:!0},doubleClickZoom:{type:Boolean,default:!0},scrollWheel:{type:Boolean,default:!0},touchZoom:{type:Boolean,default:!0},touchZoomCenter:{type:Number},showLabel:{type:Boolean,default:!0},defaultCursor:{type:String},isHotspot:{type:Boolean},mapStyle:{type:String},wallColor:{type:[String,Array]},roofColor:{type:[String,Array]},showBuildingBlock:{type:Boolean,default:!0},showIndoorMap:{type:Boolean,default:!1},skyColor:{type:[String,Array]},labelRejectMask:{type:Boolean,default:!1},mask:{type:Array},WebGLParams:{type:Object},terrain:{type:Boolean,default:!1}}),ec={class:"el-vue-amap-container"},nc=["id"];var qt=y.defineComponent({name:"ElAmap",inheritAttrs:!1,__name:"amap",props:tc,emits:["init","update:zoom","update:center","update:rotation","update:pitch"],setup(t,{expose:e,emit:n}){const o=[],i={$amapComponent:void 0,addChildComponent(c){o.push(c)},isDestroy:!1};y.provide(Nt,i);const a=t,r=n,s=y.ref(a.vid||Rt());let l;const{$$getInstance:u}=B(c=>new Promise((f,m)=>{if(!_.lazyAMapApiLoaderInstance){m(new Error("\u8BF7\u521D\u59CB\u5316initAMapApiLoader"));return}_.lazyAMapApiLoaderInstance.then(()=>{y.nextTick(()=>{l=new AMap.Map(s.value,c),i.$amapComponent=l,p(),f(l)})}).catch(v=>{m(v)})}),{isRoot:!0,emits:r,needInitComponents:o,provideData:i,watchRedirectFn:{__dragEnable(c){l&&l.setStatus({dragEnable:c})},__zoomEnable(c){l&&l.setStatus({zoomEnable:c})},__jogEnable(c){l&&l.setStatus({jogEnable:c})},__keyboardEnable(c){l&&l.setStatus({keyboardEnable:c})},__doubleClickZoom(c){l&&l.setStatus({doubleClickZoom:c})},__scrollWheel(c){l&&l.setStatus({scrollWheel:c})},__rotateEnable(c){l&&l.setStatus({rotateEnable:c})},__pitchEnable(c){l&&l.setStatus({pitchEnable:c})},__resizeEnable(c){l&&l.setStatus({resizeEnable:c})},__showIndoorMap(c){l&&l.setStatus({showIndoorMap:c})}}}),p=()=>{l.on("zoomchange",()=>{r("update:zoom",l.getZoom())}),l.on("rotateend",()=>{r("update:rotation",l.getRotation())}),l.on("dragging",()=>{r("update:center",d())}),l.on("dragend",()=>{r("update:pitch",l.getPitch())}),l.on("touchmove",()=>{r("update:center",d())})},d=()=>{const c=l.getCenter();return[c.lng,c.lat]};return y.onBeforeUnmount(()=>{l&&(l.clearEvents(),l.destroy(),l=null)}),e({$$getInstance:u}),(c,f)=>(y.openBlock(),y.createElementBlock("div",ec,[y.createElementVNode("div",{id:s.value,class:"el-vue-amap"},null,8,nc),y.renderSlot(c.$slots,"default")]))}});qt.__file="src/vue-amap/packages/amap/amap.vue",qt.install=t=>(t.component(qt.name,qt),t);const li=qt;var Ut=y.defineComponent({name:"ElAmapControlControlBar",inheritAttrs:!1,__name:"ControlBar",props:R({position:{type:[String,Object]},offset:{type:Array},showControlButton:{type:Boolean,default:!0}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{l.plugin(["AMap.ControlBar"],()=>{i=new AMap.ControlBar(s),l.addControl(i),u(i)})}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.removeControl(i),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});Ut.__file="src/vue-amap/packages/control/ControlBar/ControlBar.vue",Ut.install=t=>(t.component(Ut.name,Ut),t);const ui=Ut,oc=R({autoMove:{type:Boolean,default:!0},showRectangle:{type:Boolean,default:!0},showButton:{type:Boolean,default:!0},isOpen:{type:Boolean,default:!0},mapStyle:{type:String},layers:{type:Array},width:{type:String},height:{type:String},offset:{type:Array},borderStyle:{type:String},borderColor:{type:String},borderRadius:{type:String},borderWidth:{type:String},buttonSize:{type:String}});var Zt=y.defineComponent({name:"ElAmapControlHawkEye",inheritAttrs:!1,__name:"HawkEye",props:oc,emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{l.plugin(["AMap.HawkEye"],()=>{i=new AMap.HawkEye(s),l.addControl(i),u(i)})}),{emits:o,watchRedirectFn:{__isOpen(s){s?i.open():i.close()}},destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.removeControl(i),i=null)}});return e({$$getInstance:a}),(s,l)=>null}});Zt.__file="src/vue-amap/packages/control/HawkEye/HawkEye.vue",Zt.install=t=>(t.component(Zt.name,Zt),t);const ci=Zt;var Gt=y.defineComponent({name:"ElAmapControlMapType",inheritAttrs:!1,__name:"MapType",props:R({defaultType:{type:Number},showTraffic:{type:Boolean,default:!1},showRoad:{type:Boolean,default:!1}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{l.plugin(["AMap.MapType"],()=>{i=new AMap.MapType(s),l.addControl(i),u(i)})}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.removeControl(i),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});Gt.__file="src/vue-amap/packages/control/MapType/MapType.vue",Gt.install=t=>(t.component(Gt.name,Gt),t);const pi=Gt;var Yt=y.defineComponent({name:"ElAmapControlScale",inheritAttrs:!1,__name:"Scale",props:R({position:{type:[String,Object]},offset:{type:Array}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{l.plugin(["AMap.Scale"],()=>{i=new AMap.Scale(s),l.addControl(i),u(i)})}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.removeControl(i),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});Yt.__file="src/vue-amap/packages/control/Scale/Scale.vue",Yt.install=t=>(t.component(Yt.name,Yt),t);const hi=Yt;var Vt=y.defineComponent({name:"ElAmapControlToolBar",inheritAttrs:!1,__name:"ToolBar",props:R({position:{type:[String,Object]},offset:{type:Array}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{l.plugin(["AMap.ToolBar"],()=>{i=new AMap.ToolBar(s),l.addControl(i),u(i)})}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.removeControl(i),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});Vt.__file="src/vue-amap/packages/control/ToolBar/ToolBar.vue",Vt.install=t=>(t.component(Vt.name,Vt),t);const di=Vt,ic=R({type:{type:String},city:{type:String},datatype:{type:String},citylimit:{type:Boolean,default:!1},inputId:{type:String},inputCustom:{type:Boolean,default:!1},outputId:{type:String},outPutDirAuto:{type:Boolean,default:!0},closeResultOnScroll:{type:Boolean,default:!0},lang:{type:String},placeholder:{type:String},debounce:{type:Number,default:100}}),ac={class:"el-vue-search-box-container"},rc=["id","placeholder"];var Ht=y.defineComponent({name:"ElAmapSearchBox",inheritAttrs:!1,__name:"SearchBox",props:ic,emits:["init"],setup(t,{expose:e,emit:n}){const o=t,i=n,a=y.ref(Rt()),r=y.ref(!0);let s,l;const{$$getInstance:u}=B((p,d)=>{p.inputId&&(a.value=p.inputId,delete p.inputId),p.visible&&(r.value=p.visible),p.input=a.value,p.outputId&&(p.output=p.outputId,delete p.outputId);let c;return new Promise(f=>{d.plugin(["AMap.AutoComplete"],()=>{const m=o.debounce;l=AMap.Autocomplete.prototype.onInPut,AMap.Autocomplete.prototype.onInPut=function(){clearTimeout(c),c=setTimeout(()=>{this.output&&this.autoSearch()},m)},s=new AMap.AutoComplete(p),f(s)})})},{emits:i,watchRedirectFn:{__visible(p){r.value=p},__citylimit(p){s.setCityLimit(p)}},destroyComponent(){l&&AMap.Autocomplete&&(AMap.Autocomplete.prototype.onInPut=l)}});return e({$$getInstance:u}),(p,d)=>y.withDirectives((y.openBlock(),y.createElementBlock("div",ac,[p.inputCustom?y.createCommentVNode("v-if",!0):(y.openBlock(),y.createElementBlock("input",{key:0,id:a.value,type:"text",placeholder:p.placeholder},null,8,rc))],512)),[[y.vShow,p.visible&&!p.inputCustom]])}});Ht.__file="src/vue-amap/packages/control/SearchBox/SearchBox.vue",Ht.install=t=>(t.component(Ht.name,Ht),t);const fi=Ht,sc=R({isCustom:{type:Boolean,default:!1},autoMove:{type:Boolean,default:!0},avoid:{type:Array},closeWhenClickMap:{type:Boolean,default:!1},content:{type:Object},size:{type:Array},anchor:{type:String},offset:{type:Array},position:{type:Object}}),lc={style:{display:"none"}};var Xt=y.defineComponent({name:"ElAmapInfoWindow",inheritAttrs:!1,__name:"InfoWindow",props:sc,emits:["init","update:visible"],setup(t,{expose:e,emit:n}){const o=t,i=n,a=!o.content,r=`info-${Rt()}`,s=y.ref("");let l;const{$$getInstance:u,parentInstance:p}=B((d,c)=>new Promise(f=>{d.content||(d.content=`<div id="${r}"></div>`),l=new AMap.InfoWindow(d),l.on("close",()=>{i("update:visible",!1)}),o.visible&&(l.open(c,o.position),a&&(s.value=r)),f(l)}),{emits:i,watchRedirectFn:{__position(d){o.visible?(l.open(p==null?void 0:p.$amapComponent,d),a&&(s.value=r)):l.setPosition(d)},__visible(d){const c=l.getPosition();c&&(d?(l.open(p==null?void 0:p.$amapComponent,[c.lng,c.lat]),a&&(s.value=r)):l.close())}},destroyComponent(){l&&(l.getIsOpen()&&l.close(),l=null)}});return y.onUnmounted(()=>{l&&l.close()}),e({$$getInstance:u}),(d,c)=>(y.openBlock(),y.createElementBlock("div",lc,[s.value?(y.openBlock(),y.createBlock(y.Teleport,{key:0,to:"#"+s.value},[y.renderSlot(d.$slots,"default")],8,["to"])):y.createCommentVNode("v-if",!0)]))}});Xt.__file="src/vue-amap/packages/infoWindow/InfoWindow/InfoWindow.vue",Xt.install=t=>(t.component(Xt.name,Xt),t);const mi=Xt;var Kt=y.defineComponent({name:"ElAmapLayerCanvas",inheritAttrs:!1,__name:"Canvas",props:R({canvas:{required:!0,type:Object},zooms:{type:Array},bounds:{type:[Array,Object]},opacity:{type:Number}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{i=new AMap.CanvasLayer(s),l.addLayer(i),u(i)}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.removeLayer(i),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});Kt.__file="src/vue-amap/packages/layer/data/Canvas/Canvas.vue",Kt.install=t=>(t.component(Kt.name,Kt),t);const yi=Kt;var Jt=y.defineComponent({name:"ElAmapLayerCustom",inheritAttrs:!1,__name:"Custom",props:R({canvas:{required:!0,type:Object},render:{type:Function},zooms:{type:Array},opacity:{type:Number},alwaysRender:{type:Boolean,default:!1}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{const p=s.canvas;delete s.canvas,i=new AMap.CustomLayer(p,s),i.setMap(l),u(i)}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(i.setMap(null),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});Jt.__file="src/vue-amap/packages/layer/data/Custom/Custom.vue",Jt.install=t=>(t.component(Jt.name,Jt),t);const gi=Jt;var Qt=y.defineComponent({name:"ElAmapLayerFlexible",inheritAttrs:!1,__name:"Flexible",props:R({cacheSize:{type:Number},createTile:{type:Function},zooms:{type:Array},opacity:{type:Object},tileSize:{type:Number}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{i=new AMap.TileLayer.Flexible(s),i.setMap(l),u(i)}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(i.destroy(),i.setMap(null),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});Qt.__file="src/vue-amap/packages/layer/data/Flexible/Flexible.vue",Qt.install=t=>(t.component(Qt.name,Qt),t);const vi=Qt;var te=y.defineComponent({name:"ElAmapLayerGlCustom",inheritAttrs:!1,__name:"GLCustom",props:R({init:{type:Function},render:{type:Function},zooms:{type:Array},opacity:{type:Number}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a}=B((r,s)=>new Promise(l=>{i=new AMap.GLCustomLayer(r),i.setMap(s),l(i)}),{emits:o,destroyComponent(){i&&(i.setMap(null),i=null)}});return e({$$getInstance:a}),(r,s)=>(y.openBlock(),y.createElementBlock("div"))}});te.__file="src/vue-amap/packages/layer/data/GLCustom/GLCustom.vue",te.install=t=>(t.component(te.name,te),t);const bi=te;var ee=y.defineComponent({name:"ElAmapLayerHeatMap",inheritAttrs:!1,__name:"HeatMap",props:R({radius:{type:Number},gradient:{type:Object},zooms:{type:Array},opacity:{type:Object},config:{type:Object},dataSet:{type:Object}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=t,i=n;let a;const{$$getInstance:r,parentInstance:s}=B((l,u)=>new Promise(p=>{AMap.plugin(["AMap.HeatMap"],()=>{delete l.dataSet,a=new AMap.HeatMap(u,l),o.dataSet&&a.setDataSet(o.dataSet),p(a)})}),{emits:i,destroyComponent(){a&&s!=null&&s.$amapComponent&&(a.setDataSet({data:[],max:0}),a.setMap(null),a=null)}});return e({$$getInstance:r}),(l,u)=>(y.openBlock(),y.createElementBlock("div"))}});ee.__file="src/vue-amap/packages/layer/data/HeatMap/HeatMap.vue",ee.install=t=>(t.component(ee.name,ee),t);const _i=ee;var ne=y.defineComponent({name:"ElAmapLayerImage",inheritAttrs:!1,__name:"Image",props:R({url:{type:String,required:!0},zoom:{type:Array},bounds:{type:[Array,Object]},opacity:{type:Number}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{i=new AMap.ImageLayer(s),l.addLayer(i),u(i)}),{emits:o,watchRedirectFn:{__url(s){i.setImageUrl(s)}},destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.removeLayer(i),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});ne.__file="src/vue-amap/packages/layer/data/Image/Image.vue",ne.install=t=>(t.component(ne.name,ne),t);const Mi=ne;var oe=y.defineComponent({name:"ElAmapLayerLabels",inheritAttrs:!1,__name:"Labels",props:R({zooms:{type:Array},opacity:{type:Number},collision:{type:Boolean,default:!0},allowCollision:{type:Boolean,default:!1}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=[],i={$amapComponent:void 0,addChildComponent(u){o.push(u)},isDestroy:!1};y.provide(Nt,i);const a=n;let r;const{$$getInstance:s,parentInstance:l}=B((u,p)=>new Promise(d=>{r=new AMap.LabelsLayer(u),p.add(r),i.$amapComponent=r,d(r)}),{emits:a,needInitComponents:o,provideData:i,destroyComponent(){r&&l!=null&&l.$amapComponent&&(l!=null&&l.isDestroy||l==null||l.$amapComponent.removeLayer(r),r=null)}});return e({$$getInstance:s,$$add:u=>{r.add(u)}}),(u,p)=>(y.openBlock(),y.createElementBlock("div",null,[y.renderSlot(u.$slots,"default")]))}});oe.__file="src/vue-amap/packages/layer/data/Labels/Labels.vue",oe.install=t=>(t.component(oe.name,oe),t);const Ai=oe;var ie=y.defineComponent({name:"ElAmapLayerVector",inheritAttrs:!1,__name:"Vector",props:R({}),emits:["init"],setup(t,{expose:e,emit:n}){const o=[],i={$amapComponent:void 0,addChildComponent(u){o.push(u)},isDestroy:!1};y.provide(Nt,i);const a=n;let r;const{$$getInstance:s,parentInstance:l}=B((u,p)=>new Promise(d=>{r=new AMap.VectorLayer(u),p.add(r),d(r)}),{emits:a,needInitComponents:o,provideData:i,destroyComponent(){r&&l!=null&&l.$amapComponent&&(l!=null&&l.isDestroy||l==null||l.$amapComponent.removeLayer(r),r=null)}});return e({$$getInstance:s}),(u,p)=>(y.openBlock(),y.createElementBlock("div",null,[y.renderSlot(u.$slots,"default")]))}});ie.__file="src/vue-amap/packages/layer/data/Vector/Vector.vue",ie.install=t=>(t.component(ie.name,ie),t);const xi=ie;var ae=y.defineComponent({name:"ElAmapLayerBuildings",inheritAttrs:!1,__name:"Buildings",props:R({wallColor:{type:[String,Array]},roofColor:{type:[String,Array]},heightFactor:{type:Number},styleOpts:{type:Object},zooms:{type:Array},opacity:{type:Number}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=t,i=n;let a;const{$$getInstance:r,parentInstance:s}=B((l,u)=>new Promise(p=>{a=new AMap.Buildings(l),u.add(a),o.styleOpts&&a.setStyle(o.styleOpts),p(a)}),{emits:i,watchRedirectFn:{__styleOpts(l){a.setStyle(l)}},destroyComponent(){a&&s!=null&&s.$amapComponent&&(s!=null&&s.isDestroy||s==null||s.$amapComponent.remove(a),a=null)}});return e({$$getInstance:r}),(l,u)=>(y.openBlock(),y.createElementBlock("div"))}});ae.__file="src/vue-amap/packages/layer/official/Buildings/Buildings.vue",ae.install=t=>(t.component(ae.name,ae),t);const Ei=ae;var re=y.defineComponent({name:"ElAmapLayerDefault",inheritAttrs:!1,__name:"DefaultLayer",props:R({zoom:{type:Array},opacity:{type:Number}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{i=AMap.createDefaultLayer(s),l.add(i),u(i)}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.remove(i),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});re.__file="src/vue-amap/packages/layer/official/DefaultLayer/DefaultLayer.vue",re.install=t=>(t.component(re.name,re),t);const Ci=re;var se=y.defineComponent({name:"ElAmapLayerDistrict",inheritAttrs:!1,__name:"DistrictLayer",props:R({type:{type:String,default:"Country",validator:t=>["World","Country","Province"].indexOf(t)!==-1},adcode:{type:String},SOC:{type:String},depth:{type:Number},zooms:{type:Array},opacity:{type:Number},styles:{type:Object}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=t,i=n;let a;const{$$getInstance:r,parentInstance:s}=B((l,u)=>new Promise(p=>{o.type==="World"?a=new AMap.DistrictLayer.World(l):o.type==="Country"?a=new AMap.DistrictLayer.Country(l):o.type==="Province"&&(a=new AMap.DistrictLayer.Province(l)),u.add(a),p(a)}),{emits:i,watchRedirectFn:{__SOC(l){a.setSOC(l)}},destroyComponent(){a&&s!=null&&s.$amapComponent&&(s!=null&&s.isDestroy||s==null||s.$amapComponent.remove(a),a=null)}});return e({$$getInstance:r}),(l,u)=>(y.openBlock(),y.createElementBlock("div"))}});se.__file="src/vue-amap/packages/layer/official/DistrictLayer/DistrictLayer.vue",se.install=t=>(t.component(se.name,se),t);const wi=se;var le=y.defineComponent({name:"ElAmapLayerIndoorMap",inheritAttrs:!1,__name:"IndoorMap",props:R({opacity:{type:Number},cursor:{type:String},hideFloorBar:{type:Boolean,default:!1}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{AMap.plugin(["AMap.IndoorMap"],()=>{i=new AMap.IndoorMap(s);const p=l.getLayers();p.push(i),l.setLayers(p),u(i)})}),{emits:o,watchRedirectFn:{__hideFloorBar(s){s?i.showFloorBar():i.hideFloorBar()}},destroyComponent(){if(i&&r!=null&&r.$amapComponent){const s=r.$amapComponent.getLayers();let l=-1;for(let u=0;u<s.length;u++)if(Mo(s[u])){l=u;break}l>-1&&(s.splice(l,1),r.$amapComponent.setLayers(s)),i=null}}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});le.__file="src/vue-amap/packages/layer/official/IndoorMap/IndoorMap.vue",le.install=t=>(t.component(le.name,le),t);const Si=le;var ue=y.defineComponent({name:"ElAmapLayerRoadNet",inheritAttrs:!1,__name:"RoadNet",props:R({zooms:{type:Array},opacity:{type:Number},tileSize:{type:Number}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{i=new AMap.TileLayer.RoadNet(s),l.add(i),u(i)}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.remove(i),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});ue.__file="src/vue-amap/packages/layer/official/RoadNet/RoadNet.vue",ue.install=t=>(t.component(ue.name,ue),t);const Oi=ue;var ce=y.defineComponent({name:"ElAmapLayerSatellite",inheritAttrs:!1,__name:"Satellite",props:R({zooms:{type:Array},opacity:{type:Number},tileSize:{type:Number}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{i=new AMap.TileLayer.Satellite(s),l.add(i),u(i)}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.remove(i),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});ce.__file="src/vue-amap/packages/layer/official/Satellite/Satellite.vue",ce.install=t=>(t.component(ce.name,ce),t);const ki=ce;var pe=y.defineComponent({name:"ElAmapLayerTile",inheritAttrs:!1,__name:"TileLayer",props:R({tileUrl:{type:String,required:!0},zoom:{type:Array},dataZooms:{type:Array},opacity:{type:Number},tileSize:{type:Number}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{i=new AMap.TileLayer(s),l.add(i),u(i)}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.remove(i),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});pe.__file="src/vue-amap/packages/layer/official/TileLayer/TileLayer.vue",pe.install=t=>(t.component(pe.name,pe),t);const Li=pe;var he=y.defineComponent({name:"ElAmapLayerTraffic",inheritAttrs:!1,__name:"Traffic",props:R({autoRefresh:{type:Boolean,defult:!0},interval:{type:Number},zooms:{type:Array},opacity:{type:Number},tileSize:{type:Number}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{i=new AMap.TileLayer.Traffic(s),l.add(i),u(i)}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.remove(i),i=null)}});return e({$$getInstance:a,stopFresh:()=>{i&&i.stopFresh()}}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});he.__file="src/vue-amap/packages/layer/official/Traffic/Traffic.vue",he.install=t=>(t.component(he.name,he),t);const $i=he;var de=y.defineComponent({name:"ElAmapLayerMapboxVectorTile",inheritAttrs:!1,__name:"MapboxVectorTileLayer",props:R({url:{type:String},zooms:{type:Array},dataZooms:{type:Array},opacity:{type:Number},styles:{type:Object}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{AMap.plugin(["AMap.MapboxVectorTileLayer"],()=>{i=new AMap.MapboxVectorTileLayer(s),l.addLayer(i),u(i)})}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.removeLayer(i),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});de.__file="src/vue-amap/packages/layer/standard/MapboxVectorTileLayer/MapboxVectorTileLayer.vue",de.install=t=>(t.component(de.name,de),t);const Ii=de;var fe=y.defineComponent({name:"ElAmapLayerWms",inheritAttrs:!1,__name:"WMS",props:R({url:{type:String},blend:{type:Boolean,default:!1},params:{type:Object},zooms:{type:Array},opacity:{type:Number}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{i=new AMap.TileLayer.WMS(s),l.add(i),u(i)}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.remove(i),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});fe.__file="src/vue-amap/packages/layer/standard/WMS/WMS.vue",fe.install=t=>(t.component(fe.name,fe),t);const Pi=fe;var me=y.defineComponent({name:"ElAmapLayerWmts",inheritAttrs:!1,__name:"WMTS",props:R({url:{type:String},blend:{type:Boolean,default:!1},params:{type:Object},zooms:{type:Array},opacity:{type:Number}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{i=new AMap.TileLayer.WMTS(s),l.add(i),u(i)}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.remove(i),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});me.__file="src/vue-amap/packages/layer/standard/WMTS/WMTS.vue",me.install=t=>(t.component(me.name,me),t);const Ti=me;var ye=y.defineComponent({name:"ElAmapElasticMarker",inheritAttrs:!1,__name:"ElasticMarker",props:R({position:{type:[Array,Object],required:!0},title:{type:String},offset:{type:[Array,Object]},clickable:{type:Boolean,default:!0},draggable:{type:Boolean,default:!1},bubble:{type:Boolean,default:!1},zooms:{type:Array},cursor:{type:String},topWhenClick:{type:Boolean,default:!1},zoomStyleMapping:{type:Object},styles:{type:Array},extData:{type:Object,default:()=>null}}),emits:["init","update:position"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((u,p)=>new Promise(d=>{AMap.plugin(["AMap.ElasticMarker"],()=>{i=new AMap.ElasticMarker(u),p.add(i),s(),d(i)})}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.remove(i),i=null)}}),s=()=>{i.on("dragend",()=>{l()}),i.on("touchend",()=>{l()})},l=()=>{const u=i.getPosition();o("update:position",u==null?void 0:u.toArray())};return e({$$getInstance:a}),(u,p)=>(y.openBlock(),y.createElementBlock("div"))}});ye.__file="src/vue-amap/packages/marker/ElasticMarker/ElasticMarker.vue",ye.install=t=>(t.component(ye.name,ye),t);const Ri=ye;var ge=y.defineComponent({name:"ElAmapLabelMarker",inheritAttrs:!1,__name:"LabelMarker",props:R({name:{type:String},position:{type:[Array,Object],required:!0},zooms:{type:Array},opacity:{type:Number},rank:{type:Number},icon:{type:Object},text:{type:Object},extData:null}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{i=new AMap.LabelMarker(s),l.add(i),u(i)}),{emits:o,destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.remove(i),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});ge.__file="src/vue-amap/packages/marker/LabelMarker/LabelMarker.vue",ge.install=t=>(t.component(ge.name,ge),t);const Bi=ge,uc=R({position:{type:[Array,Object],required:!0},icon:{type:[String,Object]},content:{type:[String,typeof HTMLElement=="undefined"?Object:HTMLElement]},title:{type:String},offset:{type:[Array,Object]},anchor:{type:[String,Array]},angle:{type:Number},clickable:{type:Boolean,default:!0},draggable:{type:Boolean,default:!1},bubble:{type:Boolean,default:!1},zooms:{type:Array},cursor:{type:String},topWhenClick:{type:Boolean,default:!1},label:{type:Object},extData:null,moveOptions:{type:Object,default:()=>null}}),cc={style:{display:"none"}};var ve=y.defineComponent({name:"ElAmapMarker",inheritAttrs:!1,__name:"Marker",props:R(uc),emits:["init","update:position"],setup(t,{expose:e,emit:n}){const o=t,i=n,a=`marker-${Rt()}`,r=y.ref("");let s,l=!1;const u=y.useSlots(),{$$getInstance:p,parentInstance:d}=B((m,v)=>new Promise(h=>{u.default&&u.default().length>0&&(l=!0,m.content=`<div id="${a}"></div>`),s=new AMap.Marker(m),J(v)?v.add(s):Q(v)&&v.addOverlay(s),l&&(r.value=a),c(),h(s)}),{emits:i,watchRedirectFn:{__position(m){if(!o.moveOptions){s.setPosition(m);return}d!=null&&d.$amapComponent&&d.$amapComponent.plugin("AMap.MoveAnimation",()=>{s.moveTo(m,o.moveOptions)})}},destroyComponent(){s&&d!=null&&d.$amapComponent&&(s.setMap(null),s=null)}}),c=()=>{s.on("dragend",()=>{f()}),s.on("touchend",()=>{f()})},f=()=>{const m=s.getPosition();i("update:position",m.toArray())};return e({$$getInstance:p}),(m,v)=>(y.openBlock(),y.createElementBlock("div",cc,[r.value?(y.openBlock(),y.createBlock(y.Teleport,{key:0,to:"#"+r.value},[y.renderSlot(m.$slots,"default")],8,["to"])):y.createCommentVNode("v-if",!0)]))}});ve.__file="src/vue-amap/packages/marker/Marker/Marker.vue",ve.install=t=>(t.component(ve.name,ve),t);const Ni=ve;var be=y.defineComponent({name:"ElAmapMarkerCluster",inheritAttrs:!1,__name:"MarkerCluster",props:R({points:{type:Object,required:!0},gridSize:{type:Number},maxZoom:{type:Number},averageCenter:{type:Boolean,default:!0},clusterByZoomChange:{type:Boolean,default:!1},styles:{type:Array},renderClusterMarker:{type:Function},renderMarker:{type:Function}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{AMap.plugin(["AMap.MarkerCluster"],()=>{const p=s.points;delete s.points,i=new AMap.MarkerCluster(l,p,s),u(i)})}),{emits:o,watchRedirectFn:{__points(s){i&&i.setData(s)}},destroyComponent(){i&&r!=null&&r.$amapComponent&&(i.setMap(null),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});be.__file="src/vue-amap/packages/marker/MarkerCluster/MarkerCluster.vue",be.install=t=>(t.component(be.name,be),t);const Fi=be;var _e=y.defineComponent({name:"ElAmapMassMarks",inheritAttrs:!1,__name:"MassMarks",props:R({data:{type:Array,required:!0},zooms:{type:Array},cursor:{type:String},styles:{type:[Array,Object]}}),emits:["init","update:center"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((s,l)=>new Promise(u=>{const p=s.data;delete s.data,i=new AMap.MassMarks(p,s),i.setMap(l),u(i)}),{emits:o,propsRedirect:{styles:"style"},destroyComponent(){i&&r!=null&&r.$amapComponent&&(i.clear(),i.setMap(null),i=null)}});return e({$$getInstance:a}),(s,l)=>(y.openBlock(),y.createElementBlock("div"))}});_e.__file="src/vue-amap/packages/marker/MassMarks/MassMarks.vue",_e.install=t=>(t.component(_e.name,_e),t);const Di=_e,pc=R({position:{type:[Array,Object],required:!0},text:{type:String},title:{type:String},offset:{type:[Array,Object]},anchor:{type:[String,Array]},angle:{type:Number},clickable:{type:Boolean,default:!0},draggable:{type:Boolean,default:!1},bubble:{type:Boolean,default:!1},zooms:{type:Array},cursor:{type:String},topWhenClick:{type:Boolean,default:!1},textStyle:{type:Object},extData:null});var Me=y.defineComponent({name:"ElAmapText",inheritAttrs:!1,__name:"Text",props:pc,emits:["init","update:position"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((u,p)=>new Promise(d=>{i=new AMap.Text(u),p.add(i),s(),d(i)}),{emits:o,propsRedirect:{textStyle:"style"},destroyComponent(){i&&r!=null&&r.$amapComponent&&(i.setMap(null),i=null)}}),s=()=>{i.on("dragend",()=>{l()}),i.on("touchend",()=>{l()})},l=()=>{const u=i.getPosition();o("update:position",u.toArray())};return e({$$getInstance:a}),(u,p)=>(y.openBlock(),y.createElementBlock("div"))}});Me.__file="src/vue-amap/packages/marker/Text/Text.vue",Me.install=t=>(t.component(Me.name,Me),t);const ji=Me;function Lt(t,e){if(!t)return;const n=["addnode","adjust","removenode","end","move","add"],o={};Object.keys(e).forEach(i=>{if(Ze.test(i)){const a=Ue(i);n.indexOf(a)!==-1&&(o[a]=e[i])}}),Object.keys(o).forEach(i=>{Ye(t,i,o[i])})}const hc=R({path:{type:Array,required:!0},bubble:{type:Boolean,default:!1},cursor:{type:String},strokeColor:{type:String},strokeOpacity:{type:Number},strokeWeight:{type:Number},borderWeight:{type:Number},isOutline:{type:Boolean,default:!1},outlineColor:{type:String},draggable:{type:Boolean,default:!1},extData:{type:Object,default:()=>null},strokeStyle:{type:String,validator:t=>["solid","dashed"].indexOf(t)!==-1},strokeDasharray:{type:Array},lineJoin:{type:String,validator:t=>["miter","round","bevel"].indexOf(t)!==-1},lineCap:{type:String,validator:t=>["butt","round","square"].indexOf(t)!==-1},geodesic:{type:Boolean,default:!1},showDir:{type:Boolean,default:!1},editable:{type:Boolean,default:!1},editOptions:{type:Object}});var Ae=y.defineComponent({name:"ElAmapBezierCurve",inheritAttrs:!1,__name:"BezierCurve",props:hc,emits:["init","update:path"],setup(t,{expose:e,emit:n}){const o=t,i=n;let a,r=!1;const{$$getInstance:s,parentInstance:l}=B((h,g)=>new Promise(A=>{a=new AMap.BezierCurve(h),J(g)?g.add(a):Q(g)?g.addOverlay(a):et(g)&&g.add(a),p(),A(a)}),{emits:i,watchRedirectFn:{__zIndex(h){a&&a.setOptions({zIndex:h})},__strokeColor(h){a&&a.setOptions({strokeColor:h})},__strokeOpacity(h){a&&a.setOptions({strokeOpacity:h})},__strokeWeight(h){a&&a.setOptions({strokeWeight:h})},__borderWeight(h){a&&a.setOptions({borderWeight:h})},__isOutline(h){a&&a.setOptions({isOutline:h})},__outlineColor(h){a&&a.setOptions({outlineColor:h})},__strokeStyle(h){a&&a.setOptions({strokeStyle:h})},__strokeDasharray(h){a&&a.setOptions({strokeDasharray:h})},__lineJoin(h){a&&a.setOptions({lineJoin:h})},__lineCap(h){a&&a.setOptions({lineCap:h})},__geodesic(h){a&&a.setOptions({geodesic:h})},__showDir(h){a&&a.setOptions({showDir:h})},__editable(h){m().then(()=>{h?u():c.close()})},__path(h){a&&(a.setPath(h),u())}},destroyComponent(){r=!0,a&&l!=null&&l.$amapComponent&&(c&&(l.isDestroy||c.close(),c=null),l.isDestroy||(J(l.$amapComponent)?l.$amapComponent.remove(a):Q(l.$amapComponent)?l.$amapComponent.removeOverlay(a):et(l.$amapComponent)&&l.$amapComponent.remove(a)),a.destroy&&a.destroy(),a=null)}}),u=Mt(()=>{c&&o.editable&&(c.close(),c.setTarget(),c.setTarget(a),c.open())},50),p=()=>{a.on("dragend",()=>{d(a)}),a.on("touchend",()=>{d(a)})},d=Mt(h=>{if(r)return;const g=h.getPath();i("update:path",g)},50);let c;const f=y.useAttrs(),m=()=>new Promise(h=>{c?h():AMap.plugin(["AMap.BezierCurveEditor"],()=>{c=new AMap.BezierCurveEditor(l==null?void 0:l.$amapComponent,a,o.editOptions),Lt(c,f),v(),h()})}),v=()=>{c.on("addnode",h=>{d(h.target)}),c.on("adjust",h=>{d(h.target)}),c.on("removenode",h=>{d(h.target)}),c.on("add",h=>{d(h.target)})};return e({$$getInstance:s}),(h,g)=>(y.openBlock(),y.createElementBlock("div"))}});Ae.__file="src/vue-amap/packages/vector/BezierCurve/BezierCurve.vue",Ae.install=t=>(t.component(Ae.name,Ae),t);const zi=Ae,dc=R({center:{type:Array,required:!0},radius:{type:Number,required:!0},bubble:{type:Boolean,default:!1},cursor:{type:String},strokeColor:{type:String},strokeOpacity:{type:Number},strokeWeight:{type:Number},fillColor:{type:String},fillOpacity:{type:Number},draggable:{type:Boolean,default:!1},extData:{type:Object,default:()=>null},strokeStyle:{type:String,validator:t=>["solid","dashed"].indexOf(t)!==-1},strokeDasharray:{type:Array},editable:{type:Boolean,default:!1},editOptions:{type:Object}});var xe=y.defineComponent({name:"ElAmapCircle",inheritAttrs:!1,__name:"Circle",props:dc,emits:["init","update:center","update:radius"],setup(t,{expose:e,emit:n}){const o=t,i=n;let a,r=!1;const{$$getInstance:s,parentInstance:l}=B((h,g)=>new Promise(A=>{a=new AMap.Circle(h),J(g)?g.add(a):Q(g)?g.addOverlay(a):et(g)&&g.add(a),p(),A(a)}),{emits:i,watchRedirectFn:{__zIndex(h){a&&a.setOptions({zIndex:h})},__strokeColor(h){a&&a.setOptions({strokeColor:h})},__strokeOpacity(h){a&&a.setOptions({strokeOpacity:h})},__strokeWeight(h){a&&a.setOptions({strokeWeight:h})},__fillColor(h){a&&a.setOptions({fillColor:h})},__fillOpacity(h){a&&a.setOptions({fillOpacity:h})},__strokeStyle(h){a&&a.setOptions({strokeStyle:h})},__strokeDasharray(h){a&&a.setOptions({strokeDasharray:h})},__editable(h){m().then(()=>{h?u():c.close()})},__center(h){a&&(a.setCenter(h),u())},__radius(h){a&&(a.setRadius(h),u())}},destroyComponent(){r=!0,a&&l!=null&&l.$amapComponent&&(c&&(l.isDestroy||c.close(),c=null),l.isDestroy||(J(l.$amapComponent)?l.$amapComponent.remove(a):Q(l.$amapComponent)?l.$amapComponent.removeOverlay(a):et(l.$amapComponent)&&l.$amapComponent.remove(a)),a.destroy&&a.destroy(),a=null)}}),u=Mt(()=>{c&&o.editable&&(c.close(),c.setTarget(),c.setTarget(a),c.open())},50),p=()=>{a.on("dragend",()=>{d(a)}),a.on("touchend",()=>{d(a)})},d=h=>{r||(i("update:center",h.getCenter().toArray()),i("update:radius",h.getRadius()))};let c;const f=y.useAttrs(),m=()=>new Promise(h=>{c?h():AMap.plugin(["AMap.CircleEditor"],()=>{c=new AMap.CircleEditor(l==null?void 0:l.$amapComponent,a,o.editOptions),Lt(c,f),v(),h()})}),v=()=>{c.on("addnode",h=>{d(h.target)}),c.on("adjust",h=>{d(h.target)}),c.on("removenode",h=>{d(h.target)}),c.on("add",h=>{d(h.target)}),c.on("move",h=>{d(h.target)})};return e({$$getInstance:s}),(h,g)=>(y.openBlock(),y.createElementBlock("div"))}});xe.__file="src/vue-amap/packages/vector/Circle/Circle.vue",xe.install=t=>(t.component(xe.name,xe),t);const Wi=xe,fc=R({center:{type:Array,required:!0},radius:{type:Array,required:!0},bubble:{type:Boolean,default:!1},cursor:{type:String},strokeColor:{type:String},strokeOpacity:{type:Number},strokeWeight:{type:Number},fillColor:{type:String},fillOpacity:{type:Number},draggable:{type:Boolean,default:!1},extData:{type:Object,default:()=>null},strokeStyle:{type:String,validator:t=>["solid","dashed"].indexOf(t)!==-1},strokeDasharray:{type:Array},editable:{type:Boolean,default:!1},editOptions:{type:Object}});var Ee=y.defineComponent({name:"ElAmapEllipse",inheritAttrs:!1,__name:"Ellipse",props:fc,emits:["init","update:center","update:radius"],setup(t,{expose:e,emit:n}){const o=t,i=n;let a,r=!1;const{$$getInstance:s,parentInstance:l}=B((h,g)=>new Promise(A=>{a=new AMap.Ellipse(h),J(g)?g.add(a):Q(g)?g.addOverlay(a):et(g)&&g.add(a),p(),A(a)}),{emits:i,watchRedirectFn:{__zIndex(h){a&&a.setOptions({zIndex:h})},__strokeColor(h){a&&a.setOptions({strokeColor:h})},__strokeOpacity(h){a&&a.setOptions({strokeOpacity:h})},__strokeWeight(h){a&&a.setOptions({strokeWeight:h})},__fillColor(h){a&&a.setOptions({fillColor:h})},__fillOpacity(h){a&&a.setOptions({fillOpacity:h})},__strokeStyle(h){a&&a.setOptions({strokeStyle:h})},__strokeDasharray(h){a&&a.setOptions({strokeDasharray:h})},__editable(h){m().then(()=>{h?u():c.close()})},__center(h){a&&(a.setCenter(h),u())},__radius(h){a&&(a.setRadius(h),u())}},destroyComponent(){r=!0,a&&l!=null&&l.$amapComponent&&(c&&(l.isDestroy||c.close(),c=null),l.isDestroy||(J(l.$amapComponent)?l.$amapComponent.remove(a):Q(l.$amapComponent)?l.$amapComponent.removeOverlay(a):et(l.$amapComponent)&&l.$amapComponent.remove(a)),a.destroy&&a.destroy(),a=null)}}),u=Mt(()=>{c&&o.editable&&(c.close(),c.setTarget(),c.setTarget(a),c.open())},50),p=()=>{a.on("dragend",()=>{d(a)}),a.on("touchend",()=>{d(a)})},d=h=>{r||(i("update:center",h.getCenter().toArray()),i("update:radius",h.getRadius()))};let c;const f=y.useAttrs(),m=()=>new Promise(h=>{c?h():AMap.plugin(["AMap.EllipseEditor"],()=>{c=new AMap.EllipseEditor(l==null?void 0:l.$amapComponent,a,o.editOptions),Lt(c,f),v(),h()})}),v=()=>{c.on("addnode",h=>{d(h.target)}),c.on("adjust",h=>{d(h.target)}),c.on("removenode",h=>{d(h.target)}),c.on("add",h=>{d(h.target)}),c.on("move",h=>{d(h.target)})};return e({$$getInstance:s}),(h,g)=>(y.openBlock(),y.createElementBlock("div"))}});Ee.__file="src/vue-amap/packages/vector/Ellipse/Ellipse.vue",Ee.install=t=>(t.component(Ee.name,Ee),t);const qi=Ee;var Ce=y.defineComponent({name:"ElAmapGeojson",inheritAttrs:!1,__name:"GeoJSON",props:R({geo:{type:Object,required:!0},markerOptions:{type:Object},getMarker:{type:Function},polylineOptions:{type:Object},getPolyline:{type:Function},polygonOptions:{type:Object},getPolygon:{type:Function}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=t,i=n;let a;const{$$getInstance:r,parentInstance:s}=B((d,c)=>new Promise(f=>{AMap.plugin(["AMap.GeoJSON"],()=>{d.getMarker||(d.getMarker=l),d.getPolyline||(d.getPolyline=u),d.getPolygon||(d.getPolygon=p),a=new AMap.GeoJSON(d),c.add(a),f(a)})}),{emits:i,propsRedirect:{geo:"geoJSON"},watchRedirectFn:{__geoJSON(d){a&&a.importData(d)}},destroyComponent(){a&&s!=null&&s.$amapComponent&&(s!=null&&s.isDestroy||s==null||s.$amapComponent.remove(a),a=null)}}),l=(d,c)=>{let f=o.markerOptions||{};return f=on({},f,d.properties),f.position=c,new AMap.Marker(f)},u=(d,c)=>{let f=o.polylineOptions||{};return f=on({},f,d.properties),f.path=c,new AMap.Polyline(f)},p=(d,c)=>{let f=o.polygonOptions||{};return f=on({},f,d.properties),f.path=c,new AMap.Polygon(f)};return e({$$getInstance:r}),(d,c)=>(y.openBlock(),y.createElementBlock("div"))}});Ce.__file="src/vue-amap/packages/vector/GeoJSON/GeoJSON.vue",Ce.install=t=>(t.component(Ce.name,Ce),t);const Ui=Ce,mc=R({path:{type:Array,required:!0},bubble:{type:Boolean,default:!1},cursor:{type:String},strokeColor:{type:String},strokeOpacity:{type:Number},strokeWeight:{type:Number},fillColor:{type:String},fillOpacity:{type:Number},draggable:{type:Boolean,default:!1},extData:{type:Object,default:()=>null},strokeStyle:{type:String,validator:t=>["solid","dashed"].indexOf(t)!==-1},strokeDasharray:{type:Array},editable:{type:Boolean,default:!1},editOptions:{type:Object}});var we=y.defineComponent({name:"ElAmapPolygon",inheritAttrs:!1,__name:"Polygon",props:mc,emits:["init","update:path"],setup(t,{expose:e,emit:n}){const o=t,i=n;let a,r=!1;const{$$getInstance:s,parentInstance:l}=B((h,g)=>new Promise(A=>{a=new AMap.Polygon(h),J(g)?g.add(a):Q(g)?g.addOverlay(a):et(g)&&g.add(a),p(),A(a)}),{emits:i,watchRedirectFn:{__zIndex(h){a&&a.setOptions({zIndex:h})},__strokeColor(h){a&&a.setOptions({strokeColor:h})},__strokeOpacity(h){a&&a.setOptions({strokeOpacity:h})},__strokeWeight(h){a&&a.setOptions({strokeWeight:h})},__fillColor(h){a&&a.setOptions({fillColor:h})},__fillOpacity(h){a&&a.setOptions({fillOpacity:h})},__strokeStyle(h){a&&a.setOptions({strokeStyle:h})},__strokeDasharray(h){a&&a.setOptions({strokeDasharray:h})},__editable(h){m().then(()=>{h?u():c.close()})},__path(h){a&&(a.setPath(h),u())}},destroyComponent(){r=!0,a&&l!=null&&l.$amapComponent&&(c&&(l.isDestroy||c.close(),c=null),l.isDestroy||(J(l.$amapComponent)?l.$amapComponent.remove(a):Q(l.$amapComponent)?l.$amapComponent.removeOverlay(a):et(l.$amapComponent)&&l.$amapComponent.remove(a)),a.destroy&&a.destroy(),a=null)}}),u=Mt(()=>{c&&o.editable&&(c.close(),c.setTarget(),c.setTarget(a),c.open())},50),p=()=>{a.on("dragend",()=>{d(a)}),a.on("touchend",()=>{d(a)})},d=h=>{if(r)return;const g=h.getPath(),A=g==null?void 0:g.map(Ge);i("update:path",A)};let c;const f=y.useAttrs(),m=()=>new Promise(h=>{c?h():AMap.plugin(["AMap.PolygonEditor"],()=>{c=new AMap.PolygonEditor(l==null?void 0:l.$amapComponent,a,o.editOptions),Lt(c,f),v(),h()})}),v=()=>{c.on("addnode",h=>{d(h.target)}),c.on("adjust",h=>{d(h.target)}),c.on("removenode",h=>{d(h.target)}),c.on("add",h=>{d(h.target)})};return e({$$getInstance:s}),(h,g)=>(y.openBlock(),y.createElementBlock("div"))}});we.__file="src/vue-amap/packages/vector/Polygon/Polygon.vue",we.install=t=>(t.component(we.name,we),t);const Zi=we,yc=R({path:{type:Array,required:!0},bubble:{type:Boolean,default:!1},cursor:{type:String},strokeColor:{type:String},strokeOpacity:{type:Number},strokeWeight:{type:Number},borderWeight:{type:Number},isOutline:{type:Boolean,default:!1},outlineColor:{type:String},draggable:{type:Boolean,default:!1},extData:{type:Object,default:()=>null},strokeStyle:{type:String,validator:t=>["solid","dashed"].indexOf(t)!==-1},strokeDasharray:{type:Array},lineJoin:{type:String,validator:t=>["miter","round","bevel"].indexOf(t)!==-1},lineCap:{type:String,validator:t=>["butt","round","square"].indexOf(t)!==-1},geodesic:{type:Boolean,default:!1},showDir:{type:Boolean,default:!1},editable:{type:Boolean,default:!1},editOptions:{type:Object}});var Se=y.defineComponent({name:"ElAmapPolyline",inheritAttrs:!1,__name:"Polyline",props:yc,emits:["init","update:path"],setup(t,{expose:e,emit:n}){const o=t,i=n;let a,r=!1;const{$$getInstance:s,parentInstance:l}=B((h,g)=>new Promise(A=>{a=new AMap.Polyline(h),J(g)?g.add(a):Q(g)?g.addOverlay(a):et(g)&&g.add(a),p(),A(a)}),{emits:i,watchRedirectFn:{__zIndex(h){a&&a.setOptions({zIndex:h})},__strokeColor(h){a&&a.setOptions({strokeColor:h})},__strokeOpacity(h){a&&a.setOptions({strokeOpacity:h})},__strokeWeight(h){a&&a.setOptions({strokeWeight:h})},__borderWeight(h){a&&a.setOptions({borderWeight:h})},__isOutline(h){a&&a.setOptions({isOutline:h})},__outlineColor(h){a&&a.setOptions({outlineColor:h})},__strokeStyle(h){a&&a.setOptions({strokeStyle:h})},__strokeDasharray(h){a&&a.setOptions({strokeDasharray:h})},__lineJoin(h){a&&a.setOptions({lineJoin:h})},__lineCap(h){a&&a.setOptions({lineCap:h})},__geodesic(h){a&&a.setOptions({geodesic:h})},__showDir(h){a&&a.setOptions({showDir:h})},__editable(h){m().then(()=>{h?u():c.close()})},__path(h){a&&(a.setPath(h),u())}},destroyComponent(){r=!0,a&&l!=null&&l.$amapComponent&&(c&&(l.isDestroy||c.close(),c=null),l.isDestroy||(J(l.$amapComponent)?l.$amapComponent.remove(a):Q(l.$amapComponent)?l.$amapComponent.removeOverlay(a):et(l.$amapComponent)&&l.$amapComponent.remove(a)),a.destroy&&a.destroy(),a=null)}}),u=Mt(()=>{c&&o.editable&&(c.close(),c.setTarget(),c.setTarget(a),c.open())},50),p=()=>{a.on("dragend",()=>{d(a)}),a.on("touchend",()=>{d(a)})},d=h=>{if(r)return;const g=h.getPath(),A=g==null?void 0:g.map(Ge);i("update:path",A)};let c;const f=y.useAttrs(),m=()=>new Promise(h=>{c?h():AMap.plugin(["AMap.PolylineEditor"],()=>{c=new AMap.PolylineEditor(l==null?void 0:l.$amapComponent,a,o.editOptions),Lt(c,f),v(),h()})}),v=()=>{c.on("addnode",h=>{d(h.target)}),c.on("adjust",h=>{d(h.target)}),c.on("removenode",h=>{d(h.target)}),c.on("add",h=>{d(h.target)})};return e({$$getInstance:s}),(h,g)=>(y.openBlock(),y.createElementBlock("div"))}});Se.__file="src/vue-amap/packages/vector/Polyline/Polyline.vue",Se.install=t=>(t.component(Se.name,Se),t);const Gi=Se,gc=R({bounds:{type:Array,required:!0},bubble:{type:Boolean,default:!1},cursor:{type:String},strokeColor:{type:String},strokeOpacity:{type:Number},strokeWeight:{type:Number},fillColor:{type:String},fillOpacity:{type:Number},draggable:{type:Boolean,default:!1},extData:{type:Object,default:()=>null},strokeStyle:{type:String,validator:t=>["solid","dashed"].indexOf(t)!==-1},strokeDasharray:{type:Array},editable:{type:Boolean,default:!1},editOptions:{type:Object}});var Oe=y.defineComponent({name:"ElAmapRectangle",inheritAttrs:!1,__name:"Rectangle",props:gc,emits:["init","update:bounds"],setup(t,{expose:e,emit:n}){const o=t,i=n;let a,r=!1;const{$$getInstance:s,parentInstance:l}=B((h,g)=>new Promise(A=>{a=new AMap.Rectangle(h),J(g)?g.add(a):Q(g)?g.addOverlay(a):et(g)&&g.add(a),p(),A(a)}),{emits:i,converts:{bounds:h=>new AMap.Bounds(Bt(h[0]),Bt(h[1]))},watchRedirectFn:{__zIndex(h){a&&a.setOptions({zIndex:h})},__strokeColor(h){a&&a.setOptions({strokeColor:h})},__strokeOpacity(h){a&&a.setOptions({strokeOpacity:h})},__strokeWeight(h){a&&a.setOptions({strokeWeight:h})},__fillColor(h){a&&a.setOptions({fillColor:h})},__fillOpacity(h){a&&a.setOptions({fillOpacity:h})},__strokeStyle(h){a&&a.setOptions({strokeStyle:h})},__strokeDasharray(h){a&&a.setOptions({strokeDasharray:h})},__editable(h){m().then(()=>{h?u():c.close()})},__bounds(h){a&&(a.setBounds(h),u())}},destroyComponent(){r=!0,a&&l!=null&&l.$amapComponent&&(c&&(l.isDestroy||c.close(),c=null),l.isDestroy||(J(l.$amapComponent)?l.$amapComponent.remove(a):Q(l.$amapComponent)?l.$amapComponent.removeOverlay(a):et(l.$amapComponent)&&l.$amapComponent.remove(a)),a.destroy&&a.destroy(),a=null)}}),u=Mt(()=>{c&&o.editable&&(c.close(),c.setTarget(),c.setTarget(a),c.open())},50),p=()=>{a.on("dragend",()=>{d(a)}),a.on("touchend",()=>{d(a)})},d=h=>{if(r)return;const g=h.getBounds(),A=g.getSouthWest(),b=g.getNorthEast(),M=[A.toArray(),b.toArray()];i("update:bounds",M)};let c;const f=y.useAttrs(),m=()=>new Promise(h=>{c?h():AMap.plugin(["AMap.RectangleEditor"],()=>{c=new AMap.RectangleEditor(l==null?void 0:l.$amapComponent,a,o.editOptions),Lt(c,f),v(),h()})}),v=()=>{c.on("addnode",h=>{d(h.target)}),c.on("adjust",h=>{d(h.target)}),c.on("removenode",h=>{d(h.target)}),c.on("add",h=>{d(h.target)})};return e({$$getInstance:s}),(h,g)=>(y.openBlock(),y.createElementBlock("div"))}});Oe.__file="src/vue-amap/packages/vector/Rectangle/Rectangle.vue",Oe.install=t=>(t.component(Oe.name,Oe),t);const Yi=Oe;var ke=y.defineComponent({name:"ElAmapLayerTiles3d",inheritAttrs:!1,__name:"Tiles3D",props:R({url:{type:String,required:!0},threeScriptUrl:{type:String,default:"//a.amap.com/jsapi_demos/static/data3d/lib/three.117.js"},threeGltfLoader:{type:String,default:"//a.amap.com/jsapi_demos/static/data3d/lib/GLTFLoader.117.min.js"},layerStyle:{type:Object}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((l,u)=>new Promise(p=>{u.plugin(["AMap.3DTilesLayer"],()=>{window.THREE?(s(l),p(i)):On(l.threeScriptUrl,()=>{On(l.threeGltfLoader,()=>{s(l),p(i)})})})}),{emits:o,destroyComponent(){i&&(i=null)}}),s=l=>{let u={};l.layerStyle&&(u=JSON.parse(JSON.stringify(l.layerStyle))),i=new AMap["3DTilesLayer"]({map:r==null?void 0:r.$amapComponent,url:l.url,style:u})};return e({$$getInstance:a}),(l,u)=>(y.openBlock(),y.createElementBlock("div"))}});ke.__file="src/vue-amap/packages/layer/data/Tiles3D/Tiles3D.vue",ke.install=t=>(t.component(ke.name,ke),t);const Vi=ke,vc=R({position:{type:String},offset:{type:Array},borderColor:{type:String},borderRadius:{type:String},buttonSize:{type:String},convert:{type:Boolean,default:!0},enableHighAccuracy:{type:Boolean,default:!1},timeout:{type:Number},maximumAge:{type:Number},showButton:{type:Boolean,default:!0},showCircle:{type:Boolean,default:!0},showMarker:{type:Boolean,default:!0},markerOptions:{type:Object},circleOptions:{type:Object},panToLocation:{type:Boolean,default:!0},zoomToAccuracy:{type:Boolean,default:!0},GeoLocationFirst:{type:Boolean,default:!0},noIpLocate:{type:Number},noGeoLocation:{type:Number},useNative:{type:Boolean,default:!1},getCityWhenFail:{type:Boolean,default:!1},needAddress:{type:Boolean,default:!1},extensions:{type:String,validator:t=>["base","all"].indexOf(t)!==-1}});var Le=y.defineComponent({name:"ElAmapControlGeolocation",inheritAttrs:!1,__name:"Geolocation",props:vc,emits:["init","complete"],setup(t,{expose:e,emit:n}){const o=n;let i;const a=l=>{o("complete",l)},{$$getInstance:r,parentInstance:s}=B((l,u)=>new Promise(p=>{u.plugin(["AMap.Geolocation"],()=>{i=new AMap.Geolocation(l),u.addControl(i),i.on("complete",a),p(i)})}),{emits:o,destroyComponent(){i.off("complete",a),i&&s!=null&&s.$amapComponent&&(s!=null&&s.isDestroy||s==null||s.$amapComponent.removeControl(i),i=null)}});return e({$$getInstance:r}),(l,u)=>null}});Le.__file="src/vue-amap/packages/control/Geolocation/Geolocation.vue",Le.install=t=>(t.component(Le.name,Le),t);const Hi=Le;var $e=y.defineComponent({name:"ElAmapCircleMarker",inheritAttrs:!1,__name:"CircleMarker",props:R({zIndex:{type:Number},center:{type:Array,required:!0},bubble:{type:Boolean,default:!1},cursor:{type:String},radius:{type:Number},strokeColor:{type:String},strokeOpacity:{type:Number},strokeWeight:{type:Number},fillColor:{type:String},fillOpacity:{type:Number},draggable:{type:Boolean,default:!1},extData:{type:Object}}),emits:["init","update:center"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a,parentInstance:r}=B((u,p)=>new Promise(d=>{i=new AMap.CircleMarker(u),p.add(i),s(),d(i)}),{emits:o,watchRedirectFn:{__strokeColor(u){i.setOptions({strokeColor:u})},__strokeOpacity(u){i.setOptions({strokeOpacity:u})},__strokeWeight(u){i.setOptions({strokeWeight:u})},__fillColor(u){i.setOptions({fillColor:u})},__fillOpacity(u){i.setOptions({fillOpacity:u})}},destroyComponent(){i&&r!=null&&r.$amapComponent&&(r!=null&&r.isDestroy||r==null||r.$amapComponent.remove(i),i=null)}}),s=()=>{i.on("dragend",()=>{l()}),i.on("touchend",()=>{l()})},l=()=>{const u=i.getCenter();o("update:center",u.toArray())};return e({$$getInstance:a}),(u,p)=>(y.openBlock(),y.createElementBlock("div"))}});$e.__file="src/vue-amap/packages/marker/CircleMarker/CircleMarker.vue",$e.install=t=>(t.component($e.name,$e),t);const Xi=$e;var bc=Object.defineProperty,_c=(t,e,n)=>e in t?bc(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,$t=(t,e,n)=>(_c(t,typeof e!="symbol"?e+"":e,n),n);let Mc=class{constructor(e,n){$t(this,"canvas"),$t(this,"context"),$t(this,"video"),$t(this,"layer"),$t(this,"canPlay",!1),$t(this,"frame",-1);const o=document.createElement("canvas");this.video=n,n.src=e.url,n.autoplay=!0,n.muted=!0,n.crossOrigin="anonymous",n.loop=e.loop;const i={...e,canvas:o};this.canvas=o,this.context=o.getContext("2d"),this.layer=new AMap.CanvasLayer(i),this.initVideoEvents(),this.load()}getLayer(){return this.layer}initVideoEvents(){var e;(e=this.video)==null||e.addEventListener("canplaythrough",()=>{var n,o;this.canvas&&(this.canvas.width=(n=this.video)==null?void 0:n.videoWidth,this.canvas.height=(o=this.video)==null?void 0:o.videoHeight),this.canPlay=!0,this.play()})}load(){var e;(e=this.video)==null||e.load()}play(){var e;this.canPlay&&((e=this.video)==null||e.play(),this.stopRender(),this.render())}pause(){var e;this.stopRender(),(e=this.video)==null||e.pause()}stopRender(){this.frame&&cancelAnimationFrame(this.frame)}render(){var e,n,o,i,a,r,s,l;this.frame=window.requestAnimationFrame(()=>{this.render()}),(e=this.video)!=null&&e.paused?(n=this.video)==null||n.play():((a=this.context)==null||a.clearRect(0,0,(o=this.canvas)==null?void 0:o.width,(i=this.canvas)==null?void 0:i.height),(l=this.context)==null||l.drawImage(this.video,0,0,(r=this.canvas)==null?void 0:r.width,(s=this.canvas)==null?void 0:s.height),this.layer.reFresh())}destroy(){this.stopRender(),this.video&&this.video.pause(),this.video=null}setUrl(e){this.stopRender(),this.canPlay=!1,this.video&&(this.video.src=e,this.load())}setZooms(e){this.getLayer().setZoom(e)}setOpacity(e){this.getLayer().setOpacity(e)}setBounds(e){this.getLayer().setBounds(e)}setzIndex(e){this.getLayer().setzIndex(e)}show(){this.getLayer().show()}hide(){this.getLayer().hide()}};var Ie=y.defineComponent({name:"ElAmapLayerVideo",inheritAttrs:!1,__name:"Video",props:R({url:{required:!0,type:String},zooms:{type:Array},bounds:{type:[Array,Object]},opacity:{type:Number}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n,i=y.ref();let a;const{$$getInstance:r,parentInstance:s}=B((l,u)=>new Promise(p=>{a=new Mc(l,i.value),u.addLayer(a.getLayer()),p(a)}),{emits:o,destroyComponent(){a&&s!=null&&s.$amapComponent&&(s!=null&&s.isDestroy||(a.destroy(),s==null||s.$amapComponent.removeLayer(a.getLayer())),a=null)}});return e({$$getInstance:r,$$play:()=>{a.play()},$$pause:()=>{a.pause()}}),(l,u)=>(y.openBlock(),y.createElementBlock("video",{ref_key:"videoRef",ref:i,style:{display:"none"},muted:""},null,512))}});Ie.__file="src/vue-amap/packages/layer/data/Video/Video.vue",Ie.install=t=>(t.component(Ie.name,Ie),t);const Ki=Ie;var Pe=y.defineComponent({name:"ElAmapMouseTool",inheritAttrs:!1,__name:"MouseTool",props:R({type:{type:String,required:!0,default:"marker",validator:t=>["marker","circle","rectangle","polyline","polygon","measureArea","rule","rectZoomIn","rectZoomOut"].includes(t)},drawOptions:{type:Object,default:()=>null},autoClear:{type:Boolean,default:!0},showTooltip:{type:Boolean,default:!0},tooltipTextMap:{type:Object,default:()=>null},textOptions:{type:Object,default:()=>null},drawCursor:{type:String,default:"crosshair"}}),emits:["init","draw"],setup(t,{expose:e,emit:n}){const o=t,i=n;let a,r="";const s={marker:"\u5355\u51FB\u5730\u56FE\u9009\u62E9\u70B9\u4F4D",circle:"\u6309\u4F4F\u9F20\u6807\u5DE6\u952E\u62D6\u62FD\u7ED8\u5236\u5706",rectangle:"\u6309\u4F4F\u9F20\u6807\u5DE6\u952E\u62D6\u62FD\u7ED8\u5236\u77E9\u5F62",polyline:"\u5355\u51FB\u5730\u56FE\u9009\u62E9\u62D0\u70B9\uFF0C\u53CC\u51FB\u5730\u56FE\u5B8C\u6210\u6298\u7EBF\u7ED8\u5236",polygon:"\u5355\u51FB\u5730\u56FE\u9009\u62E9\u62D0\u70B9\uFF0C\u53CC\u51FB\u5730\u56FE\u5B8C\u6210\u591A\u8FB9\u5F62\u7ED8\u5236",measureArea:"\u5355\u51FB\u5730\u56FE\u9009\u62E9\u62D0\u70B9\uFF0C\u53CC\u51FB\u5730\u56FE\u5B8C\u6210\u7ED8\u5236\u5E76\u8BA1\u7B97\u9762\u79EF",rule:"\u5355\u51FB\u5730\u56FE\u9009\u62E9\u62D0\u70B9\uFF0C\u53F3\u51FB\u5730\u56FE\u5B8C\u6210\u7ED8\u5236\u5E76\u8BA1\u7B97\u8DDD\u79BB",rectZoomIn:"\u6309\u4F4F\u9F20\u6807\u5DE6\u952E\u62D6\u62FD\u7ED8\u5236\u77E9\u5F62\uFF0C\u677E\u5F00\u5DE6\u952E\u653E\u5927\u5730\u56FE",rectZoomOut:"\u6309\u4F4F\u9F20\u6807\u5DE6\u952E\u62D6\u62FD\u7ED8\u5236\u77E9\u5F62\uFF0C\u677E\u5F00\u5DE6\u952E\u653E\u5927\u5730\u56FE"};let l=!0;const u=()=>{if(!l)return;const C=o.type;if(a[C]){const S=o.drawOptions||{};a[C](S),v(s[C])}},{$$getInstance:p,parentInstance:d}=B((C,S)=>new Promise(N=>{AMap.plugin(["AMap.MouseTool"],()=>{o.tooltipTextMap&&Object.assign(s,o.tooltipTextMap),a=new AMap.MouseTool(S),r=S.getDefaultCursor(),f(),u(),h(),w(),N(a)})}),{emits:i,watchRedirectFn:{__type:u},destroyComponent(){a&&d!=null&&d.$amapComponent&&(d!=null&&d.isDestroy||(a.close(!0),x(),c&&(d.$amapComponent.off("mousemove",m),d.$amapComponent.remove(c),c=null)),a=null)}});let c;const f=()=>{if(o.showTooltip){const C=o.textOptions||{};C.anchor="top-left",C.clickable=!1,C.bubble=!0,C.offset=[10,10],c=new AMap.Text(C),d==null||d.$amapComponent.add(c),d==null||d.$amapComponent.on("mousemove",m)}},m=C=>{const S=C.lnglat;c.setPosition([S.lng,S.lat])},v=C=>{c&&c.setText(C)},h=()=>{a.on("draw",C=>{const S=o.type;let N;if(S==="marker")N=C.obj.getPosition().toArray();else if(S==="circle")N={center:C.obj.getCenter().toArray(),radius:C.obj.getRadius()};else if(S==="rectangle"){const F=C.obj.getBounds(),E=F.getSouthWest(),T=F.getNorthEast();N=[E.toArray(),T.toArray()]}else if(S==="polyline")N=C.obj.getPath().map(F=>F.toArray());else if(S==="polygon")N=C.obj.getPath().map(F=>F.toArray());else if(S==="measureArea"){const F=C.obj.getPath().map(E=>E.toArray());N=AMap.GeometryUtil.ringArea(F)}else if(S==="rule"){const F=C.obj.getPath().map(E=>E.toArray());N=AMap.GeometryUtil.distanceOfLine(F)}else(S==="rectZoomIn"||S==="rectZoomOut")&&(N=!0);i("draw",N,C.obj),o.autoClear&&(M(),u())})},g=(C=!0)=>{a.close(C)},A=(C=!0)=>{l=!1,a&&(g(C),x(),c&&c.hide())},b=()=>{l=!0,w(),u(),c&&c.show()},M=()=>{g(!0)},w=()=>{d==null||d.$amapComponent.setDefaultCursor(o.drawCursor)},x=()=>{r&&(d==null||d.$amapComponent.setDefaultCursor(r))};return e({$$getInstance:p,$$open:b,$$close:A,$$clear:M}),(C,S)=>(y.openBlock(),y.createElementBlock("div"))}});Pe.__file="src/vue-amap/packages/util/MouseTool/MouseTool.vue",Pe.install=t=>(t.component(Pe.name,Pe),t);const Ji=Pe;typeof process!="undefined"&&typeof process.env=="undefined"&&(process.env={});let qn=class{constructor(){this._listeners={}}on(e,n,o){this._listeners[e]?this._listeners[e].push({callback:n,isOnce:o}):this._listeners[e]=[{callback:n,isOnce:o}]}off(e,n){if(!n)throw new Error("\u53D6\u6D88\u4E8B\u4EF6\u65F6\u9700\u8981\u4F20\u5165\u539F\u56DE\u8C03\u51FD\u6570");const o=this._listeners[e];if(o&&o.length>0){for(let i=0;i<o.length;i++)if(o[i].callback===n){o.splice(i,1);break}}}emit(e,...n){const o=this._listeners[e];if(o&&o.length>0)for(let a=0;a<o.length;a++){const r=o[a];r.callback.call(this,...n),r.isOnce&&(o.splice(a,1),a--)}const i=this._listeners["*"];if(i&&i.length>0)for(let a=0;a<i.length;a++){const r=i[a];r.callback.call(this,e,...n),r.isOnce&&(i.splice(a,1),a--)}}trigger(e,...n){this.emit(e,n)}};function Qi(t,e,n){n===void 0&&(n={});var o={type:"Feature"};return(n.id===0||n.id)&&(o.id=n.id),n.bbox&&(o.bbox=n.bbox),o.properties=e||{},o.geometry=t,o}function Un(t,e,n){n===void 0&&(n={});for(var o=0,i=t;o<i.length;o++){var a=i[o];if(a.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var r=0;r<a[a.length-1].length;r++)if(a[a.length-1][r]!==a[0][r])throw new Error("First and last Position are not equivalent.")}var s={type:"Polygon",coordinates:t};return Qi(s,e,n)}function Ac(t,e,n){n===void 0&&(n={});var o={type:"MultiPolygon",coordinates:t};return Qi(o,e,n)}function ta(t){return t.type==="Feature"?t.geometry:t}/**
* splaytree v3.1.1
* Fast Splay tree for Node and browser
*
* @author Alexander Milevski <info@w8r.name>
* @license MIT
* @preserve
*//*! *****************************************************************************
  Copyright (c) Microsoft Corporation. All rights reserved.
  Licensed under the Apache License, Version 2.0 (the "License"); you may not use
  this file except in compliance with the License. You may obtain a copy of the
  License at http://www.apache.org/licenses/LICENSE-2.0

  THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
  WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
  MERCHANTABLITY OR NON-INFRINGEMENT.

  See the Apache Version 2.0 License for specific language governing permissions
  and limitations under the License.
  ***************************************************************************** */function xc(t,e){var n={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},o,i,a,r;return r={next:s(0),throw:s(1),return:s(2)},typeof Symbol=="function"&&(r[Symbol.iterator]=function(){return this}),r;function s(u){return function(p){return l([u,p])}}function l(u){if(o)throw new TypeError("Generator is already executing.");for(;n;)try{if(o=1,i&&(a=u[0]&2?i.return:u[0]?i.throw||((a=i.return)&&a.call(i),0):i.next)&&!(a=a.call(i,u[1])).done)return a;switch(i=0,a&&(u=[u[0]&2,a.value]),u[0]){case 0:case 1:a=u;break;case 4:return n.label++,{value:u[1],done:!1};case 5:n.label++,i=u[1],u=[0];continue;case 7:u=n.ops.pop(),n.trys.pop();continue;default:if(a=n.trys,!(a=a.length>0&&a[a.length-1])&&(u[0]===6||u[0]===2)){n=0;continue}if(u[0]===3&&(!a||u[1]>a[0]&&u[1]<a[3])){n.label=u[1];break}if(u[0]===6&&n.label<a[1]){n.label=a[1],a=u;break}if(a&&n.label<a[2]){n.label=a[2],n.ops.push(u);break}a[2]&&n.ops.pop(),n.trys.pop();continue}u=e.call(t,n)}catch(p){u=[6,p],i=0}finally{o=a=0}if(u[0]&5)throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}var yt=function(){function t(e,n){this.next=null,this.key=e,this.data=n,this.left=null,this.right=null}return t}();function Ec(t,e){return t>e?1:t<e?-1:0}function gt(t,e,n){for(var o=new yt(null,null),i=o,a=o;;){var r=n(t,e.key);if(r<0){if(e.left===null)break;if(n(t,e.left.key)<0){var s=e.left;if(e.left=s.right,s.right=e,e=s,e.left===null)break}a.left=e,a=e,e=e.left}else if(r>0){if(e.right===null)break;if(n(t,e.right.key)>0){var s=e.right;if(e.right=s.left,s.left=e,e=s,e.right===null)break}i.right=e,i=e,e=e.right}else break}return i.right=e.left,a.left=e.right,e.left=o.right,e.right=o.left,e}function Zn(t,e,n,o){var i=new yt(t,e);if(n===null)return i.left=i.right=null,i;n=gt(t,n,o);var a=o(t,n.key);return a<0?(i.left=n.left,i.right=n,n.left=null):a>=0&&(i.right=n.right,i.left=n,n.right=null),i}function ea(t,e,n){var o=null,i=null;if(e){e=gt(t,e,n);var a=n(e.key,t);a===0?(o=e.left,i=e.right):a<0?(i=e.right,e.right=null,o=e):(o=e.left,e.left=null,i=e)}return{left:o,right:i}}function Cc(t,e,n){return e===null?t:(t===null||(e=gt(t.key,e,n),e.left=t),e)}function Gn(t,e,n,o,i){if(t){o(""+e+(n?"\u2514\u2500\u2500 ":"\u251C\u2500\u2500 ")+i(t)+`
`);var a=e+(n?"    ":"\u2502   ");t.left&&Gn(t.left,a,!1,o,i),t.right&&Gn(t.right,a,!0,o,i)}}var Yn=function(){function t(e){e===void 0&&(e=Ec),this._root=null,this._size=0,this._comparator=e}return t.prototype.insert=function(e,n){return this._size++,this._root=Zn(e,n,this._root,this._comparator)},t.prototype.add=function(e,n){var o=new yt(e,n);this._root===null&&(o.left=o.right=null,this._size++,this._root=o);var i=this._comparator,a=gt(e,this._root,i),r=i(e,a.key);return r===0?this._root=a:(r<0?(o.left=a.left,o.right=a,a.left=null):r>0&&(o.right=a.right,o.left=a,a.right=null),this._size++,this._root=o),this._root},t.prototype.remove=function(e){this._root=this._remove(e,this._root,this._comparator)},t.prototype._remove=function(e,n,o){var i;if(n===null)return null;n=gt(e,n,o);var a=o(e,n.key);return a===0?(n.left===null?i=n.right:(i=gt(e,n.left,o),i.right=n.right),this._size--,i):n},t.prototype.pop=function(){var e=this._root;if(e){for(;e.left;)e=e.left;return this._root=gt(e.key,this._root,this._comparator),this._root=this._remove(e.key,this._root,this._comparator),{key:e.key,data:e.data}}return null},t.prototype.findStatic=function(e){for(var n=this._root,o=this._comparator;n;){var i=o(e,n.key);if(i===0)return n;i<0?n=n.left:n=n.right}return null},t.prototype.find=function(e){return this._root&&(this._root=gt(e,this._root,this._comparator),this._comparator(e,this._root.key)!==0)?null:this._root},t.prototype.contains=function(e){for(var n=this._root,o=this._comparator;n;){var i=o(e,n.key);if(i===0)return!0;i<0?n=n.left:n=n.right}return!1},t.prototype.forEach=function(e,n){for(var o=this._root,i=[],a=!1;!a;)o!==null?(i.push(o),o=o.left):i.length!==0?(o=i.pop(),e.call(n,o),o=o.right):a=!0;return this},t.prototype.range=function(e,n,o,i){for(var a=[],r=this._comparator,s=this._root,l;a.length!==0||s;)if(s)a.push(s),s=s.left;else{if(s=a.pop(),l=r(s.key,n),l>0)break;if(r(s.key,e)>=0&&o.call(i,s))return this;s=s.right}return this},t.prototype.keys=function(){var e=[];return this.forEach(function(n){var o=n.key;return e.push(o)}),e},t.prototype.values=function(){var e=[];return this.forEach(function(n){var o=n.data;return e.push(o)}),e},t.prototype.min=function(){return this._root?this.minNode(this._root).key:null},t.prototype.max=function(){return this._root?this.maxNode(this._root).key:null},t.prototype.minNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.left;)e=e.left;return e},t.prototype.maxNode=function(e){if(e===void 0&&(e=this._root),e)for(;e.right;)e=e.right;return e},t.prototype.at=function(e){for(var n=this._root,o=!1,i=0,a=[];!o;)if(n)a.push(n),n=n.left;else if(a.length>0){if(n=a.pop(),i===e)return n;i++,n=n.right}else o=!0;return null},t.prototype.next=function(e){var n=this._root,o=null;if(e.right){for(o=e.right;o.left;)o=o.left;return o}for(var i=this._comparator;n;){var a=i(e.key,n.key);if(a===0)break;a<0?(o=n,n=n.left):n=n.right}return o},t.prototype.prev=function(e){var n=this._root,o=null;if(e.left!==null){for(o=e.left;o.right;)o=o.right;return o}for(var i=this._comparator;n;){var a=i(e.key,n.key);if(a===0)break;a<0?n=n.left:(o=n,n=n.right)}return o},t.prototype.clear=function(){return this._root=null,this._size=0,this},t.prototype.toList=function(){return Sc(this._root)},t.prototype.load=function(e,n,o){n===void 0&&(n=[]),o===void 0&&(o=!1);var i=e.length,a=this._comparator;if(o&&Xn(e,n,0,i-1,a),this._root===null)this._root=Vn(e,n,0,i),this._size=i;else{var r=Oc(this.toList(),wc(e,n),a);i=this._size+i,this._root=Hn({head:r},0,i)}return this},t.prototype.isEmpty=function(){return this._root===null},Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){return this._root},enumerable:!0,configurable:!0}),t.prototype.toString=function(e){e===void 0&&(e=function(o){return String(o.key)});var n=[];return Gn(this._root,"",!0,function(o){return n.push(o)},e),n.join("")},t.prototype.update=function(e,n,o){var i=this._comparator,a=ea(e,this._root,i),r=a.left,s=a.right;i(e,n)<0?s=Zn(n,o,s,i):r=Zn(n,o,r,i),this._root=Cc(r,s,i)},t.prototype.split=function(e){return ea(e,this._root,this._comparator)},t.prototype[Symbol.iterator]=function(){var e;return xc(this,function(n){switch(n.label){case 0:e=this.minNode(),n.label=1;case 1:return e?[4,e]:[3,3];case 2:return n.sent(),e=this.next(e),[3,1];case 3:return[2]}})},t}();function Vn(t,e,n,o){var i=o-n;if(i>0){var a=n+Math.floor(i/2),r=t[a],s=e[a],l=new yt(r,s);return l.left=Vn(t,e,n,a),l.right=Vn(t,e,a+1,o),l}return null}function wc(t,e){for(var n=new yt(null,null),o=n,i=0;i<t.length;i++)o=o.next=new yt(t[i],e[i]);return o.next=null,n.next}function Sc(t){for(var e=t,n=[],o=!1,i=new yt(null,null),a=i;!o;)e?(n.push(e),e=e.left):n.length>0?(e=a=a.next=n.pop(),e=e.right):o=!0;return a.next=null,i.next}function Hn(t,e,n){var o=n-e;if(o>0){var i=e+Math.floor(o/2),a=Hn(t,e,i),r=t.head;return r.left=a,t.head=t.head.next,r.right=Hn(t,i+1,n),r}return null}function Oc(t,e,n){for(var o=new yt(null,null),i=o,a=t,r=e;a!==null&&r!==null;)n(a.key,r.key)<0?(i.next=a,a=a.next):(i.next=r,r=r.next),i=i.next;return a!==null?i.next=a:r!==null&&(i.next=r),o.next}function Xn(t,e,n,o,i){if(!(n>=o)){for(var a=t[n+o>>1],r=n-1,s=o+1;;){do r++;while(i(t[r],a)<0);do s--;while(i(t[s],a)>0);if(r>=s)break;var l=t[r];t[r]=t[s],t[s]=l,l=e[r],e[r]=e[s],e[s]=l}Xn(t,e,n,s,i),Xn(t,e,s+1,o,i)}}function it(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function na(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function K(t,e,n){return e&&na(t.prototype,e),n&&na(t,n),t}var Te=function(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y},Kn=function(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var n=t.ll.x<e.ll.x?e.ll.x:t.ll.x,o=t.ur.x<e.ur.x?t.ur.x:e.ur.x,i=t.ll.y<e.ll.y?e.ll.y:t.ll.y,a=t.ur.y<e.ur.y?t.ur.y:e.ur.y;return{ll:{x:n,y:i},ur:{x:o,y:a}}},vt=Number.EPSILON;vt===void 0&&(vt=Math.pow(2,-52));var kc=vt*vt,Jn=function(t,e){if(-vt<t&&t<vt&&-vt<e&&e<vt)return 0;var n=t-e;return n*n<kc*t*e?0:t<e?-1:1},Lc=function(){function t(){it(this,t),this.reset()}return K(t,[{key:"reset",value:function(){this.xRounder=new oa,this.yRounder=new oa}},{key:"round",value:function(e,n){return{x:this.xRounder.round(e),y:this.yRounder.round(n)}}}]),t}(),oa=function(){function t(){it(this,t),this.tree=new Yn,this.round(0)}return K(t,[{key:"round",value:function(e){var n=this.tree.add(e),o=this.tree.prev(n);if(o!==null&&Jn(n.key,o.key)===0)return this.tree.remove(e),o.key;var i=this.tree.next(n);return i!==null&&Jn(n.key,i.key)===0?(this.tree.remove(e),i.key):e}}]),t}(),Re=new Lc,Be=function(t,e){return t.x*e.y-t.y*e.x},ia=function(t,e){return t.x*e.x+t.y*e.y},ra=function(t,e,n){var o={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y},a=Be(o,i);return Jn(a,0)},an=function(t){return Math.sqrt(ia(t,t))},$c=function(t,e,n){var o={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return Be(i,o)/an(i)/an(o)},Ic=function(t,e,n){var o={x:e.x-t.x,y:e.y-t.y},i={x:n.x-t.x,y:n.y-t.y};return ia(i,o)/an(i)/an(o)},sa=function(t,e,n){return e.y===0?null:{x:t.x+e.x/e.y*(n-t.y),y:n}},la=function(t,e,n){return e.x===0?null:{x:n,y:t.y+e.y/e.x*(n-t.x)}},Pc=function(t,e,n,o){if(e.x===0)return la(n,o,t.x);if(o.x===0)return la(t,e,n.x);if(e.y===0)return sa(n,o,t.y);if(o.y===0)return sa(t,e,n.y);var i=Be(e,o);if(i==0)return null;var a={x:n.x-t.x,y:n.y-t.y},r=Be(a,e)/i,s=Be(a,o)/i,l=t.x+s*e.x,u=n.x+r*o.x,p=t.y+s*e.y,d=n.y+r*o.y,c=(l+u)/2,f=(p+d)/2;return{x:c,y:f}},ct=function(){K(t,null,[{key:"compare",value:function(e,n){var o=t.comparePoints(e.point,n.point);return o!==0?o:(e.point!==n.point&&e.link(n),e.isLeft!==n.isLeft?e.isLeft?1:-1:rn.compare(e.segment,n.segment))}},{key:"comparePoints",value:function(e,n){return e.x<n.x?-1:e.x>n.x?1:e.y<n.y?-1:e.y>n.y?1:0}}]);function t(e,n){it(this,t),e.events===void 0?e.events=[this]:e.events.push(this),this.point=e,this.isLeft=n}return K(t,[{key:"link",value:function(e){if(e.point===this.point)throw new Error("Tried to link already linked events");for(var n=e.point.events,o=0,i=n.length;o<i;o++){var a=n[o];this.point.events.push(a),a.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var e=this.point.events.length,n=0;n<e;n++){var o=this.point.events[n];if(o.segment.consumedBy===void 0)for(var i=n+1;i<e;i++){var a=this.point.events[i];a.consumedBy===void 0&&o.otherSE.point.events===a.otherSE.point.events&&o.segment.consume(a.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var e=[],n=0,o=this.point.events.length;n<o;n++){var i=this.point.events[n];i!==this&&!i.segment.ringOut&&i.segment.isInResult()&&e.push(i)}return e}},{key:"getLeftmostComparator",value:function(e){var n=this,o=new Map,i=function(a){var r=a.otherSE;o.set(a,{sine:$c(n.point,e.point,r.point),cosine:Ic(n.point,e.point,r.point)})};return function(a,r){o.has(a)||i(a),o.has(r)||i(r);var s=o.get(a),l=s.sine,u=s.cosine,p=o.get(r),d=p.sine,c=p.cosine;return l>=0&&d>=0?u<c?1:u>c?-1:0:l<0&&d<0?u<c?-1:u>c?1:0:d<l?-1:d>l?1:0}}}]),t}(),Tc=0,rn=function(){K(t,null,[{key:"compare",value:function(e,n){var o=e.leftSE.point.x,i=n.leftSE.point.x,a=e.rightSE.point.x,r=n.rightSE.point.x;if(r<o)return 1;if(a<i)return-1;var s=e.leftSE.point.y,l=n.leftSE.point.y,u=e.rightSE.point.y,p=n.rightSE.point.y;if(o<i){if(l<s&&l<u)return 1;if(l>s&&l>u)return-1;var d=e.comparePoint(n.leftSE.point);if(d<0)return 1;if(d>0)return-1;var c=n.comparePoint(e.rightSE.point);return c!==0?c:-1}if(o>i){if(s<l&&s<p)return-1;if(s>l&&s>p)return 1;var f=n.comparePoint(e.leftSE.point);if(f!==0)return f;var m=e.comparePoint(n.rightSE.point);return m<0?1:m>0?-1:1}if(s<l)return-1;if(s>l)return 1;if(a<r){var v=n.comparePoint(e.rightSE.point);if(v!==0)return v}if(a>r){var h=e.comparePoint(n.rightSE.point);if(h<0)return 1;if(h>0)return-1}if(a!==r){var g=u-s,A=a-o,b=p-l,M=r-i;if(g>A&&b<M)return 1;if(g<A&&b>M)return-1}return a>r?1:a<r||u<p?-1:u>p?1:e.id<n.id?-1:e.id>n.id?1:0}}]);function t(e,n,o,i){it(this,t),this.id=++Tc,this.leftSE=e,e.segment=this,e.otherSE=n,this.rightSE=n,n.segment=this,n.otherSE=e,this.rings=o,this.windings=i}return K(t,[{key:"replaceRightSE",value:function(e){this.rightSE=e,this.rightSE.segment=this,this.rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var e=this.leftSE.point.y,n=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:e<n?e:n},ur:{x:this.rightSE.point.x,y:e>n?e:n}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(e){return e.x===this.leftSE.point.x&&e.y===this.leftSE.point.y||e.x===this.rightSE.point.x&&e.y===this.rightSE.point.y}},{key:"comparePoint",value:function(e){if(this.isAnEndpoint(e))return 0;var n=this.leftSE.point,o=this.rightSE.point,i=this.vector();if(n.x===o.x)return e.x===n.x?0:e.x<n.x?1:-1;var a=(e.y-n.y)/i.y,r=n.x+a*i.x;if(e.x===r)return 0;var s=(e.x-n.x)/i.x,l=n.y+s*i.y;return e.y===l?0:e.y<l?-1:1}},{key:"getIntersection",value:function(e){var n=this.bbox(),o=e.bbox(),i=Kn(n,o);if(i===null)return null;var a=this.leftSE.point,r=this.rightSE.point,s=e.leftSE.point,l=e.rightSE.point,u=Te(n,s)&&this.comparePoint(s)===0,p=Te(o,a)&&e.comparePoint(a)===0,d=Te(n,l)&&this.comparePoint(l)===0,c=Te(o,r)&&e.comparePoint(r)===0;if(p&&u)return c&&!d?r:!c&&d?l:null;if(p)return d&&a.x===l.x&&a.y===l.y?null:a;if(u)return c&&r.x===s.x&&r.y===s.y?null:s;if(c&&d)return null;if(c)return r;if(d)return l;var f=Pc(a,this.vector(),s,e.vector());return f===null||!Te(i,f)?null:Re.round(f.x,f.y)}},{key:"split",value:function(e){var n=[],o=e.events!==void 0,i=new ct(e,!0),a=new ct(e,!1),r=this.rightSE;this.replaceRightSE(a),n.push(a),n.push(i);var s=new t(i,r,this.rings.slice(),this.windings.slice());return ct.comparePoints(s.leftSE.point,s.rightSE.point)>0&&s.swapEvents(),ct.comparePoints(this.leftSE.point,this.rightSE.point)>0&&this.swapEvents(),o&&(i.checkForConsuming(),a.checkForConsuming()),n}},{key:"swapEvents",value:function(){var e=this.rightSE;this.rightSE=this.leftSE,this.leftSE=e,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var n=0,o=this.windings.length;n<o;n++)this.windings[n]*=-1}},{key:"consume",value:function(e){for(var n=this,o=e;n.consumedBy;)n=n.consumedBy;for(;o.consumedBy;)o=o.consumedBy;var i=t.compare(n,o);if(i!==0){if(i>0){var a=n;n=o,o=a}if(n.prev===o){var r=n;n=o,o=r}for(var s=0,l=o.rings.length;s<l;s++){var u=o.rings[s],p=o.windings[s],d=n.rings.indexOf(u);d===-1?(n.rings.push(u),n.windings.push(p)):n.windings[d]+=p}o.rings=null,o.windings=null,o.consumedBy=n,o.leftSE.consumedBy=n.leftSE,o.rightSE.consumedBy=n.rightSE}}},{key:"prevInResult",value:function(){return this._prevInResult!==void 0?this._prevInResult:(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null,this._prevInResult)}},{key:"beforeState",value:function(){if(this._beforeState!==void 0)return this._beforeState;if(!this.prev)this._beforeState={rings:[],windings:[],multiPolys:[]};else{var e=this.prev.consumedBy||this.prev;this._beforeState=e.afterState()}return this._beforeState}},{key:"afterState",value:function(){if(this._afterState!==void 0)return this._afterState;var e=this.beforeState();this._afterState={rings:e.rings.slice(0),windings:e.windings.slice(0),multiPolys:[]};for(var n=this._afterState.rings,o=this._afterState.windings,i=this._afterState.multiPolys,a=0,r=this.rings.length;a<r;a++){var s=this.rings[a],l=this.windings[a],u=n.indexOf(s);u===-1?(n.push(s),o.push(l)):o[u]+=l}for(var p=[],d=[],c=0,f=n.length;c<f;c++)if(o[c]!==0){var m=n[c],v=m.poly;if(d.indexOf(v)===-1)if(m.isExterior)p.push(v);else{d.indexOf(v)===-1&&d.push(v);var h=p.indexOf(m.poly);h!==-1&&p.splice(h,1)}}for(var g=0,A=p.length;g<A;g++){var b=p[g].multiPoly;i.indexOf(b)===-1&&i.push(b)}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(this._isInResult!==void 0)return this._isInResult;var e=this.beforeState().multiPolys,n=this.afterState().multiPolys;switch(st.type){case"union":{var o=e.length===0,i=n.length===0;this._isInResult=o!==i;break}case"intersection":{var a,r;e.length<n.length?(a=e.length,r=n.length):(a=n.length,r=e.length),this._isInResult=r===st.numMultiPolys&&a<r;break}case"xor":{var s=Math.abs(e.length-n.length);this._isInResult=s%2===1;break}case"difference":{var l=function(u){return u.length===1&&u[0].isSubject};this._isInResult=l(e)!==l(n);break}default:throw new Error("Unrecognized operation type found ".concat(st.type))}return this._isInResult}}],[{key:"fromRing",value:function(e,n,o){var i,a,r,s=ct.comparePoints(e,n);if(s<0)i=e,a=n,r=1;else if(s>0)i=n,a=e,r=-1;else throw new Error("Tried to create degenerate segment at [".concat(e.x,", ").concat(e.y,"]"));var l=new ct(i,!0),u=new ct(a,!1);return new t(l,u,[o],[r])}}]),t}(),ua=function(){function t(e,n,o){if(it(this,t),!Array.isArray(e)||e.length===0)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=n,this.isExterior=o,this.segments=[],typeof e[0][0]!="number"||typeof e[0][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var i=Re.round(e[0][0],e[0][1]);this.bbox={ll:{x:i.x,y:i.y},ur:{x:i.x,y:i.y}};for(var a=i,r=1,s=e.length;r<s;r++){if(typeof e[r][0]!="number"||typeof e[r][1]!="number")throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var l=Re.round(e[r][0],e[r][1]);l.x===a.x&&l.y===a.y||(this.segments.push(rn.fromRing(a,l,this)),l.x<this.bbox.ll.x&&(this.bbox.ll.x=l.x),l.y<this.bbox.ll.y&&(this.bbox.ll.y=l.y),l.x>this.bbox.ur.x&&(this.bbox.ur.x=l.x),l.y>this.bbox.ur.y&&(this.bbox.ur.y=l.y),a=l)}(i.x!==a.x||i.y!==a.y)&&this.segments.push(rn.fromRing(a,i,this))}return K(t,[{key:"getSweepEvents",value:function(){for(var e=[],n=0,o=this.segments.length;n<o;n++){var i=this.segments[n];e.push(i.leftSE),e.push(i.rightSE)}return e}}]),t}(),Rc=function(){function t(e,n){if(it(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new ua(e[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var o=1,i=e.length;o<i;o++){var a=new ua(e[o],this,!1);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.interiorRings.push(a)}this.multiPoly=n}return K(t,[{key:"getSweepEvents",value:function(){for(var e=this.exteriorRing.getSweepEvents(),n=0,o=this.interiorRings.length;n<o;n++)for(var i=this.interiorRings[n].getSweepEvents(),a=0,r=i.length;a<r;a++)e.push(i[a]);return e}}]),t}(),ca=function(){function t(e,n){if(it(this,t),!Array.isArray(e))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{typeof e[0][0][0]=="number"&&(e=[e])}catch(r){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var o=0,i=e.length;o<i;o++){var a=new Rc(e[o],this);a.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=a.bbox.ll.x),a.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=a.bbox.ll.y),a.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=a.bbox.ur.x),a.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=a.bbox.ur.y),this.polys.push(a)}this.isSubject=n}return K(t,[{key:"getSweepEvents",value:function(){for(var e=[],n=0,o=this.polys.length;n<o;n++)for(var i=this.polys[n].getSweepEvents(),a=0,r=i.length;a<r;a++)e.push(i[a]);return e}}]),t}(),Bc=function(){K(t,null,[{key:"factory",value:function(e){for(var n=[],o=0,i=e.length;o<i;o++){var a=e[o];if(!(!a.isInResult()||a.ringOut)){for(var r=null,s=a.leftSE,l=a.rightSE,u=[s],p=s.point,d=[];r=s,s=l,u.push(s),s.point!==p;)for(;;){var c=s.getAvailableLinkedEvents();if(c.length===0){var f=u[0].point,m=u[u.length-1].point;throw new Error("Unable to complete output ring starting at [".concat(f.x,",")+" ".concat(f.y,"]. Last matching segment found ends at")+" [".concat(m.x,", ").concat(m.y,"]."))}if(c.length===1){l=c[0].otherSE;break}for(var v=null,h=0,g=d.length;h<g;h++)if(d[h].point===s.point){v=h;break}if(v!==null){var A=d.splice(v)[0],b=u.splice(A.index);b.unshift(b[0].otherSE),n.push(new t(b.reverse()));continue}d.push({index:u.length,point:s.point});var M=s.getLeftmostComparator(r);l=c.sort(M)[0].otherSE;break}n.push(new t(u))}}return n}}]);function t(e){it(this,t),this.events=e;for(var n=0,o=e.length;n<o;n++)e[n].segment.ringOut=this;this.poly=null}return K(t,[{key:"getGeom",value:function(){for(var e=this.events[0].point,n=[e],o=1,i=this.events.length-1;o<i;o++){var a=this.events[o].point,r=this.events[o+1].point;ra(a,e,r)!==0&&(n.push(a),e=a)}if(n.length===1)return null;var s=n[0],l=n[1];ra(s,e,l)===0&&n.shift(),n.push(n[0]);for(var u=this.isExteriorRing()?1:-1,p=this.isExteriorRing()?0:n.length-1,d=this.isExteriorRing()?n.length:-1,c=[],f=p;f!=d;f+=u)c.push([n[f].x,n[f].y]);return c}},{key:"isExteriorRing",value:function(){if(this._isExteriorRing===void 0){var e=this.enclosingRing();this._isExteriorRing=e?!e.isExteriorRing():!0}return this._isExteriorRing}},{key:"enclosingRing",value:function(){return this._enclosingRing===void 0&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var e=this.events[0],n=1,o=this.events.length;n<o;n++){var i=this.events[n];ct.compare(e,i)>0&&(e=i)}for(var a=e.segment.prevInResult(),r=a?a.prevInResult():null;;){if(!a)return null;if(!r)return a.ringOut;if(r.ringOut!==a.ringOut)return r.ringOut.enclosingRing()!==a.ringOut?a.ringOut:a.ringOut.enclosingRing();a=r.prevInResult(),r=a?a.prevInResult():null}}}]),t}(),pa=function(){function t(e){it(this,t),this.exteriorRing=e,e.poly=this,this.interiorRings=[]}return K(t,[{key:"addInterior",value:function(e){this.interiorRings.push(e),e.poly=this}},{key:"getGeom",value:function(){var e=[this.exteriorRing.getGeom()];if(e[0]===null)return null;for(var n=0,o=this.interiorRings.length;n<o;n++){var i=this.interiorRings[n].getGeom();i!==null&&e.push(i)}return e}}]),t}(),Nc=function(){function t(e){it(this,t),this.rings=e,this.polys=this._composePolys(e)}return K(t,[{key:"getGeom",value:function(){for(var e=[],n=0,o=this.polys.length;n<o;n++){var i=this.polys[n].getGeom();i!==null&&e.push(i)}return e}},{key:"_composePolys",value:function(e){for(var n=[],o=0,i=e.length;o<i;o++){var a=e[o];if(!a.poly)if(a.isExteriorRing())n.push(new pa(a));else{var r=a.enclosingRing();r.poly||n.push(new pa(r)),r.poly.addInterior(a)}}return n}}]),t}(),Fc=function(){function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rn.compare;it(this,t),this.queue=e,this.tree=new Yn(n),this.segments=[]}return K(t,[{key:"process",value:function(e){var n=e.segment,o=[];if(e.consumedBy)return e.isLeft?this.queue.remove(e.otherSE):this.tree.remove(n),o;var i=e.isLeft?this.tree.insert(n):this.tree.find(n);if(!i)throw new Error("Unable to find segment #".concat(n.id," ")+"[".concat(n.leftSE.point.x,", ").concat(n.leftSE.point.y,"] -> ")+"[".concat(n.rightSE.point.x,", ").concat(n.rightSE.point.y,"] ")+"in SweepLine tree. Please submit a bug report.");for(var a=i,r=i,s=void 0,l=void 0;s===void 0;)a=this.tree.prev(a),a===null?s=null:a.key.consumedBy===void 0&&(s=a.key);for(;l===void 0;)r=this.tree.next(r),r===null?l=null:r.key.consumedBy===void 0&&(l=r.key);if(e.isLeft){var u=null;if(s){var p=s.getIntersection(n);if(p!==null&&(n.isAnEndpoint(p)||(u=p),!s.isAnEndpoint(p)))for(var d=this._splitSafely(s,p),c=0,f=d.length;c<f;c++)o.push(d[c])}var m=null;if(l){var v=l.getIntersection(n);if(v!==null&&(n.isAnEndpoint(v)||(m=v),!l.isAnEndpoint(v)))for(var h=this._splitSafely(l,v),g=0,A=h.length;g<A;g++)o.push(h[g])}if(u!==null||m!==null){var b=null;if(u===null)b=m;else if(m===null)b=u;else{var M=ct.comparePoints(u,m);b=M<=0?u:m}this.queue.remove(n.rightSE),o.push(n.rightSE);for(var w=n.split(b),x=0,C=w.length;x<C;x++)o.push(w[x])}o.length>0?(this.tree.remove(n),o.push(e)):(this.segments.push(n),n.prev=s)}else{if(s&&l){var S=s.getIntersection(l);if(S!==null){if(!s.isAnEndpoint(S))for(var N=this._splitSafely(s,S),F=0,E=N.length;F<E;F++)o.push(N[F]);if(!l.isAnEndpoint(S))for(var T=this._splitSafely(l,S),D=0,I=T.length;D<I;D++)o.push(T[D])}}this.tree.remove(n)}return o}},{key:"_splitSafely",value:function(e,n){this.tree.remove(e);var o=e.rightSE;this.queue.remove(o);var i=e.split(n);return i.push(o),e.consumedBy===void 0&&this.tree.insert(e),i}}]),t}(),ha=typeof process!="undefined"&&process.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,Dc=typeof process!="undefined"&&process.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,jc=function(){function t(){it(this,t)}return K(t,[{key:"run",value:function(e,n,o){st.type=e,Re.reset();for(var i=[new ca(n,!0)],a=0,r=o.length;a<r;a++)i.push(new ca(o[a],!1));if(st.numMultiPolys=i.length,st.type==="difference")for(var s=i[0],l=1;l<i.length;)Kn(i[l].bbox,s.bbox)!==null?l++:i.splice(l,1);if(st.type==="intersection"){for(var u=0,p=i.length;u<p;u++)for(var d=i[u],c=u+1,f=i.length;c<f;c++)if(Kn(d.bbox,i[c].bbox)===null)return[]}for(var m=new Yn(ct.compare),v=0,h=i.length;v<h;v++)for(var g=i[v].getSweepEvents(),A=0,b=g.length;A<b;A++)if(m.insert(g[A]),m.size>ha)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var M=new Fc(m),w=m.size,x=m.pop();x;){var C=x.key;if(m.size===w){var S=C.segment;throw new Error("Unable to pop() ".concat(C.isLeft?"left":"right"," SweepEvent ")+"[".concat(C.point.x,", ").concat(C.point.y,"] from segment #").concat(S.id," ")+"[".concat(S.leftSE.point.x,", ").concat(S.leftSE.point.y,"] -> ")+"[".concat(S.rightSE.point.x,", ").concat(S.rightSE.point.y,"] from queue. ")+"Please file a bug report.")}if(m.size>ha)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(M.segments.length>Dc)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var N=M.process(C),F=0,E=N.length;F<E;F++){var T=N[F];T.consumedBy===void 0&&m.insert(T)}w=m.size,x=m.pop()}Re.reset();var D=Bc.factory(M.segments),I=new Nc(D);return I.getGeom()}}]),t}(),st=new jc,zc=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return st.run("union",t,n)},Wc=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return st.run("intersection",t,n)},qc=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return st.run("xor",t,n)},Uc=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),o=1;o<e;o++)n[o-1]=arguments[o];return st.run("difference",t,n)},Zc={union:zc,intersection:Wc,xor:qc,difference:Uc};function Gc(t,e,n){n===void 0&&(n={});var o=ta(t),i=ta(e),a=Zc.intersection(o.coordinates,i.coordinates);return a.length===0?null:a.length===1?Un(a[0],n.properties):Ac(a,n.properties)}const H={mergeArray(t,e){if(e.length<5e4)t.push.apply(t,e);else for(let n=0,o=e.length;n<o;n+=1)t.push(e[n])},now:Date.now||function(){return new Date().getTime()},bind(t,e){return t.bind?t.bind(e):function(){return t.apply(e,arguments)}},forEach(t,e,n){if(t.forEach)return t.forEach(e,n);for(let o=0,i=t.length;o<i;o++)e.call(n,t[o],o)},map(t,e,n){if(t.map)return t.map(e,n);const o=[];for(let i=0,a=t.length;i<a;i++)o[i]=e.call(n,t[i],i);return o},merge(t,e){if(e.length<5e4)Array.prototype.push.apply(t,e);else for(let n=0,o=e.length;n<o;n+=1)t.push(e[n])},arrayIndexOf(t,e,n){if(t.indexOf)return t.indexOf(e,n);let o,i=t,a=i.length>>>0;if(a===0)return-1;const r=0|n;if(r>=a)return-1;for(o=Math.max(r>=0?r:a-Math.abs(r),0);o<a;){if(o in i&&i[o]===e)return o;o++}return-1},extend(t){return t||(t={}),this.extendObjs(t,Array.prototype.slice.call(arguments,1))},extendObjs(t,e){t||(t={});for(let n=0,o=e.length;n<o;n++){const i=e[n];if(i)for(const a in i)i.hasOwnProperty(a)&&(t[a]=i[a])}return t},debounce(t,e,n){let o,i,a,r,s,l=function(){const u=H.now()-r;u<e&&u>=0?o=setTimeout(l,e-u):(o=null,n||(s=t.apply(a,i),o||(a=i=null)))};return function(){a=this,i=arguments,r=H.now();const u=n&&!o;return o||(o=setTimeout(l,e)),u&&(s=t.apply(a,i),a=i=null),s}},throttle(t,e,n){let o,i,a,r=null,s=0;n||(n={});const l=function(){s=n.leading===!1?0:H.now(),r=null,a=t.apply(o,i),r||(o=i=null)};return function(){const u=H.now();s||n.leading!==!1||(s=u);const p=e-(u-s);return o=this,i=arguments,p<=0||p>e?(r&&(clearTimeout(r),r=null),s=u,a=t.apply(o,i),r||(o=i=null)):r||n.trailing===!1||(r=setTimeout(l,p)),a}},escapeHtml(t){const e={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};return`${t}`.replace(/[&<>"']/g,function(n){return e[n]})}};var Qn={BBRFLAG:{I:1,S:2},ADCODES:{COUNTRY:1e5}};function Yc(t){return t}function Vc(t){if(t==null)return Yc;var e,n,o=t.scale[0],i=t.scale[1],a=t.translate[0],r=t.translate[1];return function(s,l){l||(e=n=0);var u=2,p=s.length,d=new Array(p);for(d[0]=(e+=s[0])*o+a,d[1]=(n+=s[1])*i+r;u<p;)d[u]=s[u],++u;return d}}function Hc(t,e){for(var n,o=t.length,i=o-e;i<--o;)n=t[i],t[i++]=t[o],t[o]=n}function Xc(t,e){return typeof e=="string"&&(e=t.objects[e]),e.type==="GeometryCollection"?{type:"FeatureCollection",features:e.geometries.map(function(n){return da(t,n)})}:da(t,e)}function da(t,e){var n=e.id,o=e.bbox,i=e.properties==null?{}:e.properties,a=Kc(t,e);return n==null&&o==null?{type:"Feature",properties:i,geometry:a}:o==null?{type:"Feature",id:n,properties:i,geometry:a}:{type:"Feature",id:n,bbox:o,properties:i,geometry:a}}function Kc(t,e){var n=Vc(t.transform),o=t.arcs;function i(p,d){d.length&&d.pop();for(var c=o[p<0?~p:p],f=0,m=c.length;f<m;++f)d.push(n(c[f],f));p<0&&Hc(d,m)}function a(p){return n(p)}function r(p){for(var d=[],c=0,f=p.length;c<f;++c)i(p[c],d);return d.length<2&&d.push(d[0]),d}function s(p){for(var d=r(p);d.length<4;)d.push(d[0]);return d}function l(p){return p.map(s)}function u(p){var d=p.type,c;switch(d){case"GeometryCollection":return{type:d,geometries:p.geometries.map(u)};case"Point":c=a(p.coordinates);break;case"MultiPoint":c=p.coordinates.map(a);break;case"LineString":c=r(p.arcs);break;case"MultiLineString":c=p.arcs.map(r);break;case"Polygon":c=l(p.arcs);break;case"MultiPolygon":c=p.arcs.map(l);break;default:return null}return{type:d,coordinates:c}}return u(e)}function Jc(t,e){let n,o,i,a,r=t;n=e[e.length-2];for(let s=0,l=e.length-1;s<l;s++){o=e[s];const u=r;r=[],i=u[u.length-1];for(let p=0,d=u.length;p<d;p++)a=u[p],to(a,n,o)?(to(i,n,o)||r.push(fa(n,o,i,a)),r.push(a)):to(i,n,o)&&r.push(fa(n,o,i,a)),i=a;n=o}return r.length<3?[]:(r.push(r[0]),r)}function Qc(t,e,n){const o=(n[1]-e[1])/(n[0]-e[0])*(t[0]-e[0])+e[1];return Math.abs(o-t[1])<1e-6&&t[0]>=e[0]&&t[0]<=n[0]}function tp(t,e){for(let n=0,o=e.length;n<o-1;n++)if(Qc(t,e[n],e[n+1]))return!0;return!1}function ep(t,e){let n=!1;for(let o=t[0],i=t[1],a=0,r=e.length,s=r-1;a<r;s=a++){const l=e[a][0],u=e[a][1],p=e[s][0],d=e[s][1];u>i!=d>i&&o<(p-l)*(i-u)/(d-u)+l&&(n=!n)}return n}function np(t,e,n){let o,i=e[0],a=e[1];const r=n[0]-i,s=n[1]-a,l=r*r+s*s;return l>0&&(o=((t[0]-i)*r+(t[1]-a)*s)/l,o>1?(i=n[0],a=n[1]):o>0&&(i+=r*o,a+=s*o)),[i,a]}function op(t,e,n){const o=np(t,e,n),i=t[0]-o[0],a=t[1]-o[1];return i*i+a*a}function ip(t,e){let n=Number.MAX_VALUE;for(let o=0,i=e.length;o<i-1;o++){const a=op(t,e[o],e[o+1]);a<n&&(n=a)}return n}function to(t,e,n){return(n[0]-e[0])*(t[1]-e[1])>(n[1]-e[1])*(t[0]-e[0])}function fa(t,e,n,o){const i=[t[0]-e[0],t[1]-e[1]],a=[n[0]-o[0],n[1]-o[1]],r=t[0]*e[1]-t[1]*e[0],s=n[0]*o[1]-n[1]*o[0],l=1/(i[0]*a[1]-i[1]*a[0]);return[(r*a[0]-s*i[0])*l,(r*a[1]-s*i[1])*l]}var sn={sqClosestDistanceToPolygon:ip,pointOnPolygon:tp,pointInPolygon:ep,polygonClip:Jc};const eo=Qn.BBRFLAG,no=[];function ap(t,e){const n=[];for(let o=0,i=t.length;o<i;o++){const a=t[o].split("-");let r=a[0],s=a.length>1?a[1]:r;r=parseInt(r,e),s=parseInt(s,e);for(let l=r;l<=s;l++)n.push(l)}return n}function ma(t,e,n){if(t[e])throw new Error(`Alreay exists:  ${t[e]}`);t[e]=n}function rp(t){return no[t]||(no[t]=[eo.I,t]),no[t]}function sp(t,e,n){if(t)for(let o=t.split(":"),i=parseInt(o[0],e),a=ap(o[1].split(","),e),r=rp(i),s=0,l=a.length;s<l;s++)ma(n,a[s],r)}function lp(t,e,n){if(t){const o=[];let i=t.split(":"),a=parseInt(i[0],e);const r=i[1].split(";");for(let s=0,l=r.length;s<l;s++){i=r[s].split(",");const u=[parseInt(i[0],e),0];i.length>1&&(u[1]=parseInt(i[1],e)),o.push(u)}ma(n,a,[eo.S,o])}}function ya(t,e){if(!t)return null;const n=t.split(","),o=[];for(let i=0,a=n.length;i<a;i++){if(parseInt(n[i],e)<0)return null;o.push(parseInt(n[i],e))}return o}function up(t,e){if(!t)return null;const n=t.split(";"),o=[];for(let i=0,a=n.length;i<a;i++)o.push(ya(n[i],e));return o}function cp(t){let e,n;const o=t.r,i=[],a=t.idx.i.split("|");for(t.idx.i=null,e=0,n=a.length;e<n;e++)sp(a[e],o,i);a.length=0;const r=t.idx.s.split("|");for(t.idx.s=null,e=0,n=r.length;e<n;e++)lp(r[e],o,i);r.length=0,t.idx=null,t.idxList=i,t.mxr&&(t.maxRect=ya(t.mxr,o),t.mxr=null),t.mxsr&&(t.maxSubRect=up(t.mxsr,o),t.mxsr=null)}function pp(t,e,n){for(let o=t.geoData.sub.features,i=0,a=n.length;i<a;i++){const r=n[i],s=o[r[0]],l=s.geometry.coordinates[r[1]][0],u=sn.polygonClip(l,e);!u||u.length<4?console.warn(`Cliped ring length werid: ${u}`):r[2]=u}return!0}function hp(t,e,n){const o=t.bbIndex,i=o.s;(e<0||n<0||n>=o.h||e>=o.w)&&console.warn("Wrong x,y",e,n,o);const a=n*o.w+e,r=o.idxList[a];if(r[0]!==eo.S)return!1;const s=r[1];if(s[0].length>2)return!1;const l=e*i+o.l,u=n*i+o.t;return pp(t,[[l,u],[l+i,u],[l+i,u+i],[l,u+i],[l,u]],s),!0}var ga={prepareGridFeatureClip:hp,buildIdxList:cp};class It{constructor(e,n,o,i){this.x=e,this.y=n,this.width=o,this.height=i}static getBoundsItemToExpand(){return new It(Number.MAX_VALUE,Number.MAX_VALUE,-1,-1)}static boundsIntersect(e,n){return e.x<=n.x+n.width&&n.x<=e.x+e.width&&e.y<=n.y+n.height&&n.y<=e.y+e.height}isEmpty(){return this.width<0}expandByPoint(e,n){let o,i,a,r;this.isEmpty()?(o=a=e,i=r=n):(o=this.x,i=this.y,a=this.x+this.width,r=this.y+this.height,e<o?o=e:e>a&&(a=e),n<i?i=n:n>r&&(r=n)),this.x=o,this.y=i,this.width=a-o,this.height=r-i}}function dp(t){const e={},n=t.objects;for(const o in n)e[o]=Xc(t,n[o]);return e}function fp(t){for(let e=t.sub?t.sub.features:[],n=t.parent.properties,o=(n.acroutes||[]).concat([n.adcode]),i=0,a=e.length;i<a;i++)e[i].properties.subFeatureIndex=i,e[i].properties.acroutes=o}function mp(t){if(!t._isBuiled){ga.buildIdxList(t.bbIndex),t.geoData=dp(t.topo),t.geoData.sub&&fp(t.geoData);const e=t.topo.bbox;t.bounds=new It(e[0],e[1],e[2]-e[0],e[3]-e[1]),t.topo=null,t._isBuiled=!0}return t}var yp={buildData:mp};const oo={},Pt=Math.PI/180,va=180/Math.PI,gp=Math.PI/4,ba=.5/Math.PI;function io(t){return oo[t]||(oo[t]=256*Math.pow(2,t)),oo[t]}function vp(t){let e=t[1],n=t[0]*Pt,o=e*Pt;return o=Math.log(Math.tan(gp+o/2)),[n,o]}function bp(t,e){e=e||1;const n=ba,o=.5,i=-n;return[e*(n*t[0]+o),e*(i*t[1]+.5)]}function _p(t){const e=t[0]*va,n=(2*Math.atan(Math.exp(t[1]))-Math.PI/2)*va;return[parseFloat(e.toFixed(6)),parseFloat(n.toFixed(6))]}function Mp(t,e){const n=ba,o=.5,i=-n;return[(t[0]/e-o)/n,(t[1]/e-.5)/i]}function _a(t,e,n){const o=bp(vp(t),e);return n&&(o[0]=Math.round(o[0]),o[1]=Math.round(o[1])),o}function Ap(t,e,n){return _a(t,io(e),n)}function xp(t,e){const n=io(e),o=Mp(t,n);return _p(o)}function Ep(t,e){const n=Math.cos,o=t[1]*Pt,i=t[0]*Pt,a=e[1]*Pt,r=e[0]*Pt,s=a-o,l=r-i,u=(1-n(s)+(1-n(l))*n(o)*n(a))/2;return 12756274*Math.asin(Math.sqrt(u))}var ao={haversineDistance:Ep,getScale:io,lngLatToPointByScale:_a,pointToLngLat:xp,lngLatToPoint:Ap};let Cp=class Yr{constructor(e,n,o){this.adcode=e,this._data=n,this._sqScaleFactor=n.scale*n.scale,this._opts=Object.assign({nearTolerance:2},o),this.setNearTolerance(this._opts.nearTolerance)}static getPropsOfFeature(e){return e&&e.properties?e.properties:null}static getAdcodeOfFeature(e){return e?e.properties.adcode:null}static doesFeatureHasChildren(e){return!!e&&e.properties.childrenNum>0}setNearTolerance(e){this._opts.nearTolerance=e,this._sqNearTolerance=e*e}getIdealZoom(){return this._data.idealZoom}_getEmptySubFeatureGroupItem(e){return{subFeatureIndex:e,subFeature:this.getSubFeatureByIndex(e),pointsIndexes:[],points:[]}}groupByPosition(e,n){let o,i,a={},r=null;for(o=0,i=e.length;o<i;o++){const l=this.getLocatedSubFeatureIndex(n.call(null,e[o],o));a[l]||(a[l]=this._getEmptySubFeatureGroupItem(l)),a[l].pointsIndexes.push(o),a[l].points.push(e[o]),l<0&&(r=a[l])}const s=[];if(this._data.geoData.sub)for(o=0,i=this._data.geoData.sub.features.length;o<i;o++)s.push(a[o]||this._getEmptySubFeatureGroupItem(o));return r&&s.push(r),a=null,s}getLocatedSubFeatureIndex(e){return this._getLocatedSubFeatureIndexByPixel(this.lngLatToPixel(e))}getSubFeatureByIndex(e){return e>=0?this.getSubFeatures()[e]:null}_getLocatedSubFeatureIndexByPixel(e){if(!this._data.geoData.sub)return-1;const n=this._data,o=n.bbIndex,i=e[0]-o.l,a=e[1]-o.t,r=Math.floor(a/o.s),s=Math.floor(i/o.s);if(s<0||r<0||r>=o.h||s>=o.w)return-1;const l=r*o.w+s,u=o.idxList[l];if(!u)return-1;const p=Qn.BBRFLAG;switch(u[0]){case p.I:return u[1];case p.S:return ga.prepareGridFeatureClip(n,s,r),this._calcLocatedFeatureIndexOfSList(e,u[1]);default:throw new Error(`Unknown BBRFLAG: ${u[0]}`)}}_calcNearestFeatureIndexOfSList(e,n){let o=[];this._data.geoData.sub&&(o=this._data.geoData.sub.features);const i={sq:Number.MAX_VALUE,idx:-1};for(let a=0,r=n.length;a<r;a++){const s=n[a],l=o[s[0]],u=s[2]||l.geometry.coordinates[s[1]][0],p=sn.sqClosestDistanceToPolygon(e,u);p<i.sq&&(i.sq=p,i.idx=s[0])}return i.sq/this._sqScaleFactor<this._sqNearTolerance?i.idx:-1}_calcLocatedFeatureIndexOfSList(e,n){for(let o=this._data.geoData.sub.features,i=0,a=n.length;i<a;i++){const r=n[i],s=o[r[0]],l=r[2]||s.geometry.coordinates[r[1]][0];if(sn.pointInPolygon(e,l)||sn.pointOnPolygon(e,l))return r[0]}return this._calcNearestFeatureIndexOfSList(e,n)}pixelToLngLat(e,n){return ao.pointToLngLat([e,n],this._data.pz)}lngLatToPixel(e){e instanceof AMap.LngLat&&(e=[e.getLng(),e.getLat()]);const n=ao.lngLatToPoint(e,this._data.pz);return[Math.round(n[0]),Math.round(n[1])]}_convertRingCoordsToLngLats(e){const n=[];for(let o=0,i=e.length;o<i;o++)n[o]=this.pixelToLngLat(e[o][0],e[o][1]);return n}_convertPolygonCoordsToLngLats(e){const n=[];for(let o=0,i=e.length;o<i;o++)n[o]=this._convertRingCoordsToLngLats(e[o]);return n}_convertMultiPolygonCoordsToLngLats(e){const n=[];for(let o=0,i=e.length;o<i;o++)n[o]=this._convertPolygonCoordsToLngLats(e[o]);return n}_convertCoordsToLngLats(e,n){switch(e){case"MultiPolygon":return this._convertMultiPolygonCoordsToLngLats(n);default:throw new Error(`Unknown type ${e}`)}}_createLngLatFeature(e,n){const o=Object.assign({},e);return n&&Object.assign(o.properties,n),o.geometry=Object.assign({},o.geometry),o.geometry.coordinates=this._convertCoordsToLngLats(o.geometry.type,o.geometry.coordinates),o}getAdcode(){return this.getProps("adcode")}getName(){return this.getProps("name")}getChildrenNum(){return this.getProps("childrenNum")}getProps(e){const n=Yr.getPropsOfFeature(this._data.geoData.parent);return n?e?n[e]:n:null}getParentFeature(){const e=this._data.geoData;return e.lngLatParent||(e.lngLatParent=this._createLngLatFeature(e.parent)),e.lngLatParent}getParentFeatureInPixel(){return this._data.geoData.parent}getSubFeatures(){const e=this._data.geoData;if(!e.sub)return[];if(!e.lngLatSubList){const n=[];for(let o=e.sub.features,i=0,a=o.length;i<a;i++)n[i]=this._createLngLatFeature(o[i]);e.lngLatSubList=n}return[].concat(e.lngLatSubList)}getSubFeaturesInPixel(){return this._data.geoData.sub?[].concat(this._data.geoData.sub.features):[]}getBounds(){const e=this._data;if(!e.lngLatBounds){const n=this._data.bounds;e.lngLatBounds=new AMap.Bounds(this.pixelToLngLat(n.x,n.y+n.height),this.pixelToLngLat(n.x+n.width,n.y))}return e.lngLatBounds}},wp=class extends qn{constructor(e){super(),this._opts=Object.assign({distDataLoc:"//webapi.amap.com/ui/1.1/ui/geo/DistrictExplorer/assets/d_v2"},e),this._areaNodesForLocating=null,this._areaNodeCache={},this._opts.preload&&this.loadMultiAreaNodes(this._opts.preload)}setAreaNodesForLocating(e){e?Array.isArray(e)||(e=[e]):e=[],this._areaNodesForLocating=e||[]}_loadJson(e,n){const o=this;return fetch(e,{headers:{Accept:"application/json"}}).then(i=>i.json()).then(i=>{n&&n.call(o,null,i)}).catch(i=>{if(!n)throw i;n(i)})}_getAreaNodeDataFileName(e){return`an_${e}.json`}_getAreaNodeDataSrc(e){return`${this._opts.distDataLoc}/${this._getAreaNodeDataFileName(e)}`}loadAreaTree(e){this._loadJson(`${this._opts.distDataLoc}/area_tree.json`,e)}loadCountryNode(e){this.loadAreaNode(Qn.ADCODES.COUNTRY,e)}loadMultiAreaNodes(e,n){let o=[],i=!1,a;function r(s){return function(l,u){i||(a--,l?(n&&n(l),i=!0):(o[s]=u,a===0&&n&&n(null,o)))}}if(e&&e.length){const s=e.length;for(let l=0;l<s;l++)this.loadAreaNode(e[l],n?r(l):null)}else n&&n(null,[])}loadAreaNode(e,n,o,i){if(o=o||this,this._areaNodeCache[e]){if(n){const a=this._areaNodeCache[e];i?n.call(o,null,a,!0):setTimeout(function(){n.call(o,null,a)},0)}}else this._loadJson(this._getAreaNodeDataSrc(e),(a,r)=>{a?n&&n.call(o,a):(this._buildAreaNode(e,r),n&&n.call(o,null,this._areaNodeCache[e]))})}getLocalAreaNode(e){return this._areaNodeCache[e]||null}_buildAreaNode(e,n){if(!this._areaNodeCache[e]){if(!n)throw new Error(`Empty distData: ${e}`);const o=new Cp(e,yp.buildData(n),this._opts);this._areaNodeCache[e]=o,this._areaNodesForLocating||(this._areaNodesForLocating=[o])}}clearAreaNodeCacheByAdcode(e){const n=this._areaNodeCache;return delete n[e],!0}destroy(){this._areaNodesForLocating=null,this._areaNodeCache=null,this._opts=null}},Sp=class{constructor(e){this.isDistReady=!1,this.nodeMap={},this.waitFnList=[],this.singleDistExplorer=new wp({}),this._opts=H.extend({topAdcodes:[1e5]},e),this._touchMap={},this.singleDistExplorer.loadAreaTree((n,o)=>{if(n)throw n;if(this.filterAreaTree(o),this.singleCountryNode=o,this.isDistReady=!0,this.waitFnList.length){for(let i=0,a=this.waitFnList.length;i<a;i++)this.waitFnList[i][0].call(this.waitFnList[i][1]);this.waitFnList.length=0}this.singleDistExplorer.loadMultiAreaNodes(this._opts.topAdcodes)})}pixelToLngLat(e,n,o){return ao.pointToLngLat([e,n],o)}getBounds(e){const n=e.bbounds;return new AMap.Bounds(this.pixelToLngLat(n.x,n.y+n.height,20),this.pixelToLngLat(n.x+n.width,n.y,20))}filterAreaTree(e){const n=[e];do{const o=n.pop();this.nodeMap[o.adcode]=o;const i=o.bbox;if(o.bbounds=new It(i[0],i[1],i[2],i[3]),o.bbox=this.getBounds(o),o.children)for(let a=o.children,r=0,s=a.length;r<s;r++)a[r].childIdx=r,n.push(a[r])}while(n.length)}isReady(){return this.isDistReady}getParentAdcode(e,n){if(!n){const o=this.getNodeByAdcode(e);if(!o)return console.warn(`Can not find node: ${e}`),null;n=o.acroutes}return n&&n.length?n[n.length-1]:null}getSubIdx(e){return this.getNodeByAdcode(e).childIdx}getChildrenNum(e){const n=this.getNodeByAdcode(e);return this.getChildrenNumOfNode(n)}getChildrenNumOfNode(e){return e.children?e.children.length:e.childrenNum||0}getNodeByAdcode(e){const n=this.nodeMap[e];if(!n){let o=this.singleDistExplorer.getLocalAreaNode(`${`${e}`.substr(0,4)}00`);if(o||(o=this.singleDistExplorer.getLocalAreaNode(`${`${e}`.substr(0,2)}0000`)),!o)return null;for(let i=o.getSubFeatures(),a=0,r=i.length;a<r;a++)if(i[a].properties.adcode===e)return i[a].properties}return n}getNodeChildren(e){const n=this.getNodeByAdcode(e);if(!n)return null;if(n.children)return n.children;if(n.childrenNum>=0){const o=this.singleDistExplorer.getLocalAreaNode(e);if(!o)return null;const i=[],a=o.getSubFeaturesInPixel();for(let r=0,s=a.length;r<s;r++)i.push(a[r].properties);return i}return null}getExplorer(){return this.singleDistExplorer}traverseCountry(e,n,o,i,a){this.traverseNode(this.singleCountryNode,e,n,o,i,a,[])}getNodeBoundsSize(e,n){const o=this.getPixelZoom(),i=Math.pow(2,o-n);return[e.bbounds.width/i,e.bbounds.height/i]}doesRingRingIntersect(e,n){const o=[e.getNorthWest().toArray(),e.getNorthEast().toArray(),e.getSouthEast().toArray(),e.getSouthWest().toArray(),e.getNorthWest().toArray()],i=[n.getNorthWest().toArray(),n.getNorthEast().toArray(),n.getSouthEast().toArray(),n.getSouthWest().toArray(),n.getNorthWest().toArray()];return!!Gc(Un([o]),Un([i]))}traverseNode(e,n,o,i,a,r,s,l){if(!(s&&s.indexOf(e.adcode)>=0)){if(this.doesRingRingIntersect(n,e.bbox)){const u=e.children,p=u&&u.length>0;if(o>e.idealZoom&&p)for(let d=0,c=u.length;d<c;d++)this.traverseNode(u[d],n,o,i,null,r,s);else i.call(r,e)}a&&(l?(l.count++,l.count>=l.total&&a.call(r)):a.call(r))}}onReady(e,n,o){this.isDistReady?o?e.call(n):setTimeout(function(){e.call(n)},0):this.waitFnList.push([e,n])}getPixelZoom(){var e;return(e=this.singleCountryNode)===null||e===void 0?void 0:e.pz}loadAreaNode(e,n,o,i){this.singleDistExplorer.loadAreaNode(e,n,o,i)}isExcludedAdcode(e){const n=this._opts.excludedAdcodes;return n&&n.indexOf(e)>=0}traverseTopNodes(e,n,o,i,a){const r=this._opts.topAdcodes,s=this._opts.excludedAdcodes,l={total:r.length,count:0};for(let u=0,p=r.length;u<p;u++){const d=this.getNodeByAdcode(r[u]);if(!d)throw new Error(`Can not find adcode: ${r[u]}`);this.traverseNode(d,e,n,o,i,a,s,l)}}tryClearCache(e,n){if(!(n<0)){const o=[this.singleCountryNode],i=[],a=this._touchMap;do{const s=o.pop();s.children&&H.mergeArray(o,s.children);const l=a[s.adcode];l&&l!==e&&i.push(s.adcode)}while(o.length);i.sort(function(s,l){const u=a[s]-a[l];return u===0?s-l:u});const r=i.length-n;if(!(r<=0))for(let s=0;s<r;s++)this.singleDistExplorer.clearAreaNodeCacheByAdcode(i[s])&&this.touchAdcode(i[s],null)}}touchAdcode(e,n){this._touchMap[e]=n}destroy(){this.singleDistExplorer.destroy(),this._touchMap={},this.nodeMap={},this.singleDistExplorer=void 0,this._opts=void 0,this.waitFnList=[],this.singleCountryNode=void 0}};function Op(t){return[t.x,t.y]}let kp=class{constructor(e){this._data=[],this._pointsMap={},this._opts=H.extend({topAdcode:1e5},e),this.clearData()}clearData(){this._data=[],this._pointsMap={}}setData(e){this.clearData(),this._data=e,this._updatePointsMap(this._opts.topAdcode,"all",e)}_updatePointsMap(e,n,o){let i=this._pointsMap[e];i||(i=this._pointsMap[e]={}),i[n]=o,i[`${n}_pack`]=this._buildPackItemsByAdcode(e,o)}getPointsByAdcode(e,n){return this._pointsMap[e]?this._pointsMap[e][n||"all"]:[]}getPackItemsByAdcode(e,n){return this._pointsMap[e]?this._pointsMap[e][`${n||"all"}_pack`]:[]}_buildPackItemsByAdcode(e,n){const o=this._opts.pointPacker,i=[];for(let a=0,r=n.length;a<r;a++)i[a]=o.call(this._opts.pointPackerThisArg,n[a]);return i}calcDistGroup(e,n,o,i){const a=this._opts.distMgr.getNodeByAdcode(e);let r=a.acroutes||[1e5];n&&a.acroutes&&(r=[].concat(r),r.push(e)),this._calcGroupWithRoutes(r,0,o,i)}_calcGroupWithRoutes(e,n,o,i){const a=()=>{n<e.length-1?this._calcGroupWithRoutes(e,n+1,o,i):o&&o.call(i)},r=e[n];if(this.getPointsByAdcode(r,"__done"))a.call(this);else{const s=this.getPointsByAdcode(r);if(!s)throw new Error(`Not points found:  ${r}`);this._opts.distMgr.getExplorer().loadAreaNode(r,(l,u)=>{this._groupByAreaNode(u,s),a.call(this)},this,!0)}}_groupByAreaNode(e,n){const o=e.groupByPosition(n,Op),i=e.getAdcode()===this._opts.topAdcode,a=[];for(let r=0,s=o.length;r<s;r++){const l=o[r];l.subFeature?(this._updatePointsMap(l.subFeature.properties.adcode,"all",l.points),i&&H.mergeArray(a,l.points)):this._updatePointsMap(e.getAdcode(),"hanging",l.points)}i&&this._updatePointsMap(e.getAdcode(),"all",a),this._updatePointsMap(e.getAdcode(),"__done",!0)}destroy(){this.clearData(),this._opts=null}};var Lp=Object.defineProperty,$p=Object.defineProperties,Ip=Object.getOwnPropertyDescriptors,Ma=Object.getOwnPropertySymbols,Pp=Object.prototype.hasOwnProperty,Tp=Object.prototype.propertyIsEnumerable,Aa=(t,e,n)=>e in t?Lp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,xa=(t,e)=>{for(var n in e||(e={}))Pp.call(e,n)&&Aa(t,n,e[n]);if(Ma)for(var n of Ma(e))Tp.call(e,n)&&Aa(t,n,e[n]);return t},Rp=(t,e)=>$p(t,Ip(e));let Bp=class extends qn{constructor(e,n){super(),this.baseId=1,this._currentZoom=2,this._currentFeatures=[],this._loadLeft=0,this._polygonCache=[],this._markerCache=[],this._opts=H.extend({engine:"default",areaNodeCacheLimit:-1,minHeightToShowSubFeatures:630,minSiblingAvgHeightToShowSubFeatures:600,minSubAvgHeightToShowSubFeatures:300,zooms:[2,30],clusterMarkerEventSupport:!0,clusterMarkerClickToShowSub:!0,featureEventSupport:!0,featureClickToShowSub:!1,featureStyleByLevel:{country:{strokeColor:"rgb(31, 119, 180)",strokeOpacity:.9,strokeWeight:2,fillColor:"rgb(49, 163, 84)",fillOpacity:.8},province:{strokeColor:"rgb(31, 119, 180)",strokeOpacity:.9,strokeWeight:2,fillColor:"rgb(116, 196, 118)",fillOpacity:.7},city:{strokeColor:"rgb(31, 119, 180)",strokeOpacity:.9,strokeWeight:2,fillColor:"rgb(161, 217, 155)",fillOpacity:.6},district:{strokeColor:"rgb(31, 119, 180)",strokeOpacity:.9,strokeWeight:2,fillColor:"rgb(199, 233, 192)",fillOpacity:.5}}},n),this._map=this._opts.map,this._createLayer(),this._ins=e,this._isRendering=!1,this._loadLeft=0,this._currentFeatures=[]}_createLayer(){this.markerGroup=new AMap.OverlayGroup,this._map.add(this.markerGroup),this.layer=new AMap.VectorLayer({zIndex:this._opts.zIndex||10,visible:this._opts.visible||!0}),this._map.addLayer(this.layer)}zoomToShowSubFeatures(e,n){const o=this.getMinZoomToShowSub(e);if(o>=3){const i=this._ins.getMap();i&&(n||(n=this._ins._distMgr.getNodeByAdcode(e).center),i.setZoomAndCenter(o,n))}}getPixelRatio(){return Math.min(2,Math.round(window.devicePixelRatio||1))}refreshViewState(){if(!this._ins._distMgr.isReady())return!1;const e=this._ins;if(!e.isReady())return!1;const n=e.getMap(),o=n.getBounds(),i=n.getSize(),a=n.getZoom(3),r=this._opts.zooms[1],s=Math.pow(2,r-a),l=o.getNorthWest(),u=n.lngLatToCoords([l.getLng(),l.getLat()]),p=new It(u[0],u[1],i.width*s,i.height*s);this._currentZoom=a,this._currentScaleFactor=s,this._currentViewBounds=p,this._currentViewBoundsInLngLat=o,this._currentPixelRatio=this.getPixelRatio()}renderViewport(){if(this.refreshViewState(),!this._currentViewBounds)return!1;this._currentRenderId=this.baseId++,this._loadLeft=0,this._currentFeatures=[],this._renderViewDist(this._currentRenderId),this._isRendering=!1}getCurrentRenderId(){return this._currentRenderId}isRenderIdStillValid(e){return e===this._currentRenderId}_renderViewDist(e){const n=[];if(this._currentZoom<this._opts.zooms[0]||this._currentZoom>this._opts.zooms[1]){this.isRenderIdStillValid(e)&&this._prepareFeatures(e,n);return}this._ins.getDistMgr().traverseTopNodes(this._currentViewBoundsInLngLat,this._currentZoom,o=>{n.push(o.adcode)},()=>{this.isRenderIdStillValid(e)&&this._prepareFeatures(e,n)},this)}getMinZoomToShowSub(e){const n=this._ins._distMgr.getNodeByAdcode(e);if(!n||!n.idealZoom)return-1;if(!n._minZoomToShowSub){const o=this._ins.getZooms();for(let i=o[0];i<=o[1];i++)if(this.shouldShowSubOnZoom(n,i)){n._minZoomToShowSub=i;break}}return n._minZoomToShowSub||-1}shouldShowSubOnZoom(e,n){if(!e.idealZoom)return!1;if(e._minZoomToShowSub&&n>=e._minZoomToShowSub)return!0;let o=this._ins._distMgr.getNodeBoundsSize(e,n);if(e.adcode===1e5&&o[1]>400)return!0;if(o[1]<this._opts.minHeightToShowSubFeatures)return!1;let i,a,r;if(e.children){const l=e.children;if(r=0,a=l.length,a){for(i=0;i<a;i++)o=this._ins._distMgr.getNodeBoundsSize(l[i],n),r+=o[1];if(r/a<this._opts.minSubAvgHeightToShowSubFeatures)return!1}}const s=this._ins._distMgr.getParentAdcode(e.adcode,e.acroutes);if(s){const l=this._ins._distMgr.getNodeByAdcode(s),u=l.children;if(u||console.error("No children bound",e,l),a=u.length,a>1){for(r=0,i=0;i<a;i++)u[i].adcode!==e.adcode&&(o=this._ins._distMgr.getNodeBoundsSize(u[i],n),r+=o[1]);if(r/(a-1)<this._opts.minSiblingAvgHeightToShowSubFeatures)return!1}}return!0}_shouldShowSub(e){return!(!e.children||!e.children.length)&&this.shouldShowSubOnZoom(e,this._currentZoom)}_prepareFeatures(e,n){const o=[],i=[];for(let a=0,r=n.length;a<r;a++){const s=this._ins._distMgr.getNodeByAdcode(n[a]);if(!s)throw new Error(`Can not find node: ${n[a]}`);this._shouldShowSub(s)?i.push(n[a]):o.push(n[a])}this._prepareSelfFeatures(e,o),this._prepareSubFeatures(e,i),this._checkLoadFinish(e)}_prepareSelfFeatures(e,n){let o;const i=this._currentZoom;for(let a=0,r=n.length;a<r;a++){const s=this._ins._distMgr.getNodeByAdcode(n[a]);if(o=null,s.acroutes){const l=this._ins._distMgr.getNodeByAdcode(s.acroutes[s.acroutes.length-1]);(!s.idealZoom||i<s.idealZoom-1||Math.abs(i-l.idealZoom)<=Math.abs(s.idealZoom-i))&&(o=l.adcode)}this._loadAndRenderSelf(e,o||n[a],n[a])}}_prepareSubFeatures(e,n){let o,i;for(o=0,i=n.length;o<i;o++)this._loadAndRenderSub(e,n[o])}_renderSelf(e,n,o){let i;if(n===o.getAdcode())i=o.getParentFeature();else{const a=o.getSubFeatures(),r=this._ins._distMgr.getSubIdx(n);if(i=a[r],!i){console.warn("Werid, can not find sub feature",o.getAdcode(),n);return}if(i.properties.adcode!==n){console.warn("Sub adcode not match!!",a,r);return}}this._ins.getDistCounter().calcDistGroup(n,!1,()=>{this.isRenderIdStillValid(e)&&this._prepRenderFeatureInPixel(e,i)},this)}_checkLoadFinish(e){if(this._loadLeft===0){const n=this;setTimeout(function(){n.isRenderIdStillValid(e)&&n._handleRenderFinish()},0)}}_renderSub(e,n){const o=n.getSubFeatures();this._ins.getDistCounter().calcDistGroup(n.getAdcode(),!0,()=>{if(this.isRenderIdStillValid(e))for(let i=0,a=o.length;i<a;i++)this._prepRenderFeatureInPixel(e,o[i])},this)}_handleRenderFinish(){this._tryFreeMemery(),this._renderAllFeature()}_renderAllFeature(){this._renderAllFeatureByDefault()}_renderAllFeatureByDefault(){var e,n;const o=[],i=[],a=[],r=[];for(let s=0;s<this._polygonCache.length;s++){const l=this._polygonCache[s],u=l.getExtData()._data.adcode;let p=!1;for(let d=0;d<this._currentFeatures.length;d++){const c=this._currentFeatures[d].feature.properties;if(u===c.adcode){p=!0,this._currentFeatures.splice(d,1);break}}p||(i.push(l),this._polygonCache.splice(s,1),r.push(this._markerCache[s]),this._markerCache.splice(s,1),s--)}this._currentFeatures.forEach(s=>{const l=this._createPolygonFeature(s.feature,s.dataItems);this._opts.featureEventSupport&&(l.on("click",H.bind(p=>{this.emit("featureClick",p,s.feature),this._opts.featureClickToShowSub&&this._ins.zoomToShowSubFeatures(s.feature.properties.adcode)},this)),l.on("mouseover",H.bind(p=>{this.emit("featureMouseover",p,s.feature)},this)),l.on("mouseout",H.bind(p=>{this.emit("featureMouseout",p,s.feature)},this)));const u=this._createClusterMarker(s.feature,s.dataItems);this._opts.clusterMarkerEventSupport&&u.on("click",H.bind(p=>{this.emit("clusterMarkerClick",p,xa({adcode:s.feature.properties.adcode},s)),this._opts.clusterMarkerClickToShowSub&&this._ins.zoomToShowSubFeatures(s.feature.properties.adcode)},this)),o.push(l),a.push(u)}),this.layer.remove(i),(e=this.markerGroup)===null||e===void 0||e.removeOverlays(r),this.layer.add(o),this._polygonCache.push(...o),o.length=0,(n=this.markerGroup)===null||n===void 0||n.addOverlays(a),this._markerCache.push(...a),a.length=0}_tryFreeMemery(){this._ins.getDistMgr().tryClearCache(this._currentRenderId,this._opts.areaNodeCacheLimit)}_increaseLoadLeft(){this._loadLeft++}_decreaseLoadLeft(e){this._loadLeft--,this._loadLeft===0&&this._checkLoadFinish(e)}_loadAndRenderSelf(e,n,o){this._ins.getDistMgr().touchAdcode(n,e);const i=this._ins._distMgr.getExplorer(),a=i.getLocalAreaNode(n);a?this._renderSelf(e,o,a):(this._increaseLoadLeft(),i.loadAreaNode(n,(r,s)=>{this.isRenderIdStillValid(e)&&(r?console.error(r):this._renderSelf(e,o,s),this._decreaseLoadLeft(e))},this))}_loadAndRenderSub(e,n){this._ins.getDistMgr().touchAdcode(n,e);const o=this._ins._distMgr.getExplorer(),i=o.getLocalAreaNode(n);i?this._renderSub(e,i):(this._increaseLoadLeft(),o.loadAreaNode(n,(a,r)=>{this.isRenderIdStillValid(e)&&(a?console.error(a):this._renderSub(e,r),this._decreaseLoadLeft(e))},this))}_prepRenderFeatureInPixel(e,n){if(!this._ins.getDistMgr().isExcludedAdcode(n.properties.adcode)){const o=this._ins.getDistCounter().getPackItemsByAdcode(n.properties.adcode);this._currentFeatures.push({feature:n,dataItems:o})}}_createPolygonFeature(e,n){const o=Object.assign({},e.properties);if(o.dataItems=n,this._opts.renderPolygon){const a=this._opts.renderPolygon(e,n),r=a.getExtData()||{};return r._data=o,a.setExtData(r),a}const i=this._getFeatureStyleOptions(e,n)||{};return new AMap.Polygon(Rp(xa({path:e.geometry.coordinates},i),{extData:{_data:o}}))}_createClusterMarker(e,n){const o=e.properties;if(o.dataItems=n,this._opts.renderClusterMarker){const p=this._opts.renderClusterMarker(e,n),d=p.getExtData()||{};return d._data=o,p.setExtData(d),p}const i={title:"amap-ui-district-cluster-marker-title",body:"amap-ui-district-cluster-marker-body",container:"amap-ui-district-cluster-marker"},a=document.createElement("div"),r=document.createElement("span");r.className=i.title;const s=document.createElement("span");s.className=i.body,a.appendChild(r),a.appendChild(s);const l=[],u=[i.container,`level_${o.level}`,`adcode_${o.adcode}`];if(o.acroutes)for(let p=o.acroutes,d=0,c=p.length;d<c;d++)u.push(`descendant_of_${p[d]}`),d===c-1&&u.push(`child_of_${p[d]}`),d>0&&l.push(this._ins._distMgr.getNodeByAdcode(p[d]).name);return a.className=u.join(" "),l.length>0?(l.push(o.name),a.setAttribute("title",l.join(">"))):a.removeAttribute("title"),r.innerHTML=H.escapeHtml(o.name),s.innerHTML=n.length,new AMap.Marker({topWhenClick:!0,offset:new AMap.Pixel(-20,-30),content:a,position:o.center,extData:{_data:o}})}_getFeatureStyleOptions(e,n){const o=this._opts.getFeatureStyle,i=this._opts.featureStyleByLevel[e.properties.level];if(!o)return i;const a=o.call(null,e,n);return a?H.extend({},this._opts.featureStyleByLevel[e.properties.level],a):i}renderLater(e){this._renderLaterId||(this._renderLaterId=setTimeout(()=>{this.render()},e||100))}isRendering(){return this._isRendering}render(){this._renderLaterId&&(clearTimeout(this._renderLaterId),this._renderLaterId=null),this._isRendering=!0,this._ins._distMgr.onReady(this.renderViewport,this,!0)}forceRender(){this._renderLaterId&&(clearTimeout(this._renderLaterId),this._renderLaterId=null),this._isRendering=!0,this.clear(),this._ins._distMgr.onReady(this.renderViewport,this,!0)}getOption(e){return this._opts[e]}getOptions(){return this._opts}show(){var e;this.layer.show(),(e=this.markerGroup)===null||e===void 0||e.show()}hide(){var e;this.layer.hide(),(e=this.markerGroup)===null||e===void 0||e.hide()}clear(){var e;this.layer.clear(),(e=this.markerGroup)===null||e===void 0||e.clearOverlays(),this._polygonCache=[],this._markerCache=[]}setzIndex(e){this.layer.setzIndex(e)}getZooms(){return this._opts.zooms}destroy(){this._map.removeLayer(this.layer),this._map.remove(this.markerGroup),this._currentFeatures=[],this.clear(),this.layer=null,this._map=null,this._ins=null}},Np=class{constructor(e,n,o){this.x=e,this.y=n,this.idx=o}};var Fp=Object.defineProperty,Dp=Object.defineProperties,jp=Object.getOwnPropertyDescriptors,Ea=Object.getOwnPropertySymbols,zp=Object.prototype.hasOwnProperty,Wp=Object.prototype.propertyIsEnumerable,Ca=(t,e,n)=>e in t?Fp(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,qp=(t,e)=>{for(var n in e||(e={}))zp.call(e,n)&&Ca(t,n,e[n]);if(Ea)for(var n of Ea(e))Wp.call(e,n)&&Ca(t,n,e[n]);return t},Up=(t,e)=>Dp(t,jp(e));let Zp=class extends qn{constructor(e){super(),this._data={list:[],bounds:null,source:null},this._mouseEvent=H.bind(H.debounce(()=>{this.renderLater()},50),this),this.initCSS();const n={autoSetFitView:!0,topAdcodes:[1e5],visible:!0,excludedAdcodes:null,zIndex:10,renderOptions:{}};this._opts=H.extend({},n,e),this.map=e.map,this._distMgr=new Sp({topAdcodes:this._opts.topAdcodes,excludedAdcodes:this._opts.excludedAdcodes}),this._distCounter=new kp({distMgr:this._distMgr,pointPackerThisArg:this,pointPacker:o=>this._packDataItem(o)}),this.renderEngine=new Bp(this,Up(qp({},e.renderOptions),{zIndex:this._opts.zIndex,visible:this._opts.visible,map:e.map})),this.renderEngine.on("*",(o,...i)=>{this.emit(o,...i)}),this._opts.data&&this.setData(this._opts.data),this.bindOrUnbindMapEvent()}bindOrUnbindMapEvent(e=!0){const n=e?"on":"off";this.map[n]("moveend",this._mouseEvent),this.map[n]("zoomend",this._mouseEvent),this.map[n]("resize",this._mouseEvent),this.map[n]("rotateend",this._mouseEvent),this.map[n]("dragend",this._mouseEvent)}initCSS(){const e="_amap_district_cluster_css";if(document.getElementById(e))return;const n=".amap-ui-district-cluster-container{cursor:default;-webkit-backface-visibility:hidden;-webkit-transform:translateZ(0) scale(1,1)}.amap-ui-district-cluster-container canvas{position:absolute}.amap-ui-district-cluster-container .amap-ui-hide{display:none!important}.amap-ui-district-cluster-container .overlay-title,.amap-ui-district-cluster-marker{color:#555;background-color:#fffeef;font-size:12px;white-space:nowrap;position:absolute}.amap-ui-district-cluster-container .overlay-title{padding:2px 6px;display:inline-block;z-index:99999;border:1px solid #7e7e7e;border-radius:2px}.amap-ui-district-cluster-container .overlay-title:after,.amap-ui-district-cluster-container .overlay-title:before{content:'';display:block;position:absolute;margin:auto;width:0;height:0;border:solid transparent;border-width:5px}.amap-ui-district-cluster-container .overlay-title.left{transform:translate(10px,-50%)}.amap-ui-district-cluster-container .overlay-title.left:before{top:5px}.amap-ui-district-cluster-container .overlay-title.left:after{left:-9px;top:5px;border-right-color:#fffeef}.amap-ui-district-cluster-container .overlay-title.left:before{left:-10px;border-right-color:#7e7e7e}.amap-ui-district-cluster-container .overlay-title.top{transform:translate(-50%,-130%)}.amap-ui-district-cluster-container .overlay-title.top:before{left:0;right:0}.amap-ui-district-cluster-container .overlay-title.top:after{bottom:-9px;left:0;right:0;border-top-color:#fffeef}.amap-ui-district-cluster-container .overlay-title.top:before{bottom:-10px;border-top-color:#7e7e7e}.amap-ui-district-cluster-marker{border:1px solid #8e8e8e;width:auto;height:22px;border-radius:5px 5px 5px 0;left:0;top:0}.amap-ui-district-cluster-marker:after,.amap-ui-district-cluster-marker:before{content:'';display:block;position:absolute;width:0;height:0;border:solid rgba(0,0,0,0);border-width:6px;left:13px}.amap-ui-district-cluster-marker:after{bottom:-12px;border-top-color:#fffeef}.amap-ui-district-cluster-marker:before{bottom:-13px;border-top-color:#8e8e8e}.amap-ui-district-cluster-marker span{vertical-align:middle;padding:3px 5px;display:inline-block;height:16px;line-height:16px}.amap-ui-district-cluster-marker-title{border-radius:5px 0 0 0}.amap-ui-district-cluster-marker-body{background-color:#dc3912;color:#fff;border-radius:0 5px 5px 0}.amap-ui-district-cluster-marker.level_country .amap-ui-district-cluster-marker-body{background-color:#36c}.amap-ui-district-cluster-marker.level_province .amap-ui-district-cluster-marker-body{background-color:#dc3912}.amap-ui-district-cluster-marker.level_city .amap-ui-district-cluster-marker-body{background-color:#909}.amap-ui-district-cluster-marker.level_district .amap-ui-district-cluster-marker-body{background-color:#d47}",o=document,i="appendChild",a="styleSheet",r=o.createElement("style");r.id=e,r.type="text/css",o.getElementsByTagName("head")[0][i](r),r[a]?r[a].cssText=n:r[i](o.createTextNode(n))}getMinZoomToShowSub(e){return this.renderEngine.getMinZoomToShowSub(e)}getAreaNodeProps(e){return this._distMgr.getNodeByAdcode(e)}getDistrictExplorer(){return this._distMgr.getExplorer()}getRender(){return this.renderEngine}zoomToShowSubFeatures(e,n){this.renderEngine.zoomToShowSubFeatures(e,n)}renderLater(e){this.renderEngine.renderLater(e)}render(){this.renderEngine.render()}forceRender(){this.renderEngine.forceRender()}getDistMgr(){return this._distMgr}_clearData(){this.trigger("willClearData"),this._data?this._data.list.length=0:this._data={list:[],bounds:null},this._data.source=null,this._data.bounds=null,this._data.kdTree=null,this._distCounter.clearData(),this.trigger("didClearData")}_buildDataItems(e){const n=this._opts,o=n.getPosition,i=this._data.list,a=this._data.bounds;for(let r=0,s=e.length;r<s;r++){let l=e[r],u=o.call(this,l,r);u&&(u.getLng&&(u=[u.getLng(),u.getLat()]),i[r]=new Np(u[0],u[1],r),a.expandByPoint(u[0],u[1]))}}getDataItemsByBounds(e){const n=this._data.kdTree;if(!n)return null;const o=e.getSouthWest(),i=e.getNorthEast(),a=this._data.list,r=n.range(o.getLng(),o.getLat(),i.getLng(),i.getLat()),s=[];for(let l=0,u=r.length;l<u;l++)s[l]=this._packDataItem(a[r[l]]);return s}_packDataItem(e){if(!e)return null;if(!e._packedItem){const n=e.idx,o=[e.x,e.y];e._packedItem={dataIndex:n,dataItem:this._data.source[n],position:o}}return e._packedItem}_buildData(e){this._clearData(),this.trigger("willBuildData",e),this._data.source=e,this._data.bounds=It.getBoundsItemToExpand(),this._buildDataItems(e),this._distCounter.setData(this._data.list),this.trigger("didBuildData",e)}setData(e){e||(e=[]),this._buildData(e),this.forceRender(),e.length&&this._opts.autoSetFitView&&this.setFitView()}isReady(){return this._distMgr.isReady()&&!!this._data}setFitView(){const e=this._data.bounds,n=this.getMap(),o=new AMap.Bounds([e.x,e.y],[e.x+e.width,e.y+e.height]);n&&n.setBounds(o)}getDistCounter(){return this._distCounter}getMap(){return this._opts.map}getZooms(){return this.renderEngine.getZooms()}isHidden(){return!this._opts.visible}show(){return this._opts.visible=!0,this.getRender().show()}hide(){return this._opts.visible=!1,this.getRender().hide()}destroy(){this.bindOrUnbindMapEvent(!1),this.getRender().destroy(),this._distCounter.destroy(),this._distMgr.destroy(),this.renderEngine=null,this._data={list:[],bounds:null},this._distMgr=null,this.map=void 0,this._opts=void 0}getzIndex(){return this._opts.zIndex}setzIndex(e){this._opts.zIndex=e,this.getRender().setzIndex(e)}};var Ne=y.defineComponent({name:"ElAmapLayerDistrictCluster",inheritAttrs:!1,__name:"DistrictCluster",props:R({data:{required:!0,type:Array},getPosition:{type:Function},autoSetFitView:{type:Boolean,default:!0},topAdcodes:{type:Array},excludedAdcodes:{type:Array},renderOptions:{type:Object}}),emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a}=B((r,s)=>new Promise(l=>{r.map=s,i=new Zp(r),l(i)}),{emits:o,destroyComponent(){i&&(i.destroy(),i=null)}});return e({$$getInstance:a}),(r,s)=>(y.openBlock(),y.createElementBlock("div"))}});Ne.__file="src/vue-amap/packages/layer/data/DistrictCluster/DistrictCluster.vue",Ne.install=t=>(t.component(Ne.name,Ne),t);const wa=Ne;var ln={exports:{}};ln.exports=un,ln.exports.default=un;function un(t,e,n){n=n||2;var o=e&&e.length,i=o?e[0]*n:t.length,a=Sa(t,0,i,n,!0),r=[];if(!a||a.next===a.prev)return r;var s,l,u,p,d,c,f;if(o&&(a=Xp(t,e,a,n)),t.length>80*n){s=u=t[0],l=p=t[1];for(var m=n;m<i;m+=n)d=t[m],c=t[m+1],d<s&&(s=d),c<l&&(l=c),d>u&&(u=d),c>p&&(p=c);f=Math.max(u-s,p-l),f=f!==0?32767/f:0}return Fe(a,r,n,s,l,f,0),r}function Sa(t,e,n,o,i){var a,r;if(i===lo(t,e,n,o)>0)for(a=e;a<n;a+=o)r=La(a,t[a],t[a+1],r);else for(a=n-o;a>=e;a-=o)r=La(a,t[a],t[a+1],r);return r&&cn(r,r.next)&&(je(r),r=r.next),r}function At(t,e){if(!t)return t;e||(e=t);var n=t,o;do if(o=!1,!n.steiner&&(cn(n,n.next)||G(n.prev,n,n.next)===0)){if(je(n),n=e=n.prev,n===n.next)break;o=!0}else n=n.next;while(o||n!==e);return e}function Fe(t,e,n,o,i,a,r){if(t){!r&&a&&eh(t,o,i,a);for(var s=t,l,u;t.prev!==t.next;){if(l=t.prev,u=t.next,a?Yp(t,o,i,a):Gp(t)){e.push(l.i/n|0),e.push(t.i/n|0),e.push(u.i/n|0),je(t),t=u.next,s=u.next;continue}if(t=u,t===s){r?r===1?(t=Vp(At(t),e,n),Fe(t,e,n,o,i,a,2)):r===2&&Hp(t,e,n,o,i,a):Fe(At(t),e,n,o,i,a,1);break}}}}function Gp(t){var e=t.prev,n=t,o=t.next;if(G(e,n,o)>=0)return!1;for(var i=e.x,a=n.x,r=o.x,s=e.y,l=n.y,u=o.y,p=i<a?i<r?i:r:a<r?a:r,d=s<l?s<u?s:u:l<u?l:u,c=i>a?i>r?i:r:a>r?a:r,f=s>l?s>u?s:u:l>u?l:u,m=o.next;m!==e;){if(m.x>=p&&m.x<=c&&m.y>=d&&m.y<=f&&Tt(i,s,a,l,r,u,m.x,m.y)&&G(m.prev,m,m.next)>=0)return!1;m=m.next}return!0}function Yp(t,e,n,o){var i=t.prev,a=t,r=t.next;if(G(i,a,r)>=0)return!1;for(var s=i.x,l=a.x,u=r.x,p=i.y,d=a.y,c=r.y,f=s<l?s<u?s:u:l<u?l:u,m=p<d?p<c?p:c:d<c?d:c,v=s>l?s>u?s:u:l>u?l:u,h=p>d?p>c?p:c:d>c?d:c,g=ro(f,m,e,n,o),A=ro(v,h,e,n,o),b=t.prevZ,M=t.nextZ;b&&b.z>=g&&M&&M.z<=A;){if(b.x>=f&&b.x<=v&&b.y>=m&&b.y<=h&&b!==i&&b!==r&&Tt(s,p,l,d,u,c,b.x,b.y)&&G(b.prev,b,b.next)>=0||(b=b.prevZ,M.x>=f&&M.x<=v&&M.y>=m&&M.y<=h&&M!==i&&M!==r&&Tt(s,p,l,d,u,c,M.x,M.y)&&G(M.prev,M,M.next)>=0))return!1;M=M.nextZ}for(;b&&b.z>=g;){if(b.x>=f&&b.x<=v&&b.y>=m&&b.y<=h&&b!==i&&b!==r&&Tt(s,p,l,d,u,c,b.x,b.y)&&G(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;M&&M.z<=A;){if(M.x>=f&&M.x<=v&&M.y>=m&&M.y<=h&&M!==i&&M!==r&&Tt(s,p,l,d,u,c,M.x,M.y)&&G(M.prev,M,M.next)>=0)return!1;M=M.nextZ}return!0}function Vp(t,e,n){var o=t;do{var i=o.prev,a=o.next.next;!cn(i,a)&&Oa(i,o,o.next,a)&&De(i,a)&&De(a,i)&&(e.push(i.i/n|0),e.push(o.i/n|0),e.push(a.i/n|0),je(o),je(o.next),o=t=a),o=o.next}while(o!==t);return At(o)}function Hp(t,e,n,o,i,a){var r=t;do{for(var s=r.next.next;s!==r.prev;){if(r.i!==s.i&&ih(r,s)){var l=ka(r,s);r=At(r,r.next),l=At(l,l.next),Fe(r,e,n,o,i,a,0),Fe(l,e,n,o,i,a,0);return}s=s.next}r=r.next}while(r!==t)}function Xp(t,e,n,o){var i=[],a,r,s,l,u;for(a=0,r=e.length;a<r;a++)s=e[a]*o,l=a<r-1?e[a+1]*o:t.length,u=Sa(t,s,l,o,!1),u===u.next&&(u.steiner=!0),i.push(oh(u));for(i.sort(Kp),a=0;a<i.length;a++)n=Jp(i[a],n);return n}function Kp(t,e){return t.x-e.x}function Jp(t,e){var n=Qp(t,e);if(!n)return e;var o=ka(n,t);return At(o,o.next),At(n,n.next)}function Qp(t,e){var n=e,o=t.x,i=t.y,a=-1/0,r;do{if(i<=n.y&&i>=n.next.y&&n.next.y!==n.y){var s=n.x+(i-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(s<=o&&s>a&&(a=s,r=n.x<n.next.x?n:n.next,s===o))return r}n=n.next}while(n!==e);if(!r)return null;var l=r,u=r.x,p=r.y,d=1/0,c;n=r;do o>=n.x&&n.x>=u&&o!==n.x&&Tt(i<p?o:a,i,u,p,i<p?a:o,i,n.x,n.y)&&(c=Math.abs(i-n.y)/(o-n.x),De(n,t)&&(c<d||c===d&&(n.x>r.x||n.x===r.x&&th(r,n)))&&(r=n,d=c)),n=n.next;while(n!==l);return r}function th(t,e){return G(t.prev,t,e.prev)<0&&G(e.next,t,t.next)<0}function eh(t,e,n,o){var i=t;do i.z===0&&(i.z=ro(i.x,i.y,e,n,o)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,nh(i)}function nh(t){var e,n,o,i,a,r,s,l,u=1;do{for(n=t,t=null,a=null,r=0;n;){for(r++,o=n,s=0,e=0;e<u&&(s++,o=o.nextZ,!!o);e++);for(l=u;s>0||l>0&&o;)s!==0&&(l===0||!o||n.z<=o.z)?(i=n,n=n.nextZ,s--):(i=o,o=o.nextZ,l--),a?a.nextZ=i:t=i,i.prevZ=a,a=i;n=o}a.nextZ=null,u*=2}while(r>1);return t}function ro(t,e,n,o,i){return t=(t-n)*i|0,e=(e-o)*i|0,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t|e<<1}function oh(t){var e=t,n=t;do(e.x<n.x||e.x===n.x&&e.y<n.y)&&(n=e),e=e.next;while(e!==t);return n}function Tt(t,e,n,o,i,a,r,s){return(i-r)*(e-s)>=(t-r)*(a-s)&&(t-r)*(o-s)>=(n-r)*(e-s)&&(n-r)*(a-s)>=(i-r)*(o-s)}function ih(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!ah(t,e)&&(De(t,e)&&De(e,t)&&rh(t,e)&&(G(t.prev,t,e.prev)||G(t,e.prev,e))||cn(t,e)&&G(t.prev,t,t.next)>0&&G(e.prev,e,e.next)>0)}function G(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function cn(t,e){return t.x===e.x&&t.y===e.y}function Oa(t,e,n,o){var i=hn(G(t,e,n)),a=hn(G(t,e,o)),r=hn(G(n,o,t)),s=hn(G(n,o,e));return!!(i!==a&&r!==s||i===0&&pn(t,n,e)||a===0&&pn(t,o,e)||r===0&&pn(n,t,o)||s===0&&pn(n,e,o))}function pn(t,e,n){return e.x<=Math.max(t.x,n.x)&&e.x>=Math.min(t.x,n.x)&&e.y<=Math.max(t.y,n.y)&&e.y>=Math.min(t.y,n.y)}function hn(t){return t>0?1:t<0?-1:0}function ah(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Oa(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function De(t,e){return G(t.prev,t,t.next)<0?G(t,e,t.next)>=0&&G(t,t.prev,e)>=0:G(t,e,t.prev)<0||G(t,t.next,e)<0}function rh(t,e){var n=t,o=!1,i=(t.x+e.x)/2,a=(t.y+e.y)/2;do n.y>a!=n.next.y>a&&n.next.y!==n.y&&i<(n.next.x-n.x)*(a-n.y)/(n.next.y-n.y)+n.x&&(o=!o),n=n.next;while(n!==t);return o}function ka(t,e){var n=new so(t.i,t.x,t.y),o=new so(e.i,e.x,e.y),i=t.next,a=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,o.next=n,n.prev=o,a.next=o,o.prev=a,o}function La(t,e,n,o){var i=new so(t,e,n);return o?(i.next=o.next,i.prev=o,o.next.prev=i,o.next=i):(i.prev=i,i.next=i),i}function je(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function so(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}un.deviation=function(t,e,n,o){var i=e&&e.length,a=i?e[0]*n:t.length,r=Math.abs(lo(t,0,a,n));if(i)for(var s=0,l=e.length;s<l;s++){var u=e[s]*n,p=s<l-1?e[s+1]*n:t.length;r-=Math.abs(lo(t,u,p,n))}var d=0;for(s=0;s<o.length;s+=3){var c=o[s]*n,f=o[s+1]*n,m=o[s+2]*n;d+=Math.abs((t[c]-t[m])*(t[f+1]-t[c+1])-(t[c]-t[f])*(t[m+1]-t[c+1]))}return r===0&&d===0?0:Math.abs((d-r)/r)};function lo(t,e,n,o){for(var i=0,a=e,r=n-o;a<n;a+=o)i+=(t[r]-t[a])*(t[a+1]+t[r+1]),r=a;return i}un.flatten=function(t){for(var e=t[0][0].length,n={vertices:[],holes:[],dimensions:e},o=0,i=0;i<t.length;i++){for(var a=0;a<t[i].length;a++)for(var r=0;r<e;r++)n.vertices.push(t[i][a][r]);i>0&&(o+=t[i-1].length,n.holes.push(o))}return n};const lt={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0};function sh(t,{precision:e=lt.precision}={}){return t=lh(t),"".concat(parseFloat(t.toPrecision(e)))}function uo(t){return Array.isArray(t)||ArrayBuffer.isView(t)&&!(t instanceof DataView)}function $a(t,e,n){const o=lt.EPSILON;n&&(lt.EPSILON=n);try{if(t===e)return!0;if(uo(t)&&uo(e)){if(t.length!==e.length)return!1;for(let i=0;i<t.length;++i)if(!$a(t[i],e[i]))return!1;return!0}return t&&t.equals?t.equals(e):e&&e.equals?e.equals(t):typeof t=="number"&&typeof e=="number"?Math.abs(t-e)<=lt.EPSILON*Math.max(1,Math.abs(t),Math.abs(e)):!1}finally{lt.EPSILON=o}}function lh(t){return Math.round(t/lt.EPSILON)*lt.EPSILON}function uh(t){function e(){var n=Reflect.construct(t,Array.from(arguments));return Object.setPrototypeOf(n,Object.getPrototypeOf(this)),n}return e.prototype=Object.create(t.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t,e}class ch extends uh(Array){clone(){return new this.constructor().copy(this)}fromArray(e,n=0){for(let o=0;o<this.ELEMENTS;++o)this[o]=e[o+n];return this.check()}toArray(e=[],n=0){for(let o=0;o<this.ELEMENTS;++o)e[n+o]=this[o];return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:uo(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(lt)}formatString(e){let n="";for(let o=0;o<this.ELEMENTS;++o)n+=(o>0?", ":"")+sh(this[o],e);return"".concat(e.printTypes?this.constructor.name:"","[").concat(n,"]")}equals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(!$a(this[n],e[n]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let n=0;n<this.ELEMENTS;++n)if(this[n]!==e[n])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,n,o){if(o===void 0)return this.lerp(this,e,n);for(let i=0;i<this.ELEMENTS;++i){const a=e[i];this[i]=a+o*(n[i]-a)}return this.check()}min(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.min(e[n],this[n]);return this.check()}max(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=Math.max(e[n],this[n]);return this.check()}clamp(e,n){for(let o=0;o<this.ELEMENTS;++o)this[o]=Math.min(Math.max(this[o],e[o]),n[o]);return this.check()}add(...e){for(const n of e)for(let o=0;o<this.ELEMENTS;++o)this[o]+=n[o];return this.check()}subtract(...e){for(const n of e)for(let o=0;o<this.ELEMENTS;++o)this[o]-=n[o];return this.check()}scale(e){if(typeof e=="number")for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;else for(let n=0;n<this.ELEMENTS&&n<e.length;++n)this[n]*=e[n];return this.check()}multiplyByScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}check(){if(lt.debug&&!this.validate())throw new Error("math.gl: ".concat(this.constructor.name," some fields set to invalid numbers'"));return this}validate(){let e=this.length===this.ELEMENTS;for(let n=0;n<this.ELEMENTS;++n)e=e&&Number.isFinite(this[n]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]=e;return this.check()}addScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let n=0;n<this.ELEMENTS;++n)this[n]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,n){for(let o=0;o<this.ELEMENTS;++o)this[o]=Math.min(Math.max(this[o],e),n);return this.check()}get elements(){return this}}function ph(t,e){if(t.length!==e)return!1;for(let n=0;n<t.length;++n)if(!Number.isFinite(t[n]))return!1;return!0}function hh(t){if(!Number.isFinite(t))throw new Error("Invalid number ".concat(t));return t}function co(t,e,n=""){if(lt.debug&&!ph(t,e))throw new Error("math.gl: ".concat(n," some fields set to invalid numbers'"));return t}var $={},X={};Object.defineProperty(X,"__esModule",{value:!0}),X.setMatrixArrayType=fh,X.toRadian=yh,X.equals=gh,X.RANDOM=X.ARRAY_TYPE=X.EPSILON=void 0;var Ia=1e-6;X.EPSILON=Ia;var Pa=typeof Float32Array!="undefined"?Float32Array:Array;X.ARRAY_TYPE=Pa;var dh=Math.random;X.RANDOM=dh;function fh(t){X.ARRAY_TYPE=Pa=t}var mh=Math.PI/180;function yh(t){return t*mh}function gh(t,e){return Math.abs(t-e)<=Ia*Math.max(1,Math.abs(t),Math.abs(e))}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)});function dn(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?dn=function(e){return typeof e}:dn=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},dn(t)}Object.defineProperty($,"__esModule",{value:!0}),$.create=Ra,$.clone=_h,$.fromValues=Mh,$.copy=Ah,$.set=xh,$.add=Eh,$.subtract=Ba,$.multiply=Na,$.divide=Fa,$.ceil=Ch,$.floor=wh,$.min=Sh,$.max=Oh,$.round=kh,$.scale=Lh,$.scaleAndAdd=$h,$.distance=Da,$.squaredDistance=ja,$.length=za,$.squaredLength=Wa,$.negate=Ih,$.inverse=Ph,$.normalize=Th,$.dot=Rh,$.cross=Bh,$.lerp=Nh,$.random=Fh,$.transformMat2=Dh,$.transformMat2d=jh,$.transformMat3=zh;var vh=$.transformMat4=Wh;$.rotate=qh,$.angle=Uh,$.zero=Zh,$.str=Gh,$.exactEquals=Yh,$.equals=Vh,$.forEach=$.sqrLen=$.sqrDist=$.dist=$.div=$.mul=$.sub=$.len=void 0;var xt=bh(X);function Ta(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Ta=function(o){return o?n:e})(t)}function bh(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||dn(t)!=="object"&&typeof t!="function")return{default:t};var n=Ta(e);if(n&&n.has(t))return n.get(t);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)){var r=i?Object.getOwnPropertyDescriptor(t,a):null;r&&(r.get||r.set)?Object.defineProperty(o,a,r):o[a]=t[a]}return o.default=t,n&&n.set(t,o),o}function Ra(){var t=new xt.ARRAY_TYPE(2);return xt.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function _h(t){var e=new xt.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e}function Mh(t,e){var n=new xt.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n}function Ah(t,e){return t[0]=e[0],t[1]=e[1],t}function xh(t,e,n){return t[0]=e,t[1]=n,t}function Eh(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function Ba(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function Na(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function Fa(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function Ch(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function wh(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function Sh(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function Oh(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}function kh(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function Lh(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function $h(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t}function Da(t,e){var n=e[0]-t[0],o=e[1]-t[1];return Math.hypot(n,o)}function ja(t,e){var n=e[0]-t[0],o=e[1]-t[1];return n*n+o*o}function za(t){var e=t[0],n=t[1];return Math.hypot(e,n)}function Wa(t){var e=t[0],n=t[1];return e*e+n*n}function Ih(t,e){return t[0]=-e[0],t[1]=-e[1],t}function Ph(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function Th(t,e){var n=e[0],o=e[1],i=n*n+o*o;return i>0&&(i=1/Math.sqrt(i)),t[0]=e[0]*i,t[1]=e[1]*i,t}function Rh(t,e){return t[0]*e[0]+t[1]*e[1]}function Bh(t,e,n){var o=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=o,t}function Nh(t,e,n,o){var i=e[0],a=e[1];return t[0]=i+o*(n[0]-i),t[1]=a+o*(n[1]-a),t}function Fh(t,e){e=e||1;var n=xt.RANDOM()*2*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t}function Dh(t,e,n){var o=e[0],i=e[1];return t[0]=n[0]*o+n[2]*i,t[1]=n[1]*o+n[3]*i,t}function jh(t,e,n){var o=e[0],i=e[1];return t[0]=n[0]*o+n[2]*i+n[4],t[1]=n[1]*o+n[3]*i+n[5],t}function zh(t,e,n){var o=e[0],i=e[1];return t[0]=n[0]*o+n[3]*i+n[6],t[1]=n[1]*o+n[4]*i+n[7],t}function Wh(t,e,n){var o=e[0],i=e[1];return t[0]=n[0]*o+n[4]*i+n[12],t[1]=n[1]*o+n[5]*i+n[13],t}function qh(t,e,n,o){var i=e[0]-n[0],a=e[1]-n[1],r=Math.sin(o),s=Math.cos(o);return t[0]=i*s-a*r+n[0],t[1]=i*r+a*s+n[1],t}function Uh(t,e){var n=t[0],o=t[1],i=e[0],a=e[1],r=Math.sqrt(n*n+o*o)*Math.sqrt(i*i+a*a),s=r&&(n*i+o*a)/r;return Math.acos(Math.min(Math.max(s,-1),1))}function Zh(t){return t[0]=0,t[1]=0,t}function Gh(t){return"vec2("+t[0]+", "+t[1]+")"}function Yh(t,e){return t[0]===e[0]&&t[1]===e[1]}function Vh(t,e){var n=t[0],o=t[1],i=e[0],a=e[1];return Math.abs(n-i)<=xt.EPSILON*Math.max(1,Math.abs(n),Math.abs(i))&&Math.abs(o-a)<=xt.EPSILON*Math.max(1,Math.abs(o),Math.abs(a))}var Hh=za;$.len=Hh;var Xh=Ba;$.sub=Xh;var Kh=Na;$.mul=Kh;var Jh=Fa;$.div=Jh;var Qh=Da;$.dist=Qh;var td=ja;$.sqrDist=td;var ed=Wa;$.sqrLen=ed;var nd=function(){var t=Ra();return function(e,n,o,i,a,r){var s,l;for(n||(n=2),o||(o=0),i?l=Math.min(i*n+o,e.length):l=e.length,s=o;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],a(t,t,r),e[s]=t[0],e[s+1]=t[1];return e}}();$.forEach=nd;function od(t,e,n){const o=e[0],i=e[1],a=n[3]*o+n[7]*i||1;return t[0]=(n[0]*o+n[4]*i)/a,t[1]=(n[1]*o+n[5]*i)/a,t}function id(t,e,n){const o=e[0],i=e[1],a=e[2],r=n[3]*o+n[7]*i+n[11]*a||1;return t[0]=(n[0]*o+n[4]*i+n[8]*a)/r,t[1]=(n[1]*o+n[5]*i+n[9]*a)/r,t[2]=(n[2]*o+n[6]*i+n[10]*a)/r,t}var k={};function fn(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?fn=function(e){return typeof e}:fn=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},fn(t)}Object.defineProperty(k,"__esModule",{value:!0}),k.create=Ua,k.clone=sd,k.length=Za,k.fromValues=ld,k.copy=ud,k.set=cd,k.add=pd,k.subtract=Ga,k.multiply=Ya,k.divide=Va,k.ceil=hd,k.floor=dd,k.min=fd,k.max=md,k.round=yd,k.scale=gd,k.scaleAndAdd=vd,k.distance=Ha,k.squaredDistance=Xa,k.squaredLength=Ka,k.negate=bd,k.inverse=_d,k.normalize=Md,k.dot=Ja,k.cross=Ad,k.lerp=xd,k.hermite=Ed,k.bezier=Cd,k.random=wd;var ad=k.transformMat4=Sd;k.transformMat3=Od,k.transformQuat=kd,k.rotateX=Ld,k.rotateY=$d,k.rotateZ=Id,k.angle=Pd,k.zero=Td,k.str=Rd,k.exactEquals=Bd,k.equals=Nd,k.forEach=k.sqrLen=k.len=k.sqrDist=k.dist=k.div=k.mul=k.sub=void 0;var dt=rd(X);function qa(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(qa=function(o){return o?n:e})(t)}function rd(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||fn(t)!=="object"&&typeof t!="function")return{default:t};var n=qa(e);if(n&&n.has(t))return n.get(t);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)){var r=i?Object.getOwnPropertyDescriptor(t,a):null;r&&(r.get||r.set)?Object.defineProperty(o,a,r):o[a]=t[a]}return o.default=t,n&&n.set(t,o),o}function Ua(){var t=new dt.ARRAY_TYPE(3);return dt.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function sd(t){var e=new dt.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Za(t){var e=t[0],n=t[1],o=t[2];return Math.hypot(e,n,o)}function ld(t,e,n){var o=new dt.ARRAY_TYPE(3);return o[0]=t,o[1]=e,o[2]=n,o}function ud(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function cd(t,e,n,o){return t[0]=e,t[1]=n,t[2]=o,t}function pd(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}function Ga(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function Ya(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function Va(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function hd(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function dd(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function fd(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t}function md(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t}function yd(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function gd(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}function vd(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t[2]=e[2]+n[2]*o,t}function Ha(t,e){var n=e[0]-t[0],o=e[1]-t[1],i=e[2]-t[2];return Math.hypot(n,o,i)}function Xa(t,e){var n=e[0]-t[0],o=e[1]-t[1],i=e[2]-t[2];return n*n+o*o+i*i}function Ka(t){var e=t[0],n=t[1],o=t[2];return e*e+n*n+o*o}function bd(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function _d(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function Md(t,e){var n=e[0],o=e[1],i=e[2],a=n*n+o*o+i*i;return a>0&&(a=1/Math.sqrt(a)),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t}function Ja(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Ad(t,e,n){var o=e[0],i=e[1],a=e[2],r=n[0],s=n[1],l=n[2];return t[0]=i*l-a*s,t[1]=a*r-o*l,t[2]=o*s-i*r,t}function xd(t,e,n,o){var i=e[0],a=e[1],r=e[2];return t[0]=i+o*(n[0]-i),t[1]=a+o*(n[1]-a),t[2]=r+o*(n[2]-r),t}function Ed(t,e,n,o,i,a){var r=a*a,s=r*(2*a-3)+1,l=r*(a-2)+a,u=r*(a-1),p=r*(3-2*a);return t[0]=e[0]*s+n[0]*l+o[0]*u+i[0]*p,t[1]=e[1]*s+n[1]*l+o[1]*u+i[1]*p,t[2]=e[2]*s+n[2]*l+o[2]*u+i[2]*p,t}function Cd(t,e,n,o,i,a){var r=1-a,s=r*r,l=a*a,u=s*r,p=3*a*s,d=3*l*r,c=l*a;return t[0]=e[0]*u+n[0]*p+o[0]*d+i[0]*c,t[1]=e[1]*u+n[1]*p+o[1]*d+i[1]*c,t[2]=e[2]*u+n[2]*p+o[2]*d+i[2]*c,t}function wd(t,e){e=e||1;var n=dt.RANDOM()*2*Math.PI,o=dt.RANDOM()*2-1,i=Math.sqrt(1-o*o)*e;return t[0]=Math.cos(n)*i,t[1]=Math.sin(n)*i,t[2]=o*e,t}function Sd(t,e,n){var o=e[0],i=e[1],a=e[2],r=n[3]*o+n[7]*i+n[11]*a+n[15];return r=r||1,t[0]=(n[0]*o+n[4]*i+n[8]*a+n[12])/r,t[1]=(n[1]*o+n[5]*i+n[9]*a+n[13])/r,t[2]=(n[2]*o+n[6]*i+n[10]*a+n[14])/r,t}function Od(t,e,n){var o=e[0],i=e[1],a=e[2];return t[0]=o*n[0]+i*n[3]+a*n[6],t[1]=o*n[1]+i*n[4]+a*n[7],t[2]=o*n[2]+i*n[5]+a*n[8],t}function kd(t,e,n){var o=n[0],i=n[1],a=n[2],r=n[3],s=e[0],l=e[1],u=e[2],p=i*u-a*l,d=a*s-o*u,c=o*l-i*s,f=i*c-a*d,m=a*p-o*c,v=o*d-i*p,h=r*2;return p*=h,d*=h,c*=h,f*=2,m*=2,v*=2,t[0]=s+p+f,t[1]=l+d+m,t[2]=u+c+v,t}function Ld(t,e,n,o){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(o)-i[2]*Math.sin(o),a[2]=i[1]*Math.sin(o)+i[2]*Math.cos(o),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function $d(t,e,n,o){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[2]*Math.sin(o)+i[0]*Math.cos(o),a[1]=i[1],a[2]=i[2]*Math.cos(o)-i[0]*Math.sin(o),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Id(t,e,n,o){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0]*Math.cos(o)-i[1]*Math.sin(o),a[1]=i[0]*Math.sin(o)+i[1]*Math.cos(o),a[2]=i[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t}function Pd(t,e){var n=t[0],o=t[1],i=t[2],a=e[0],r=e[1],s=e[2],l=Math.sqrt(n*n+o*o+i*i),u=Math.sqrt(a*a+r*r+s*s),p=l*u,d=p&&Ja(t,e)/p;return Math.acos(Math.min(Math.max(d,-1),1))}function Td(t){return t[0]=0,t[1]=0,t[2]=0,t}function Rd(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Bd(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Nd(t,e){var n=t[0],o=t[1],i=t[2],a=e[0],r=e[1],s=e[2];return Math.abs(n-a)<=dt.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(o-r)<=dt.EPSILON*Math.max(1,Math.abs(o),Math.abs(r))&&Math.abs(i-s)<=dt.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))}var Fd=Ga;k.sub=Fd;var Dd=Ya;k.mul=Dd;var jd=Va;k.div=jd;var zd=Ha;k.dist=zd;var Wd=Xa;k.sqrDist=Wd;var qd=Za;k.len=qd;var Ud=Ka;k.sqrLen=Ud;var Zd=function(){var t=Ua();return function(e,n,o,i,a,r){var s,l;for(n||(n=3),o||(o=0),i?l=Math.min(i*n+o,e.length):l=e.length,s=o;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],a(t,t,r),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2];return e}}();k.forEach=Zd;class Gd extends ch{toString(){let e="[";if(lt.printRowMajor){e+="row-major:";for(let n=0;n<this.RANK;++n)for(let o=0;o<this.RANK;++o)e+=" ".concat(this[o*this.RANK+n])}else{e+="column-major:";for(let n=0;n<this.ELEMENTS;++n)e+=" ".concat(this[n])}return e+="]",e}getElementIndex(e,n){return n*this.RANK+e}getElement(e,n){return this[n*this.RANK+e]}setElement(e,n,o){return this[n*this.RANK+e]=hh(o),this}getColumn(e,n=new Array(this.RANK).fill(-0)){const o=e*this.RANK;for(let i=0;i<this.RANK;++i)n[i]=this[o+i];return n}setColumn(e,n){const o=e*this.RANK;for(let i=0;i<this.RANK;++i)this[o+i]=n[i];return this}}var j={};function mn(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?mn=function(e){return typeof e}:mn=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},mn(t)}Object.defineProperty(j,"__esModule",{value:!0}),j.create=Vd,j.fromMat4=Hd,j.clone=Xd,j.copy=Kd,j.fromValues=Jd,j.set=Qd,j.identity=tf,j.transpose=ef,j.invert=nf,j.adjoint=of,j.determinant=af,j.multiply=tr,j.translate=rf,j.rotate=sf,j.scale=lf,j.fromTranslation=uf,j.fromRotation=cf,j.fromScaling=pf,j.fromMat2d=hf,j.fromQuat=df,j.normalFromMat4=ff,j.projection=mf,j.str=yf,j.frob=gf,j.add=vf,j.subtract=er,j.multiplyScalar=bf,j.multiplyScalarAndAdd=_f,j.exactEquals=Mf,j.equals=Af,j.sub=j.mul=void 0;var nt=Yd(X);function Qa(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Qa=function(o){return o?n:e})(t)}function Yd(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||mn(t)!=="object"&&typeof t!="function")return{default:t};var n=Qa(e);if(n&&n.has(t))return n.get(t);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)){var r=i?Object.getOwnPropertyDescriptor(t,a):null;r&&(r.get||r.set)?Object.defineProperty(o,a,r):o[a]=t[a]}return o.default=t,n&&n.set(t,o),o}function Vd(){var t=new nt.ARRAY_TYPE(9);return nt.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t}function Hd(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function Xd(t){var e=new nt.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function Kd(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Jd(t,e,n,o,i,a,r,s,l){var u=new nt.ARRAY_TYPE(9);return u[0]=t,u[1]=e,u[2]=n,u[3]=o,u[4]=i,u[5]=a,u[6]=r,u[7]=s,u[8]=l,u}function Qd(t,e,n,o,i,a,r,s,l,u){return t[0]=e,t[1]=n,t[2]=o,t[3]=i,t[4]=a,t[5]=r,t[6]=s,t[7]=l,t[8]=u,t}function tf(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function ef(t,e){if(t===e){var n=e[1],o=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=o,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function nf(t,e){var n=e[0],o=e[1],i=e[2],a=e[3],r=e[4],s=e[5],l=e[6],u=e[7],p=e[8],d=p*r-s*u,c=-p*a+s*l,f=u*a-r*l,m=n*d+o*c+i*f;return m?(m=1/m,t[0]=d*m,t[1]=(-p*o+i*u)*m,t[2]=(s*o-i*r)*m,t[3]=c*m,t[4]=(p*n-i*l)*m,t[5]=(-s*n+i*a)*m,t[6]=f*m,t[7]=(-u*n+o*l)*m,t[8]=(r*n-o*a)*m,t):null}function of(t,e){var n=e[0],o=e[1],i=e[2],a=e[3],r=e[4],s=e[5],l=e[6],u=e[7],p=e[8];return t[0]=r*p-s*u,t[1]=i*u-o*p,t[2]=o*s-i*r,t[3]=s*l-a*p,t[4]=n*p-i*l,t[5]=i*a-n*s,t[6]=a*u-r*l,t[7]=o*l-n*u,t[8]=n*r-o*a,t}function af(t){var e=t[0],n=t[1],o=t[2],i=t[3],a=t[4],r=t[5],s=t[6],l=t[7],u=t[8];return e*(u*a-r*l)+n*(-u*i+r*s)+o*(l*i-a*s)}function tr(t,e,n){var o=e[0],i=e[1],a=e[2],r=e[3],s=e[4],l=e[5],u=e[6],p=e[7],d=e[8],c=n[0],f=n[1],m=n[2],v=n[3],h=n[4],g=n[5],A=n[6],b=n[7],M=n[8];return t[0]=c*o+f*r+m*u,t[1]=c*i+f*s+m*p,t[2]=c*a+f*l+m*d,t[3]=v*o+h*r+g*u,t[4]=v*i+h*s+g*p,t[5]=v*a+h*l+g*d,t[6]=A*o+b*r+M*u,t[7]=A*i+b*s+M*p,t[8]=A*a+b*l+M*d,t}function rf(t,e,n){var o=e[0],i=e[1],a=e[2],r=e[3],s=e[4],l=e[5],u=e[6],p=e[7],d=e[8],c=n[0],f=n[1];return t[0]=o,t[1]=i,t[2]=a,t[3]=r,t[4]=s,t[5]=l,t[6]=c*o+f*r+u,t[7]=c*i+f*s+p,t[8]=c*a+f*l+d,t}function sf(t,e,n){var o=e[0],i=e[1],a=e[2],r=e[3],s=e[4],l=e[5],u=e[6],p=e[7],d=e[8],c=Math.sin(n),f=Math.cos(n);return t[0]=f*o+c*r,t[1]=f*i+c*s,t[2]=f*a+c*l,t[3]=f*r-c*o,t[4]=f*s-c*i,t[5]=f*l-c*a,t[6]=u,t[7]=p,t[8]=d,t}function lf(t,e,n){var o=n[0],i=n[1];return t[0]=o*e[0],t[1]=o*e[1],t[2]=o*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function uf(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function cf(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=n,t[2]=0,t[3]=-n,t[4]=o,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function pf(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function hf(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function df(t,e){var n=e[0],o=e[1],i=e[2],a=e[3],r=n+n,s=o+o,l=i+i,u=n*r,p=o*r,d=o*s,c=i*r,f=i*s,m=i*l,v=a*r,h=a*s,g=a*l;return t[0]=1-d-m,t[3]=p-g,t[6]=c+h,t[1]=p+g,t[4]=1-u-m,t[7]=f-v,t[2]=c-h,t[5]=f+v,t[8]=1-u-d,t}function ff(t,e){var n=e[0],o=e[1],i=e[2],a=e[3],r=e[4],s=e[5],l=e[6],u=e[7],p=e[8],d=e[9],c=e[10],f=e[11],m=e[12],v=e[13],h=e[14],g=e[15],A=n*s-o*r,b=n*l-i*r,M=n*u-a*r,w=o*l-i*s,x=o*u-a*s,C=i*u-a*l,S=p*v-d*m,N=p*h-c*m,F=p*g-f*m,E=d*h-c*v,T=d*g-f*v,D=c*g-f*h,I=A*D-b*T+M*E+w*F-x*N+C*S;return I?(I=1/I,t[0]=(s*D-l*T+u*E)*I,t[1]=(l*F-r*D-u*N)*I,t[2]=(r*T-s*F+u*S)*I,t[3]=(i*T-o*D-a*E)*I,t[4]=(n*D-i*F+a*N)*I,t[5]=(o*F-n*T-a*S)*I,t[6]=(v*C-h*x+g*w)*I,t[7]=(h*M-m*C-g*b)*I,t[8]=(m*x-v*M+g*A)*I,t):null}function mf(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function yf(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function gf(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8])}function vf(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t}function er(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}function bf(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t}function _f(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t[2]=e[2]+n[2]*o,t[3]=e[3]+n[3]*o,t[4]=e[4]+n[4]*o,t[5]=e[5]+n[5]*o,t[6]=e[6]+n[6]*o,t[7]=e[7]+n[7]*o,t[8]=e[8]+n[8]*o,t}function Mf(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Af(t,e){var n=t[0],o=t[1],i=t[2],a=t[3],r=t[4],s=t[5],l=t[6],u=t[7],p=t[8],d=e[0],c=e[1],f=e[2],m=e[3],v=e[4],h=e[5],g=e[6],A=e[7],b=e[8];return Math.abs(n-d)<=nt.EPSILON*Math.max(1,Math.abs(n),Math.abs(d))&&Math.abs(o-c)<=nt.EPSILON*Math.max(1,Math.abs(o),Math.abs(c))&&Math.abs(i-f)<=nt.EPSILON*Math.max(1,Math.abs(i),Math.abs(f))&&Math.abs(a-m)<=nt.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(r-v)<=nt.EPSILON*Math.max(1,Math.abs(r),Math.abs(v))&&Math.abs(s-h)<=nt.EPSILON*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(l-g)<=nt.EPSILON*Math.max(1,Math.abs(l),Math.abs(g))&&Math.abs(u-A)<=nt.EPSILON*Math.max(1,Math.abs(u),Math.abs(A))&&Math.abs(p-b)<=nt.EPSILON*Math.max(1,Math.abs(p),Math.abs(b))}var xf=tr;j.mul=xf;var Ef=er;j.sub=Ef;var nr;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL1ROW0=3]="COL1ROW0",t[t.COL1ROW1=4]="COL1ROW1",t[t.COL1ROW2=5]="COL1ROW2",t[t.COL2ROW0=6]="COL2ROW0",t[t.COL2ROW1=7]="COL2ROW1",t[t.COL2ROW2=8]="COL2ROW2"})(nr||(nr={}));var L={};function yn(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?yn=function(e){return typeof e}:yn=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},yn(t)}Object.defineProperty(L,"__esModule",{value:!0}),L.create=Ff,L.clone=Df,L.copy=jf,L.fromValues=zf,L.set=Wf,L.identity=ar;var Cf=L.transpose=qf,wf=L.invert=Uf;L.adjoint=Zf;var Sf=L.determinant=Gf,or=L.multiply=rr,Of=L.translate=Yf,kf=L.scale=Vf,Lf=L.rotate=Hf,$f=L.rotateX=Xf,If=L.rotateY=Kf,Pf=L.rotateZ=Jf;L.fromTranslation=Qf,L.fromScaling=t1,L.fromRotation=e1,L.fromXRotation=n1,L.fromYRotation=o1,L.fromZRotation=i1,L.fromRotationTranslation=sr,L.fromQuat2=a1,L.getTranslation=r1,L.getScaling=lr,L.getRotation=s1,L.fromRotationTranslationScale=l1,L.fromRotationTranslationScaleOrigin=u1;var Tf=L.fromQuat=c1,Rf=L.frustum=p1;L.perspectiveNO=ur,L.perspectiveZO=d1,L.perspectiveFromFieldOfView=f1,L.orthoNO=pr,L.orthoZO=y1;var Bf=L.lookAt=g1;L.targetTo=v1,L.str=b1,L.frob=_1,L.add=M1,L.subtract=dr,L.multiplyScalar=A1,L.multiplyScalarAndAdd=x1,L.exactEquals=E1,L.equals=C1,L.sub=L.mul=hr=L.ortho=cr=L.perspective=void 0;var q=Nf(X);function ir(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(ir=function(o){return o?n:e})(t)}function Nf(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||yn(t)!=="object"&&typeof t!="function")return{default:t};var n=ir(e);if(n&&n.has(t))return n.get(t);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)){var r=i?Object.getOwnPropertyDescriptor(t,a):null;r&&(r.get||r.set)?Object.defineProperty(o,a,r):o[a]=t[a]}return o.default=t,n&&n.set(t,o),o}function Ff(){var t=new q.ARRAY_TYPE(16);return q.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t}function Df(t){var e=new q.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function jf(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function zf(t,e,n,o,i,a,r,s,l,u,p,d,c,f,m,v){var h=new q.ARRAY_TYPE(16);return h[0]=t,h[1]=e,h[2]=n,h[3]=o,h[4]=i,h[5]=a,h[6]=r,h[7]=s,h[8]=l,h[9]=u,h[10]=p,h[11]=d,h[12]=c,h[13]=f,h[14]=m,h[15]=v,h}function Wf(t,e,n,o,i,a,r,s,l,u,p,d,c,f,m,v,h){return t[0]=e,t[1]=n,t[2]=o,t[3]=i,t[4]=a,t[5]=r,t[6]=s,t[7]=l,t[8]=u,t[9]=p,t[10]=d,t[11]=c,t[12]=f,t[13]=m,t[14]=v,t[15]=h,t}function ar(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function qf(t,e){if(t===e){var n=e[1],o=e[2],i=e[3],a=e[6],r=e[7],s=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=o,t[9]=a,t[11]=e[14],t[12]=i,t[13]=r,t[14]=s}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function Uf(t,e){var n=e[0],o=e[1],i=e[2],a=e[3],r=e[4],s=e[5],l=e[6],u=e[7],p=e[8],d=e[9],c=e[10],f=e[11],m=e[12],v=e[13],h=e[14],g=e[15],A=n*s-o*r,b=n*l-i*r,M=n*u-a*r,w=o*l-i*s,x=o*u-a*s,C=i*u-a*l,S=p*v-d*m,N=p*h-c*m,F=p*g-f*m,E=d*h-c*v,T=d*g-f*v,D=c*g-f*h,I=A*D-b*T+M*E+w*F-x*N+C*S;return I?(I=1/I,t[0]=(s*D-l*T+u*E)*I,t[1]=(i*T-o*D-a*E)*I,t[2]=(v*C-h*x+g*w)*I,t[3]=(c*x-d*C-f*w)*I,t[4]=(l*F-r*D-u*N)*I,t[5]=(n*D-i*F+a*N)*I,t[6]=(h*M-m*C-g*b)*I,t[7]=(p*C-c*M+f*b)*I,t[8]=(r*T-s*F+u*S)*I,t[9]=(o*F-n*T-a*S)*I,t[10]=(m*x-v*M+g*A)*I,t[11]=(d*M-p*x-f*A)*I,t[12]=(s*N-r*E-l*S)*I,t[13]=(n*E-o*N+i*S)*I,t[14]=(v*b-m*w-h*A)*I,t[15]=(p*w-d*b+c*A)*I,t):null}function Zf(t,e){var n=e[0],o=e[1],i=e[2],a=e[3],r=e[4],s=e[5],l=e[6],u=e[7],p=e[8],d=e[9],c=e[10],f=e[11],m=e[12],v=e[13],h=e[14],g=e[15];return t[0]=s*(c*g-f*h)-d*(l*g-u*h)+v*(l*f-u*c),t[1]=-(o*(c*g-f*h)-d*(i*g-a*h)+v*(i*f-a*c)),t[2]=o*(l*g-u*h)-s*(i*g-a*h)+v*(i*u-a*l),t[3]=-(o*(l*f-u*c)-s*(i*f-a*c)+d*(i*u-a*l)),t[4]=-(r*(c*g-f*h)-p*(l*g-u*h)+m*(l*f-u*c)),t[5]=n*(c*g-f*h)-p*(i*g-a*h)+m*(i*f-a*c),t[6]=-(n*(l*g-u*h)-r*(i*g-a*h)+m*(i*u-a*l)),t[7]=n*(l*f-u*c)-r*(i*f-a*c)+p*(i*u-a*l),t[8]=r*(d*g-f*v)-p*(s*g-u*v)+m*(s*f-u*d),t[9]=-(n*(d*g-f*v)-p*(o*g-a*v)+m*(o*f-a*d)),t[10]=n*(s*g-u*v)-r*(o*g-a*v)+m*(o*u-a*s),t[11]=-(n*(s*f-u*d)-r*(o*f-a*d)+p*(o*u-a*s)),t[12]=-(r*(d*h-c*v)-p*(s*h-l*v)+m*(s*c-l*d)),t[13]=n*(d*h-c*v)-p*(o*h-i*v)+m*(o*c-i*d),t[14]=-(n*(s*h-l*v)-r*(o*h-i*v)+m*(o*l-i*s)),t[15]=n*(s*c-l*d)-r*(o*c-i*d)+p*(o*l-i*s),t}function Gf(t){var e=t[0],n=t[1],o=t[2],i=t[3],a=t[4],r=t[5],s=t[6],l=t[7],u=t[8],p=t[9],d=t[10],c=t[11],f=t[12],m=t[13],v=t[14],h=t[15],g=e*r-n*a,A=e*s-o*a,b=e*l-i*a,M=n*s-o*r,w=n*l-i*r,x=o*l-i*s,C=u*m-p*f,S=u*v-d*f,N=u*h-c*f,F=p*v-d*m,E=p*h-c*m,T=d*h-c*v;return g*T-A*E+b*F+M*N-w*S+x*C}function rr(t,e,n){var o=e[0],i=e[1],a=e[2],r=e[3],s=e[4],l=e[5],u=e[6],p=e[7],d=e[8],c=e[9],f=e[10],m=e[11],v=e[12],h=e[13],g=e[14],A=e[15],b=n[0],M=n[1],w=n[2],x=n[3];return t[0]=b*o+M*s+w*d+x*v,t[1]=b*i+M*l+w*c+x*h,t[2]=b*a+M*u+w*f+x*g,t[3]=b*r+M*p+w*m+x*A,b=n[4],M=n[5],w=n[6],x=n[7],t[4]=b*o+M*s+w*d+x*v,t[5]=b*i+M*l+w*c+x*h,t[6]=b*a+M*u+w*f+x*g,t[7]=b*r+M*p+w*m+x*A,b=n[8],M=n[9],w=n[10],x=n[11],t[8]=b*o+M*s+w*d+x*v,t[9]=b*i+M*l+w*c+x*h,t[10]=b*a+M*u+w*f+x*g,t[11]=b*r+M*p+w*m+x*A,b=n[12],M=n[13],w=n[14],x=n[15],t[12]=b*o+M*s+w*d+x*v,t[13]=b*i+M*l+w*c+x*h,t[14]=b*a+M*u+w*f+x*g,t[15]=b*r+M*p+w*m+x*A,t}function Yf(t,e,n){var o=n[0],i=n[1],a=n[2],r,s,l,u,p,d,c,f,m,v,h,g;return e===t?(t[12]=e[0]*o+e[4]*i+e[8]*a+e[12],t[13]=e[1]*o+e[5]*i+e[9]*a+e[13],t[14]=e[2]*o+e[6]*i+e[10]*a+e[14],t[15]=e[3]*o+e[7]*i+e[11]*a+e[15]):(r=e[0],s=e[1],l=e[2],u=e[3],p=e[4],d=e[5],c=e[6],f=e[7],m=e[8],v=e[9],h=e[10],g=e[11],t[0]=r,t[1]=s,t[2]=l,t[3]=u,t[4]=p,t[5]=d,t[6]=c,t[7]=f,t[8]=m,t[9]=v,t[10]=h,t[11]=g,t[12]=r*o+p*i+m*a+e[12],t[13]=s*o+d*i+v*a+e[13],t[14]=l*o+c*i+h*a+e[14],t[15]=u*o+f*i+g*a+e[15]),t}function Vf(t,e,n){var o=n[0],i=n[1],a=n[2];return t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o,t[3]=e[3]*o,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Hf(t,e,n,o){var i=o[0],a=o[1],r=o[2],s=Math.hypot(i,a,r),l,u,p,d,c,f,m,v,h,g,A,b,M,w,x,C,S,N,F,E,T,D,I,tt;return s<q.EPSILON?null:(s=1/s,i*=s,a*=s,r*=s,l=Math.sin(n),u=Math.cos(n),p=1-u,d=e[0],c=e[1],f=e[2],m=e[3],v=e[4],h=e[5],g=e[6],A=e[7],b=e[8],M=e[9],w=e[10],x=e[11],C=i*i*p+u,S=a*i*p+r*l,N=r*i*p-a*l,F=i*a*p-r*l,E=a*a*p+u,T=r*a*p+i*l,D=i*r*p+a*l,I=a*r*p-i*l,tt=r*r*p+u,t[0]=d*C+v*S+b*N,t[1]=c*C+h*S+M*N,t[2]=f*C+g*S+w*N,t[3]=m*C+A*S+x*N,t[4]=d*F+v*E+b*T,t[5]=c*F+h*E+M*T,t[6]=f*F+g*E+w*T,t[7]=m*F+A*E+x*T,t[8]=d*D+v*I+b*tt,t[9]=c*D+h*I+M*tt,t[10]=f*D+g*I+w*tt,t[11]=m*D+A*I+x*tt,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function Xf(t,e,n){var o=Math.sin(n),i=Math.cos(n),a=e[4],r=e[5],s=e[6],l=e[7],u=e[8],p=e[9],d=e[10],c=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+u*o,t[5]=r*i+p*o,t[6]=s*i+d*o,t[7]=l*i+c*o,t[8]=u*i-a*o,t[9]=p*i-r*o,t[10]=d*i-s*o,t[11]=c*i-l*o,t}function Kf(t,e,n){var o=Math.sin(n),i=Math.cos(n),a=e[0],r=e[1],s=e[2],l=e[3],u=e[8],p=e[9],d=e[10],c=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-u*o,t[1]=r*i-p*o,t[2]=s*i-d*o,t[3]=l*i-c*o,t[8]=a*o+u*i,t[9]=r*o+p*i,t[10]=s*o+d*i,t[11]=l*o+c*i,t}function Jf(t,e,n){var o=Math.sin(n),i=Math.cos(n),a=e[0],r=e[1],s=e[2],l=e[3],u=e[4],p=e[5],d=e[6],c=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+u*o,t[1]=r*i+p*o,t[2]=s*i+d*o,t[3]=l*i+c*o,t[4]=u*i-a*o,t[5]=p*i-r*o,t[6]=d*i-s*o,t[7]=c*i-l*o,t}function Qf(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function t1(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function e1(t,e,n){var o=n[0],i=n[1],a=n[2],r=Math.hypot(o,i,a),s,l,u;return r<q.EPSILON?null:(r=1/r,o*=r,i*=r,a*=r,s=Math.sin(e),l=Math.cos(e),u=1-l,t[0]=o*o*u+l,t[1]=i*o*u+a*s,t[2]=a*o*u-i*s,t[3]=0,t[4]=o*i*u-a*s,t[5]=i*i*u+l,t[6]=a*i*u+o*s,t[7]=0,t[8]=o*a*u+i*s,t[9]=i*a*u-o*s,t[10]=a*a*u+l,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function n1(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function o1(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=o,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function i1(t,e){var n=Math.sin(e),o=Math.cos(e);return t[0]=o,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function sr(t,e,n){var o=e[0],i=e[1],a=e[2],r=e[3],s=o+o,l=i+i,u=a+a,p=o*s,d=o*l,c=o*u,f=i*l,m=i*u,v=a*u,h=r*s,g=r*l,A=r*u;return t[0]=1-(f+v),t[1]=d+A,t[2]=c-g,t[3]=0,t[4]=d-A,t[5]=1-(p+v),t[6]=m+h,t[7]=0,t[8]=c+g,t[9]=m-h,t[10]=1-(p+f),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function a1(t,e){var n=new q.ARRAY_TYPE(3),o=-e[0],i=-e[1],a=-e[2],r=e[3],s=e[4],l=e[5],u=e[6],p=e[7],d=o*o+i*i+a*a+r*r;return d>0?(n[0]=(s*r+p*o+l*a-u*i)*2/d,n[1]=(l*r+p*i+u*o-s*a)*2/d,n[2]=(u*r+p*a+s*i-l*o)*2/d):(n[0]=(s*r+p*o+l*a-u*i)*2,n[1]=(l*r+p*i+u*o-s*a)*2,n[2]=(u*r+p*a+s*i-l*o)*2),sr(t,e,n),t}function r1(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function lr(t,e){var n=e[0],o=e[1],i=e[2],a=e[4],r=e[5],s=e[6],l=e[8],u=e[9],p=e[10];return t[0]=Math.hypot(n,o,i),t[1]=Math.hypot(a,r,s),t[2]=Math.hypot(l,u,p),t}function s1(t,e){var n=new q.ARRAY_TYPE(3);lr(n,e);var o=1/n[0],i=1/n[1],a=1/n[2],r=e[0]*o,s=e[1]*i,l=e[2]*a,u=e[4]*o,p=e[5]*i,d=e[6]*a,c=e[8]*o,f=e[9]*i,m=e[10]*a,v=r+p+m,h=0;return v>0?(h=Math.sqrt(v+1)*2,t[3]=.25*h,t[0]=(d-f)/h,t[1]=(c-l)/h,t[2]=(s-u)/h):r>p&&r>m?(h=Math.sqrt(1+r-p-m)*2,t[3]=(d-f)/h,t[0]=.25*h,t[1]=(s+u)/h,t[2]=(c+l)/h):p>m?(h=Math.sqrt(1+p-r-m)*2,t[3]=(c-l)/h,t[0]=(s+u)/h,t[1]=.25*h,t[2]=(d+f)/h):(h=Math.sqrt(1+m-r-p)*2,t[3]=(s-u)/h,t[0]=(c+l)/h,t[1]=(d+f)/h,t[2]=.25*h),t}function l1(t,e,n,o){var i=e[0],a=e[1],r=e[2],s=e[3],l=i+i,u=a+a,p=r+r,d=i*l,c=i*u,f=i*p,m=a*u,v=a*p,h=r*p,g=s*l,A=s*u,b=s*p,M=o[0],w=o[1],x=o[2];return t[0]=(1-(m+h))*M,t[1]=(c+b)*M,t[2]=(f-A)*M,t[3]=0,t[4]=(c-b)*w,t[5]=(1-(d+h))*w,t[6]=(v+g)*w,t[7]=0,t[8]=(f+A)*x,t[9]=(v-g)*x,t[10]=(1-(d+m))*x,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function u1(t,e,n,o,i){var a=e[0],r=e[1],s=e[2],l=e[3],u=a+a,p=r+r,d=s+s,c=a*u,f=a*p,m=a*d,v=r*p,h=r*d,g=s*d,A=l*u,b=l*p,M=l*d,w=o[0],x=o[1],C=o[2],S=i[0],N=i[1],F=i[2],E=(1-(v+g))*w,T=(f+M)*w,D=(m-b)*w,I=(f-M)*x,tt=(1-(c+g))*x,Ct=(h+A)*x,wt=(m+b)*C,Zr=(h-A)*C,Gr=(1-(c+v))*C;return t[0]=E,t[1]=T,t[2]=D,t[3]=0,t[4]=I,t[5]=tt,t[6]=Ct,t[7]=0,t[8]=wt,t[9]=Zr,t[10]=Gr,t[11]=0,t[12]=n[0]+S-(E*S+I*N+wt*F),t[13]=n[1]+N-(T*S+tt*N+Zr*F),t[14]=n[2]+F-(D*S+Ct*N+Gr*F),t[15]=1,t}function c1(t,e){var n=e[0],o=e[1],i=e[2],a=e[3],r=n+n,s=o+o,l=i+i,u=n*r,p=o*r,d=o*s,c=i*r,f=i*s,m=i*l,v=a*r,h=a*s,g=a*l;return t[0]=1-d-m,t[1]=p+g,t[2]=c-h,t[3]=0,t[4]=p-g,t[5]=1-u-m,t[6]=f+v,t[7]=0,t[8]=c+h,t[9]=f-v,t[10]=1-u-d,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function p1(t,e,n,o,i,a,r){var s=1/(n-e),l=1/(i-o),u=1/(a-r);return t[0]=a*2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a*2*l,t[6]=0,t[7]=0,t[8]=(n+e)*s,t[9]=(i+o)*l,t[10]=(r+a)*u,t[11]=-1,t[12]=0,t[13]=0,t[14]=r*a*2*u,t[15]=0,t}function ur(t,e,n,o,i){var a=1/Math.tan(e/2),r;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(r=1/(o-i),t[10]=(i+o)*r,t[14]=2*i*o*r):(t[10]=-1,t[14]=-2*o),t}var h1=ur,cr=L.perspective=h1;function d1(t,e,n,o,i){var a=1/Math.tan(e/2),r;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,i!=null&&i!==1/0?(r=1/(o-i),t[10]=i*r,t[14]=i*o*r):(t[10]=-1,t[14]=-o),t}function f1(t,e,n,o){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),r=Math.tan(e.leftDegrees*Math.PI/180),s=Math.tan(e.rightDegrees*Math.PI/180),l=2/(r+s),u=2/(i+a);return t[0]=l,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=u,t[6]=0,t[7]=0,t[8]=-((r-s)*l*.5),t[9]=(i-a)*u*.5,t[10]=o/(n-o),t[11]=-1,t[12]=0,t[13]=0,t[14]=o*n/(n-o),t[15]=0,t}function pr(t,e,n,o,i,a,r){var s=1/(e-n),l=1/(o-i),u=1/(a-r);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*u,t[11]=0,t[12]=(e+n)*s,t[13]=(i+o)*l,t[14]=(r+a)*u,t[15]=1,t}var m1=pr,hr=L.ortho=m1;function y1(t,e,n,o,i,a,r){var s=1/(e-n),l=1/(o-i),u=1/(a-r);return t[0]=-2*s,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*l,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=u,t[11]=0,t[12]=(e+n)*s,t[13]=(i+o)*l,t[14]=a*u,t[15]=1,t}function g1(t,e,n,o){var i,a,r,s,l,u,p,d,c,f,m=e[0],v=e[1],h=e[2],g=o[0],A=o[1],b=o[2],M=n[0],w=n[1],x=n[2];return Math.abs(m-M)<q.EPSILON&&Math.abs(v-w)<q.EPSILON&&Math.abs(h-x)<q.EPSILON?ar(t):(p=m-M,d=v-w,c=h-x,f=1/Math.hypot(p,d,c),p*=f,d*=f,c*=f,i=A*c-b*d,a=b*p-g*c,r=g*d-A*p,f=Math.hypot(i,a,r),f?(f=1/f,i*=f,a*=f,r*=f):(i=0,a=0,r=0),s=d*r-c*a,l=c*i-p*r,u=p*a-d*i,f=Math.hypot(s,l,u),f?(f=1/f,s*=f,l*=f,u*=f):(s=0,l=0,u=0),t[0]=i,t[1]=s,t[2]=p,t[3]=0,t[4]=a,t[5]=l,t[6]=d,t[7]=0,t[8]=r,t[9]=u,t[10]=c,t[11]=0,t[12]=-(i*m+a*v+r*h),t[13]=-(s*m+l*v+u*h),t[14]=-(p*m+d*v+c*h),t[15]=1,t)}function v1(t,e,n,o){var i=e[0],a=e[1],r=e[2],s=o[0],l=o[1],u=o[2],p=i-n[0],d=a-n[1],c=r-n[2],f=p*p+d*d+c*c;f>0&&(f=1/Math.sqrt(f),p*=f,d*=f,c*=f);var m=l*c-u*d,v=u*p-s*c,h=s*d-l*p;return f=m*m+v*v+h*h,f>0&&(f=1/Math.sqrt(f),m*=f,v*=f,h*=f),t[0]=m,t[1]=v,t[2]=h,t[3]=0,t[4]=d*h-c*v,t[5]=c*m-p*h,t[6]=p*v-d*m,t[7]=0,t[8]=p,t[9]=d,t[10]=c,t[11]=0,t[12]=i,t[13]=a,t[14]=r,t[15]=1,t}function b1(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function _1(t){return Math.hypot(t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7],t[8],t[9],t[10],t[11],t[12],t[13],t[14],t[15])}function M1(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t}function dr(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}function A1(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t}function x1(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t[2]=e[2]+n[2]*o,t[3]=e[3]+n[3]*o,t[4]=e[4]+n[4]*o,t[5]=e[5]+n[5]*o,t[6]=e[6]+n[6]*o,t[7]=e[7]+n[7]*o,t[8]=e[8]+n[8]*o,t[9]=e[9]+n[9]*o,t[10]=e[10]+n[10]*o,t[11]=e[11]+n[11]*o,t[12]=e[12]+n[12]*o,t[13]=e[13]+n[13]*o,t[14]=e[14]+n[14]*o,t[15]=e[15]+n[15]*o,t}function E1(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function C1(t,e){var n=t[0],o=t[1],i=t[2],a=t[3],r=t[4],s=t[5],l=t[6],u=t[7],p=t[8],d=t[9],c=t[10],f=t[11],m=t[12],v=t[13],h=t[14],g=t[15],A=e[0],b=e[1],M=e[2],w=e[3],x=e[4],C=e[5],S=e[6],N=e[7],F=e[8],E=e[9],T=e[10],D=e[11],I=e[12],tt=e[13],Ct=e[14],wt=e[15];return Math.abs(n-A)<=q.EPSILON*Math.max(1,Math.abs(n),Math.abs(A))&&Math.abs(o-b)<=q.EPSILON*Math.max(1,Math.abs(o),Math.abs(b))&&Math.abs(i-M)<=q.EPSILON*Math.max(1,Math.abs(i),Math.abs(M))&&Math.abs(a-w)<=q.EPSILON*Math.max(1,Math.abs(a),Math.abs(w))&&Math.abs(r-x)<=q.EPSILON*Math.max(1,Math.abs(r),Math.abs(x))&&Math.abs(s-C)<=q.EPSILON*Math.max(1,Math.abs(s),Math.abs(C))&&Math.abs(l-S)<=q.EPSILON*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(u-N)<=q.EPSILON*Math.max(1,Math.abs(u),Math.abs(N))&&Math.abs(p-F)<=q.EPSILON*Math.max(1,Math.abs(p),Math.abs(F))&&Math.abs(d-E)<=q.EPSILON*Math.max(1,Math.abs(d),Math.abs(E))&&Math.abs(c-T)<=q.EPSILON*Math.max(1,Math.abs(c),Math.abs(T))&&Math.abs(f-D)<=q.EPSILON*Math.max(1,Math.abs(f),Math.abs(D))&&Math.abs(m-I)<=q.EPSILON*Math.max(1,Math.abs(m),Math.abs(I))&&Math.abs(v-tt)<=q.EPSILON*Math.max(1,Math.abs(v),Math.abs(tt))&&Math.abs(h-Ct)<=q.EPSILON*Math.max(1,Math.abs(h),Math.abs(Ct))&&Math.abs(g-wt)<=q.EPSILON*Math.max(1,Math.abs(g),Math.abs(wt))}var w1=rr;L.mul=w1;var S1=dr;L.sub=S1;var P={};function gn(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?gn=function(e){return typeof e}:gn=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},gn(t)}Object.defineProperty(P,"__esModule",{value:!0}),P.create=mr,P.clone=L1,P.fromValues=$1,P.copy=I1,P.set=P1,P.add=T1,P.subtract=yr,P.multiply=gr,P.divide=vr,P.ceil=R1,P.floor=B1,P.min=N1,P.max=F1,P.round=D1,P.scale=j1,P.scaleAndAdd=z1,P.distance=br,P.squaredDistance=_r,P.length=Mr,P.squaredLength=Ar,P.negate=W1,P.inverse=q1,P.normalize=U1,P.dot=Z1,P.cross=G1,P.lerp=Y1,P.random=V1;var O1=P.transformMat4=H1;P.transformQuat=X1,P.zero=K1,P.str=J1,P.exactEquals=Q1,P.equals=tm,P.forEach=P.sqrLen=P.len=P.sqrDist=P.dist=P.div=P.mul=P.sub=void 0;var at=k1(X);function fr(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(fr=function(o){return o?n:e})(t)}function k1(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||gn(t)!=="object"&&typeof t!="function")return{default:t};var n=fr(e);if(n&&n.has(t))return n.get(t);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)){var r=i?Object.getOwnPropertyDescriptor(t,a):null;r&&(r.get||r.set)?Object.defineProperty(o,a,r):o[a]=t[a]}return o.default=t,n&&n.set(t,o),o}function mr(){var t=new at.ARRAY_TYPE(4);return at.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function L1(t){var e=new at.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function $1(t,e,n,o){var i=new at.ARRAY_TYPE(4);return i[0]=t,i[1]=e,i[2]=n,i[3]=o,i}function I1(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function P1(t,e,n,o,i){return t[0]=e,t[1]=n,t[2]=o,t[3]=i,t}function T1(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t}function yr(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function gr(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function vr(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function R1(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function B1(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function N1(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t}function F1(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t}function D1(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function j1(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t}function z1(t,e,n,o){return t[0]=e[0]+n[0]*o,t[1]=e[1]+n[1]*o,t[2]=e[2]+n[2]*o,t[3]=e[3]+n[3]*o,t}function br(t,e){var n=e[0]-t[0],o=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return Math.hypot(n,o,i,a)}function _r(t,e){var n=e[0]-t[0],o=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return n*n+o*o+i*i+a*a}function Mr(t){var e=t[0],n=t[1],o=t[2],i=t[3];return Math.hypot(e,n,o,i)}function Ar(t){var e=t[0],n=t[1],o=t[2],i=t[3];return e*e+n*n+o*o+i*i}function W1(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function q1(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function U1(t,e){var n=e[0],o=e[1],i=e[2],a=e[3],r=n*n+o*o+i*i+a*a;return r>0&&(r=1/Math.sqrt(r)),t[0]=n*r,t[1]=o*r,t[2]=i*r,t[3]=a*r,t}function Z1(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function G1(t,e,n,o){var i=n[0]*o[1]-n[1]*o[0],a=n[0]*o[2]-n[2]*o[0],r=n[0]*o[3]-n[3]*o[0],s=n[1]*o[2]-n[2]*o[1],l=n[1]*o[3]-n[3]*o[1],u=n[2]*o[3]-n[3]*o[2],p=e[0],d=e[1],c=e[2],f=e[3];return t[0]=d*u-c*l+f*s,t[1]=-(p*u)+c*r-f*a,t[2]=p*l-d*r+f*i,t[3]=-(p*s)+d*a-c*i,t}function Y1(t,e,n,o){var i=e[0],a=e[1],r=e[2],s=e[3];return t[0]=i+o*(n[0]-i),t[1]=a+o*(n[1]-a),t[2]=r+o*(n[2]-r),t[3]=s+o*(n[3]-s),t}function V1(t,e){e=e||1;var n,o,i,a,r,s;do n=at.RANDOM()*2-1,o=at.RANDOM()*2-1,r=n*n+o*o;while(r>=1);do i=at.RANDOM()*2-1,a=at.RANDOM()*2-1,s=i*i+a*a;while(s>=1);var l=Math.sqrt((1-r)/s);return t[0]=e*n,t[1]=e*o,t[2]=e*i*l,t[3]=e*a*l,t}function H1(t,e,n){var o=e[0],i=e[1],a=e[2],r=e[3];return t[0]=n[0]*o+n[4]*i+n[8]*a+n[12]*r,t[1]=n[1]*o+n[5]*i+n[9]*a+n[13]*r,t[2]=n[2]*o+n[6]*i+n[10]*a+n[14]*r,t[3]=n[3]*o+n[7]*i+n[11]*a+n[15]*r,t}function X1(t,e,n){var o=e[0],i=e[1],a=e[2],r=n[0],s=n[1],l=n[2],u=n[3],p=u*o+s*a-l*i,d=u*i+l*o-r*a,c=u*a+r*i-s*o,f=-r*o-s*i-l*a;return t[0]=p*u+f*-r+d*-l-c*-s,t[1]=d*u+f*-s+c*-r-p*-l,t[2]=c*u+f*-l+p*-s-d*-r,t[3]=e[3],t}function K1(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function J1(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function Q1(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function tm(t,e){var n=t[0],o=t[1],i=t[2],a=t[3],r=e[0],s=e[1],l=e[2],u=e[3];return Math.abs(n-r)<=at.EPSILON*Math.max(1,Math.abs(n),Math.abs(r))&&Math.abs(o-s)<=at.EPSILON*Math.max(1,Math.abs(o),Math.abs(s))&&Math.abs(i-l)<=at.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(a-u)<=at.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))}var em=yr;P.sub=em;var nm=gr;P.mul=nm;var om=vr;P.div=om;var im=br;P.dist=im;var am=_r;P.sqrDist=am;var rm=Mr;P.len=rm;var sm=Ar;P.sqrLen=sm;var lm=function(){var t=mr();return function(e,n,o,i,a,r){var s,l;for(n||(n=4),o||(o=0),i?l=Math.min(i*n+o,e.length):l=e.length,s=o;s<l;s+=n)t[0]=e[s],t[1]=e[s+1],t[2]=e[s+2],t[3]=e[s+3],a(t,t,r),e[s]=t[0],e[s+1]=t[1],e[s+2]=t[2],e[s+3]=t[3];return e}}();P.forEach=lm;var po;(function(t){t[t.COL0ROW0=0]="COL0ROW0",t[t.COL0ROW1=1]="COL0ROW1",t[t.COL0ROW2=2]="COL0ROW2",t[t.COL0ROW3=3]="COL0ROW3",t[t.COL1ROW0=4]="COL1ROW0",t[t.COL1ROW1=5]="COL1ROW1",t[t.COL1ROW2=6]="COL1ROW2",t[t.COL1ROW3=7]="COL1ROW3",t[t.COL2ROW0=8]="COL2ROW0",t[t.COL2ROW1=9]="COL2ROW1",t[t.COL2ROW2=10]="COL2ROW2",t[t.COL2ROW3=11]="COL2ROW3",t[t.COL3ROW0=12]="COL3ROW0",t[t.COL3ROW1=13]="COL3ROW1",t[t.COL3ROW2=14]="COL3ROW2",t[t.COL3ROW3=15]="COL3ROW3"})(po||(po={}));const um=45*Math.PI/180,cm=1,ho=.1,fo=500,pm=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class ze extends Gd{static get IDENTITY(){return dm()}static get ZERO(){return hm()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return po}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,n,o,i,a,r,s,l,u,p,d,c,f,m,v,h){return this[0]=e,this[1]=n,this[2]=o,this[3]=i,this[4]=a,this[5]=r,this[6]=s,this[7]=l,this[8]=u,this[9]=p,this[10]=d,this[11]=c,this[12]=f,this[13]=m,this[14]=v,this[15]=h,this.check()}setRowMajor(e,n,o,i,a,r,s,l,u,p,d,c,f,m,v,h){return this[0]=e,this[1]=a,this[2]=u,this[3]=f,this[4]=n,this[5]=r,this[6]=p,this[7]=m,this[8]=o,this[9]=s,this[10]=d,this[11]=v,this[12]=i,this[13]=l,this[14]=c,this[15]=h,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(pm)}fromObject(e){return this.check()}fromQuaternion(e){return Tf(this,e),this.check()}frustum(e){const{left:n,right:o,bottom:i,top:a,near:r=ho,far:s=fo}=e;return s===1/0?fm(this,n,o,i,a,r):Rf(this,n,o,i,a,r,s),this.check()}lookAt(e){const{eye:n,center:o=[0,0,0],up:i=[0,1,0]}=e;return Bf(this,n,o,i),this.check()}ortho(e){const{left:n,right:o,bottom:i,top:a,near:r=ho,far:s=fo}=e;return hr(this,n,o,i,a,r,s),this.check()}orthographic(e){const{fovy:n=um,aspect:o=cm,focalDistance:i=1,near:a=ho,far:r=fo}=e;xr(n);const s=n/2,l=i*Math.tan(s),u=l*o;return this.ortho({left:-u,right:u,bottom:-l,top:l,near:a,far:r})}perspective(e){const{fovy:n=45*Math.PI/180,aspect:o=1,near:i=.1,far:a=500}=e;return xr(n),cr(this,n,o,i,a),this.check()}determinant(){return Sf(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const o=this.getScale(n),i=1/o[0],a=1/o[1],r=1/o[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*r,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*a,e[6]=this[6]*r,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*a,e[10]=this[10]*r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,n){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],n=n||[-0,-0,-0];const o=this.getScale(n),i=1/o[0],a=1/o[1],r=1/o[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*r,e[3]=this[4]*i,e[4]=this[5]*a,e[5]=this[6]*r,e[6]=this[8]*i,e[7]=this[9]*a,e[8]=this[10]*r,e}transpose(){return Cf(this,this),this.check()}invert(){return wf(this,this),this.check()}multiplyLeft(e){return or(this,e,this),this.check()}multiplyRight(e){return or(this,this,e),this.check()}rotateX(e){return $f(this,this,e),this.check()}rotateY(e){return If(this,this,e),this.check()}rotateZ(e){return Pf(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,n){return Lf(this,this,e,n),this.check()}scale(e){return kf(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return Of(this,this,e),this.check()}transform(e,n){return e.length===4?(n=O1(n||[-0,-0,-0,-0],e,this),co(n,4),n):this.transformAsPoint(e,n)}transformAsPoint(e,n){const{length:o}=e;let i;switch(o){case 2:i=vh(n||[-0,-0],e,this);break;case 3:i=ad(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return co(i,e.length),i}transformAsVector(e,n){let o;switch(e.length){case 2:o=od(n||[-0,-0],e,this);break;case 3:o=id(n||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return co(o,e.length),o}transformPoint(e,n){return this.transformAsPoint(e,n)}transformVector(e,n){return this.transformAsPoint(e,n)}transformDirection(e,n){return this.transformAsVector(e,n)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,n,o){return this.identity().translate([e,n,o])}}let vn,bn;function hm(){return vn||(vn=new ze([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(vn)),vn}function dm(){return bn||(bn=new ze,Object.freeze(bn)),bn}function xr(t){if(t>Math.PI*2)throw Error("expected radians")}function fm(t,e,n,o,i,a){const r=2*a/(n-e),s=2*a/(i-o),l=(n+e)/(n-e),u=(i+o)/(i-o),p=-1,d=-1,c=-2*a;return t[0]=r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=s,t[6]=0,t[7]=0,t[8]=l,t[9]=u,t[10]=p,t[11]=d,t[12]=0,t[13]=0,t[14]=c,t[15]=0,t}var O={};function _n(t){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?_n=function(e){return typeof e}:_n=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_n(t)}Object.defineProperty(O,"__esModule",{value:!0}),O.create=mo,O.identity=ym,O.setAxisAngle=Cr,O.getAxisAngle=gm,O.getAngle=vm,O.multiply=wr,O.rotateX=bm,O.rotateY=_m,O.rotateZ=Mm,O.calculateW=Am,O.exp=Sr,O.ln=Or,O.pow=xm,O.slerp=An,O.random=Em,O.invert=Cm,O.conjugate=wm,O.fromMat3=kr,O.fromEuler=Sm,O.str=Om,O.setAxes=O.sqlerp=O.rotationTo=O.equals=O.exactEquals=O.normalize=O.sqrLen=O.squaredLength=O.len=O.length=O.lerp=O.dot=O.scale=O.mul=O.add=O.set=O.copy=O.fromValues=O.clone=void 0;var Et=Mn(X),mm=Mn(j),ft=Mn(k),ot=Mn(P);function Er(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Er=function(o){return o?n:e})(t)}function Mn(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||_n(t)!=="object"&&typeof t!="function")return{default:t};var n=Er(e);if(n&&n.has(t))return n.get(t);var o={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in t)if(a!=="default"&&Object.prototype.hasOwnProperty.call(t,a)){var r=i?Object.getOwnPropertyDescriptor(t,a):null;r&&(r.get||r.set)?Object.defineProperty(o,a,r):o[a]=t[a]}return o.default=t,n&&n.set(t,o),o}function mo(){var t=new Et.ARRAY_TYPE(4);return Et.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function ym(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function Cr(t,e,n){n=n*.5;var o=Math.sin(n);return t[0]=o*e[0],t[1]=o*e[1],t[2]=o*e[2],t[3]=Math.cos(n),t}function gm(t,e){var n=Math.acos(e[3])*2,o=Math.sin(n/2);return o>Et.EPSILON?(t[0]=e[0]/o,t[1]=e[1]/o,t[2]=e[2]/o):(t[0]=1,t[1]=0,t[2]=0),n}function vm(t,e){var n=$r(t,e);return Math.acos(2*n*n-1)}function wr(t,e,n){var o=e[0],i=e[1],a=e[2],r=e[3],s=n[0],l=n[1],u=n[2],p=n[3];return t[0]=o*p+r*s+i*u-a*l,t[1]=i*p+r*l+a*s-o*u,t[2]=a*p+r*u+o*l-i*s,t[3]=r*p-o*s-i*l-a*u,t}function bm(t,e,n){n*=.5;var o=e[0],i=e[1],a=e[2],r=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=o*l+r*s,t[1]=i*l+a*s,t[2]=a*l-i*s,t[3]=r*l-o*s,t}function _m(t,e,n){n*=.5;var o=e[0],i=e[1],a=e[2],r=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=o*l-a*s,t[1]=i*l+r*s,t[2]=a*l+o*s,t[3]=r*l-i*s,t}function Mm(t,e,n){n*=.5;var o=e[0],i=e[1],a=e[2],r=e[3],s=Math.sin(n),l=Math.cos(n);return t[0]=o*l+i*s,t[1]=i*l-o*s,t[2]=a*l+r*s,t[3]=r*l-a*s,t}function Am(t,e){var n=e[0],o=e[1],i=e[2];return t[0]=n,t[1]=o,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-o*o-i*i)),t}function Sr(t,e){var n=e[0],o=e[1],i=e[2],a=e[3],r=Math.sqrt(n*n+o*o+i*i),s=Math.exp(a),l=r>0?s*Math.sin(r)/r:0;return t[0]=n*l,t[1]=o*l,t[2]=i*l,t[3]=s*Math.cos(r),t}function Or(t,e){var n=e[0],o=e[1],i=e[2],a=e[3],r=Math.sqrt(n*n+o*o+i*i),s=r>0?Math.atan2(r,a)/r:0;return t[0]=n*s,t[1]=o*s,t[2]=i*s,t[3]=.5*Math.log(n*n+o*o+i*i+a*a),t}function xm(t,e,n){return Or(t,e),Lr(t,t,n),Sr(t,t),t}function An(t,e,n,o){var i=e[0],a=e[1],r=e[2],s=e[3],l=n[0],u=n[1],p=n[2],d=n[3],c,f,m,v,h;return f=i*l+a*u+r*p+s*d,f<0&&(f=-f,l=-l,u=-u,p=-p,d=-d),1-f>Et.EPSILON?(c=Math.acos(f),m=Math.sin(c),v=Math.sin((1-o)*c)/m,h=Math.sin(o*c)/m):(v=1-o,h=o),t[0]=v*i+h*l,t[1]=v*a+h*u,t[2]=v*r+h*p,t[3]=v*s+h*d,t}function Em(t){var e=Et.RANDOM(),n=Et.RANDOM(),o=Et.RANDOM(),i=Math.sqrt(1-e),a=Math.sqrt(e);return t[0]=i*Math.sin(2*Math.PI*n),t[1]=i*Math.cos(2*Math.PI*n),t[2]=a*Math.sin(2*Math.PI*o),t[3]=a*Math.cos(2*Math.PI*o),t}function Cm(t,e){var n=e[0],o=e[1],i=e[2],a=e[3],r=n*n+o*o+i*i+a*a,s=r?1/r:0;return t[0]=-n*s,t[1]=-o*s,t[2]=-i*s,t[3]=a*s,t}function wm(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function kr(t,e){var n=e[0]+e[4]+e[8],o;if(n>0)o=Math.sqrt(n+1),t[3]=.5*o,o=.5/o,t[0]=(e[5]-e[7])*o,t[1]=(e[6]-e[2])*o,t[2]=(e[1]-e[3])*o;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[i*3+i]&&(i=2);var a=(i+1)%3,r=(i+2)%3;o=Math.sqrt(e[i*3+i]-e[a*3+a]-e[r*3+r]+1),t[i]=.5*o,o=.5/o,t[3]=(e[a*3+r]-e[r*3+a])*o,t[a]=(e[a*3+i]+e[i*3+a])*o,t[r]=(e[r*3+i]+e[i*3+r])*o}return t}function Sm(t,e,n,o){var i=.5*Math.PI/180;e*=i,n*=i,o*=i;var a=Math.sin(e),r=Math.cos(e),s=Math.sin(n),l=Math.cos(n),u=Math.sin(o),p=Math.cos(o);return t[0]=a*l*p-r*s*u,t[1]=r*s*p+a*l*u,t[2]=r*l*u-a*s*p,t[3]=r*l*p+a*s*u,t}function Om(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}var km=ot.clone;O.clone=km;var Lm=ot.fromValues;O.fromValues=Lm;var $m=ot.copy;O.copy=$m;var Im=ot.set;O.set=Im;var Pm=ot.add;O.add=Pm;var Tm=wr;O.mul=Tm;var Lr=ot.scale;O.scale=Lr;var $r=ot.dot;O.dot=$r;var Rm=ot.lerp;O.lerp=Rm;var Ir=ot.length;O.length=Ir;var Bm=Ir;O.len=Bm;var Pr=ot.squaredLength;O.squaredLength=Pr;var Nm=Pr;O.sqrLen=Nm;var yo=ot.normalize;O.normalize=yo;var Fm=ot.exactEquals;O.exactEquals=Fm;var Dm=ot.equals;O.equals=Dm;var jm=function(){var t=ft.create(),e=ft.fromValues(1,0,0),n=ft.fromValues(0,1,0);return function(o,i,a){var r=ft.dot(i,a);return r<-.999999?(ft.cross(t,e,i),ft.len(t)<1e-6&&ft.cross(t,n,i),ft.normalize(t,t),Cr(o,t,Math.PI),o):r>.999999?(o[0]=0,o[1]=0,o[2]=0,o[3]=1,o):(ft.cross(t,i,a),o[0]=t[0],o[1]=t[1],o[2]=t[2],o[3]=1+r,yo(o,o))}}();O.rotationTo=jm;var zm=function(){var t=mo(),e=mo();return function(n,o,i,a,r,s){return An(t,o,r,s),An(e,i,a,s),An(n,t,e,2*s*(1-s)),n}}();O.sqlerp=zm;var Wm=function(){var t=mm.create();return function(e,n,o,i){return t[0]=o[0],t[3]=o[1],t[6]=o[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],yo(e,kr(e,t))}}();O.setAxes=Wm;var Tr;(function(t){t[t.ZYX=0]="ZYX",t[t.YXZ=1]="YXZ",t[t.XZY=2]="XZY",t[t.ZXY=3]="ZXY",t[t.YZX=4]="YZX",t[t.XYZ=5]="XYZ"})(Tr||(Tr={}));const Y=3.141592653589793,xn=6378245,En=.006693421622965943,Cn=Y*3e3/180;function We(t,e,n){const o=Y/180*e,i=Math.pow(2,n),a=Math.floor((t+180)/360*i),r=Math.floor((1-Math.asinh(Math.tan(o))/Y)/2*i);return[a,r]}function Rr(t,e,n){const o=Math.pow(2,n),i=t/o*360-180,a=Math.atan(Math.sinh(Y*(1-2*e/o)))*180/Y;return[i,a]}function qm(t,e){let n=Fr(t-105,e-35),o=Dr(t-105,e-35);const i=e/180*Y;let a=Math.sin(i);a=1-En*a*a;const r=Math.sqrt(a);n=n*180/(xn*(1-En)/(a*r)*Y),o=o*180/(xn/r*Math.cos(i)*Y);const s=e+n;return{lng:t+o,lat:s}}function Br(t,e){const n=Zm(t,e),o=t*2-n.lng,i=e*2-n.lat;return{lng:o,lat:i}}function Nr(t,e){const n=Math.sqrt(t*t+e*e)+2e-5*Math.sin(e*Cn),o=Math.atan2(e,t)+3e-6*Math.cos(t*Cn),i=n*Math.cos(o)+.0065,a=n*Math.sin(o)+.006;return{lng:i,lat:a}}function Um(t,e){const n=t-.0065,o=e-.006,i=Math.sqrt(n*n+o*o)-2e-5*Math.sin(o*Cn),a=Math.atan2(o,n)-3e-6*Math.cos(n*Cn),r=i*Math.cos(a),s=i*Math.sin(a);return{lng:r,lat:s}}function Zm(t,e){let n=Fr(t-105,e-35),o=Dr(t-105,e-35);const i=e/180*Y;let a=Math.sin(i);a=1-En*a*a;const r=Math.sqrt(a);n=n*180/(xn*(1-En)/(a*r)*Y),o=o*180/(xn/r*Math.cos(i)*Y);const s=e+n;return{lng:t+o,lat:s}}function Fr(t,e){let n=-100+2*t+3*e+.2*e*e+.1*t*e+.2*Math.sqrt(Math.abs(t));return n+=(20*Math.sin(6*t*Y)+20*Math.sin(2*t*Y))*2/3,n+=(20*Math.sin(e*Y)+40*Math.sin(e/3*Y))*2/3,n+=(160*Math.sin(e/12*Y)+320*Math.sin(e*Y/30))*2/3,n}function Dr(t,e){let n=300+t+2*e+.1*t*t+.1*t*e+.1*Math.sqrt(Math.abs(t));return n+=(20*Math.sin(6*t*Y)+20*Math.sin(2*t*Y))*2/3,n+=(20*Math.sin(t*Y)+40*Math.sin(t/3*Y))*2/3,n+=(150*Math.sin(t/12*Y)+300*Math.sin(t/30*Y))*2/3,n}function jr(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function Gm(t,e){for(var n in e)t[n]=e[n]}function zr(t){return typeof t=="string"}var Wr=void 0,wn=null;function rt(t,e){isNaN(t)&&(t=Ib(t),t=isNaN(t)?0:t),zr(t)&&(t=parseFloat(t)),isNaN(e)&&(e=Ib(e),e=isNaN(e)?0:e),zr(e)&&(e=parseFloat(e)),this.lng=t,this.lat=e}rt.TL=function(t){return t&&180>=t.lng&&-180<=t.lng&&74>=t.lat&&-74<=t.lat},rt.prototype.lb=function(t){return t&&this.lat==t.lat&&this.lng==t.lng};function Sn(t,e){this.x=t||0,this.y=e||0,this.x=this.x,this.y=this.y}Sn.prototype.lb=function(t){return t&&t.x==this.x&&t.y==this.y};function go(){}go.prototype.nh=function(){aa("lngLatToPoint\u65B9\u6CD5\u672A\u5B9E\u73B0")},go.prototype.wi=function(){aa("pointToLngLat\u65B9\u6CD5\u672A\u5B9E\u73B0")};function mt(){}mt.prototype=new go,jr(mt,{$O:637099681e-2,lG:[1289059486e-2,836237787e-2,5591021,348198983e-2,167804312e-2,0],Au:[75,60,45,30,15,0],fP:[[1410526172116255e-23,898305509648872e-20,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,173379812e-1],[-7435856389565537e-24,8983055097726239e-21,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,1026014486e-2],[-3030883460898826e-23,898305509983578e-20,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,685681737e-2],[-1981981304930552e-23,8983055099779535e-21,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,448277706e-2],[309191371068437e-23,8983055096812155e-21,6995724062e-14,23.10934304144901,-.00023663490511,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,25551644e-1],[2890871144776878e-24,8983055095805407e-21,-3068298e-14,7.47137025468032,-353937994e-14,-.02145144861037,-1234426596e-14,.00010322952773,-323890364e-14,826088.5]],iG:[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[.0008277824516172526,111320.7020463578,6477955746671607e-7,-4082003173641316e-6,1077490566351142e-5,-1517187553151559e-5,1205306533862167e-5,-5124939663577472e-6,9133119359512032e-7,67.5],[.00337398766765,111320.7020202162,4481351045890365e-9,-2339375119931662e-8,7968221547186455e-8,-1159649932797253e-7,9723671115602145e-8,-4366194633752821e-8,8477230501135234e-9,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837749470245e-9,992013.7397791013,-122195221711287e-8,1340652697009075e-9,-620943.6990984312,144416.9293806241,37.5],[-.0003441963504368392,111320.7020576856,278.2353980772752,2485758690035394e-9,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-.0003218135878613132,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],Z1:function(i,e){if(!i||!e)return 0;var n,o,i=this.Fb(i);return i?(n=this.Tk(i.lng),o=this.Tk(i.lat),e=this.Fb(e),e?this.Pe(n,this.Tk(e.lng),o,this.Tk(e.lat)):0):0},Vo:function(t,e){return!t||!e?0:(t.lng=this.JD(t.lng,-180,180),t.lat=this.ND(t.lat,-74,74),e.lng=this.JD(e.lng,-180,180),e.lat=this.ND(e.lat,-74,74),this.Pe(this.Tk(t.lng),this.Tk(e.lng),this.Tk(t.lat),this.Tk(e.lat)))},Fb:function(t){if(t===wn||t===Wr)return new rt(0,0);var e,n;e=new rt(Math.abs(t.lng),Math.abs(t.lat));for(var o=0;o<this.lG.length;o++)if(e.lat>=this.lG[o]){n=this.fP[o];break}return t=this.gK(t,n),t=new rt(t.lng.toFixed(6),t.lat.toFixed(6))},Eb:function(t){if(t===wn||t===Wr||180<t.lng||-180>t.lng||90<t.lat||-90>t.lat)return new rt(0,0);var e,n;t.lng=this.JD(t.lng,-180,180),t.lat=this.ND(t.lat,-74,74),e=new rt(t.lng,t.lat);for(var o=0;o<this.Au.length;o++)if(e.lat>=this.Au[o]){n=this.iG[o];break}if(!n){for(o=0;o<this.Au.length;o++)if(e.lat<=-this.Au[o]){n=this.iG[o];break}}return t=this.gK(t,n),t=new rt(t.lng.toFixed(2),t.lat.toFixed(2))},gK:function(t,e){if(t&&e){var n=e[0]+e[1]*Math.abs(t.lng),o=Math.abs(t.lat)/e[9],o=e[2]+e[3]*o+e[4]*o*o+e[5]*o*o*o+e[6]*o*o*o*o+e[7]*o*o*o*o*o+e[8]*o*o*o*o*o*o,n=n*(0>t.lng?-1:1),o=o*(0>t.lat?-1:1);return new rt(n,o)}},Pe:function(t,e,n,o){return this.$O*Math.acos(Math.sin(n)*Math.sin(o)+Math.cos(n)*Math.cos(o)*Math.cos(e-t))},Tk:function(t){return Math.PI*t/180},Z3:function(t){return 180*t/Math.PI},ND:function(t,e,n){return e!=wn&&(t=Math.max(t,e)),n!=wn&&(t=Math.min(t,n)),t},JD:function(t,e,n){for(;t>n;)t-=n-e;for(;t<e;)t+=n-e;return t}}),jr(mt.prototype,{Jm:function(t){return mt.Eb(t)},nh:function(t){return t=mt.Eb(t),new Sn(t.lng,t.lat)},qh:function(t){return mt.Fb(t)},wi:function(t){return t=new rt(t.x,t.y),mt.Fb(t)},fc:function(t,e,n,o,i){if(t)return t=this.Jm(t,i),e=this.Lc(e),new Sn(Math.round((t.lng-n.lng)/e+o.width/2),Math.round((n.lat-t.lat)/e+o.height/2))},zb:function(t,e,n,o,i){if(t)return e=this.Lc(e),this.qh(new rt(n.lng+e*(t.x-o.width/2),n.lat-e*(t.y-o.height/2)),i)},Lc:function(t){return Math.pow(2,18-t)}});var vo=mt.prototype;Gm(vo,{lngLatToPoint:vo.nh,pointToLngLat:vo.wi});let bo={Point:rt,Pixel:Sn,MercatorProjection:mt};class Ym{constructor(e,n){this.projection=new bo.MercatorProjection,this.levelMax=e,this.levelMin=n}_getRetain(e){return Math.pow(2,e-18)}getResolution(e,n){return Math.pow(2,18-n)*Math.cos(e)}lnglatToPoint(e,n){let o=new bo.Point(e,n),i=this.projection.lngLatToPoint(o);return{pointX:i.x,pointY:i.y}}pointToLnglat(e,n){let o=new bo.Pixel(e,n),i=this.projection.pointToLngLat(o);return{lng:i.lng,lat:i.lat}}_lngToTileX(e,n){let o=this.lnglatToPoint(e,0);return Math.floor(o.pointX*this._getRetain(n)/256)}_latToTileY(e,n){let o=this.lnglatToPoint(0,e);return Math.floor(o.pointY*this._getRetain(n)/256)}lnglatToTile(e,n,o){let i=this._lngToTileX(e,o),a=this._latToTileY(n,o);return[i,a]}_lngToPixelX(e,n){let o=this._lngToTileX(e,n),i=this.lnglatToPoint(e,0);return Math.floor(i.pointX*this._getRetain(n)-o*256)}_latToPixelY(e,n){let o=this._latToTileY(e,n),i=this.lnglatToPoint(0,e);return Math.floor(i.pointY*this._getRetain(n)-o*256)}lnglatToPixel(e,n,o){let i=this._lngToPixelX(e,o),a=this._latToPixelY(n,o);return{pixelX:i,pixelY:a}}_pixelXToLng(e,n,o){let i=(n*256+e)/this._getRetain(o);return this.pointToLnglat(i,0).lng}_pixelYToLat(e,n,o){let i=(n*256+e)/this._getRetain(o);return this.pointToLnglat(0,i).lat}pixelToLnglat(e,n,o,i,a){let r=(o*256+e)/this._getRetain(a),s=(i*256+n)/this._getRetain(a),l=this.pointToLnglat(r,s);return[l.lng,l.lat]}}Object.freeze=function(t){return t};var Vm=/\{ *([\w_-]+) *\}/g;function Hm(t,e){return t.replace(Vm,function(n,o){let i=e[o];if(i===void 0)throw new Error(`No value provided for variable ${n}`);return typeof i=="function"&&(i=i(e)),i})}class Xm{constructor(e,n){if(this.program=null,this.showTiles=[],this.isReadRender=!1,this.isLayerShow=!1,this.tileCache=[],this.gridCache={},this.transformBaidu=new Ym,this.maskCache=[],this._projectionMatrix=new ze,this._viewMatrix4=new ze,this._mvpMatrix4=new ze,this.isOrtho=!1,!e)throw new Error("\u8BF7\u4F20\u5165\u5730\u56FE\u5B9E\u4F8B");this.validate(n),this.map=e,this.center=e.getCenter().toArray(),this.options=Object.assign(this.getDefaultGlLayerOptions(),n),this.customCoords=e.customCoords,this.customCoords.lngLatsToCoords([this.center]),this.layer=new AMap.GLCustomLayer({zooms:this.options.zooms,opacity:this.options.opacity,visible:this.options.visible,zIndex:this.options.zIndex,init:o=>{this.gl=o;const i=`
                    uniform mat4 u_ProjectionMatrix;
                    uniform mat4 u_ViewMatrix4;
                    uniform mat4 u_MvpMatrix4;
                    uniform bool u_isOrtho;
                    attribute vec2 a_pos;
                    attribute vec2 a_TextCoord;
                    varying vec2 v_TextCoord;
                    void main() {
                       if(u_isOrtho){
                         gl_Position = u_MvpMatrix4 * vec4(a_pos,0.0, 1.0);
                       }else{
                         gl_Position = u_ProjectionMatrix * u_ViewMatrix4 * vec4(a_pos,0.0, 1.0);
                       }
                       v_TextCoord = a_TextCoord;
                    }`,a=`
                    precision mediump float;
                    uniform sampler2D u_Sampler;
                    uniform bool u_isFirst;
                    varying vec2 v_TextCoord;
                    void main() {
                       if(u_isFirst){
                         gl_FragColor = vec4(1.0, 0.0, 0.0, 0.0);
                       }else{
                         gl_FragColor = texture2D(u_Sampler, v_TextCoord);
                       }
                    }`,r=o.createShader(o.VERTEX_SHADER);o.shaderSource(r,i),o.compileShader(r);const s=o.createShader(o.FRAGMENT_SHADER);o.shaderSource(s,a),o.compileShader(s),this.program=o.createProgram(),o.attachShader(this.program,r),o.attachShader(this.program,s),o.linkProgram(this.program),this.a_Pos=o.getAttribLocation(this.program,"a_pos"),this.a_TextCoord=o.getAttribLocation(this.program,"a_TextCoord");const l="uniform mat4 u_ProjectionMatrix;uniform mat4 u_ViewMatrix4;uniform mat4 u_MvpMatrix4;uniform bool u_isOrtho;attribute vec2 a_pos;void main() {   if(u_isOrtho){     gl_Position = u_MvpMatrix4 * vec4(a_pos,0.0, 1.0);   }else{     gl_Position = u_ProjectionMatrix * u_ViewMatrix4 * vec4(a_pos,0.0, 1.0);   }}",u="void main() {    gl_FragColor = vec4(0.0, 1.0, 0.0, 0.0);}",p=o.createShader(o.VERTEX_SHADER);o.shaderSource(p,l),o.compileShader(p);const d=o.createShader(o.FRAGMENT_SHADER);o.shaderSource(d,u),o.compileShader(d),this.maskProgram=o.createProgram(),o.attachShader(this.maskProgram,p),o.attachShader(this.maskProgram,d),o.linkProgram(this.maskProgram),this.mask_Pos=o.getAttribLocation(this.maskProgram,"a_pos"),this.options.visible&&(this.isLayerShow=!0),this.mapCallback=()=>{this.isLayerShow&&this.update()},e.on("dragging",this.mapCallback),e.on("moveend",this.mapCallback),e.on("zoomchange",this.mapCallback),e.on("rotatechange",this.mapCallback),this._createMask(this.options.mask),this.update()},render:o=>{if(!this.isReadRender)return;const i=this.options.zooms;if(!(this.map.getZoom()<i[0]||this.map.getZoom()>i[1])){if(this.customCoords.setCenter(this.center),e.getView().type==="3D"){this.isOrtho=!1;const{near:a,far:r,fov:s,up:l,lookAt:u,position:p}=this.customCoords.getCameraParams();this._viewMatrix4.lookAt({eye:p,center:u,up:l}).translate([0,0,this.options.altitude]),this._projectionMatrix.perspective({fovy:s*Math.PI/180,far:r,near:a,aspect:o.drawingBufferWidth/o.drawingBufferHeight})}else{this.isOrtho=!0;const a=this.customCoords.getMVPMatrix();this._mvpMatrix4.copy(a)}this.reset(o),this.maskCache.length>0?(o.clearStencil(0),o.clear(o.STENCIL_BUFFER_BIT),o.enable(o.STENCIL_TEST),o.stencilFunc(o.ALWAYS,1,255),o.stencilOp(o.KEEP,o.KEEP,o.REPLACE),this._renderMask(o),o.stencilFunc(o.EQUAL,1,255),o.stencilOp(o.KEEP,o.KEEP,o.KEEP),o.disable(o.DEPTH_TEST),this._renderTile(o),o.enable(o.DEPTH_TEST),o.disable(o.STENCIL_TEST)):this._renderTile(o),this.reset(o)}}}),e.add(this.layer)}_renderMask(e){if(this.maskCache.length){this.customCoords.setCenter(this.center),e.useProgram(this.maskProgram),this.setVertex(e,this.maskProgram);for(const n of this.maskCache)e.bindBuffer(e.ARRAY_BUFFER,n.vertexBuffer),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,n.indexBuffer),e.vertexAttribPointer(this.mask_Pos,2,e.FLOAT,!1,0,0),e.enableVertexAttribArray(this.mask_Pos),e.drawElements(e.TRIANGLES,n.deviationLength,e.UNSIGNED_INT,0)}}_renderTile(e){var n,o,i,a,r,s;this.customCoords.setCenter(this.center),e.useProgram(this.program),this.setVertex(e,this.program);let l=0;for(const u of this.showTiles){if(!u.isLoad||u.imageError)continue;e.bindTexture(e.TEXTURE_2D,u.texture),e.activeTexture(e.TEXTURE0),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_MIN_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(e.TEXTURE_2D,e.TEXTURE_WRAP_T,e.MIRRORED_REPEAT);const p=e.getUniformLocation(this.program,"u_Sampler");e.uniform1i(p,0),e.uniform1f(e.getUniformLocation(this.program,"u_isFirst"),l===0),e.bindBuffer(e.ARRAY_BUFFER,u.buffer),e.vertexAttribPointer(this.a_Pos,(n=u.PosParam)===null||n===void 0?void 0:n.size,e.FLOAT,!1,(o=u.PosParam)===null||o===void 0?void 0:o.stride,(i=u.PosParam)===null||i===void 0?void 0:i.offset),e.vertexAttribPointer(this.a_TextCoord,(a=u.TextCoordParam)===null||a===void 0?void 0:a.size,e.FLOAT,!1,(r=u.TextCoordParam)===null||r===void 0?void 0:r.stride,(s=u.TextCoordParam)===null||s===void 0?void 0:s.offset),e.enableVertexAttribArray(this.a_Pos),e.enableVertexAttribArray(this.a_TextCoord),e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.drawArrays(e.TRIANGLE_STRIP,0,4),l++}}reset(e){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height)}validate(e){if(!e.url)throw new Error("\u8BF7\u4F20\u5165url");if(e.url.includes("{s}")&&(!e.subdomains||e.subdomains.length===0))throw new Error("\u8BF7\u4F20\u5165subdomains")}getDefaultGlLayerOptions(){return{url:"",zooms:[2,18],opacity:1,visible:!0,zIndex:120,proj:"gcj02",tileType:"xyz",debug:!1,cacheSize:512,tileMaxZoom:18,altitude:0}}_createMask(e){if(!e||e.length===0){this.maskCache=[];return}const n=this.getMaskDeep(e);if(n<2||n>4){console.warn("mask\u6570\u636E\u683C\u5F0F\u4E0D\u6B63\u786E");return}n===2?e=[[e]]:n===3&&(e=[e]);for(let o of e){o=this._convertMaskLnglatToCoords(o);const i=ln.exports.flatten(o),a=ln.exports(i.vertices,i.holes,i.dimensions),r=this.gl,s=new Float32Array(i.vertices),l=r.createBuffer();r.bindBuffer(r.ARRAY_BUFFER,l),r.bufferData(r.ARRAY_BUFFER,s,r.STATIC_DRAW),r.bindBuffer(r.ARRAY_BUFFER,null);const u=r.createBuffer();r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,u),r.bufferData(r.ELEMENT_ARRAY_BUFFER,new Uint32Array(a),r.STATIC_DRAW),r.bindBuffer(r.ELEMENT_ARRAY_BUFFER,null),this.maskCache.push({FSIZE:s.BYTES_PER_ELEMENT,vertexBuffer:l,indexBuffer:u,deviationLength:a.length})}}getMaskDeep(e,n=1){return e.length?typeof e[0]=="number"?n:this.getMaskDeep(e[0],n+1):-1}_convertMaskLnglatToCoords(e){return!e||e.length===0?e:typeof e[0]=="number"?this._convertLnglatToCoords([e[0],e[1]]):e.map(n=>this._convertMaskLnglatToCoords(n))}_convertLnglatToCoords(e){return this.customCoords.setCenter(this.center),this.customCoords.lngLatsToCoords([e])[0]}update(){if(!this.gl)return;this.isReadRender=!1;const e=this.gl,n=this.map,o=n.getCenter();let i=Math.ceil(n.getZoom());i>this.options.tileMaxZoom&&(i=this.options.tileMaxZoom);const a=n.getBounds();let r,s,l,u;if(this.options.tileType==="xyz"?(l=a.getNorthWest().toArray(),u=a.getSouthEast().toArray()):(l=a.getSouthWest().toArray(),u=a.getNorthEast().toArray()),this.options.proj==="wgs84"){const c=Br(...l),f=Br(...u);r=We(c.lng,c.lat,i),s=We(f.lng,f.lat,i)}else if(this.options.proj==="bd09"){const c=Nr(...l),f=Nr(...u);r=this.transformBaidu.lnglatToTile(c.lng,c.lat,i),s=this.transformBaidu.lnglatToTile(f.lng,f.lat,i)}else r=We(l[0],l[1],i),s=We(u[0],u[1],i);const p=[];for(let c=r[0];c<=s[0];c++)for(let f=r[1];f<=s[1];f++){const m={x:c,y:f,z:i};p.push(m),this.addGridCache(m,0,0),c===s[0]&&this.addGridCache(m,1,0),f===s[1]&&this.addGridCache(m,0,1),c===s[0]&&f===s[1]&&this.addGridCache(m,1,1)}let d;this.options.tileType==="xyz"?d=We(o.getLng(),o.getLat(),i):d=this.transformBaidu.lnglatToTile(o.getLng(),o.getLat(),i),p.sort((c,f)=>this.tileDistance(c,d)-this.tileDistance(f,d)),this._cancelOutViewImage(p),this._clearShowTile();for(const c of p){const f=this.createTileKey(c),m=this.getTileCache(f);if(m){if(m.imageError)continue;!m.isLoad&&m.image&&m.imageCanceled&&(m.image.src=m.url,m.imageCanceled=!1),this.showTiles.push(m)}else{const v=this.createTile(e,c);this.showTiles.push(v),this.pushTileCache(v)}}this.showTiles.length>0&&this.showTiles.unshift(this.showTiles[0]),this.isReadRender=!0}_cancelOutViewImage(e){this.tileCache.forEach(n=>{e.findIndex(o=>this.createTileKey(o)===n.xyzKey)===-1&&!n.isLoad&&n.image&&(n.image.src="",n.imageCanceled=!0)})}getTileCache(e){return this.tileCache.find(n=>n.xyzKey===e)}pushTileCache(e){const n=this.options.cacheSize;n>0&&this.tileCache.length>=n&&(this.showTiles.findIndex(o=>o.xyzKey===this.tileCache[0].xyzKey)<0&&this._destroyTile(this.tileCache[0]),this.tileCache.splice(0,1)),this.tileCache.push(e)}addGridCache(e,n,o){const i=this.createTileKey(e.x+n,e.y+o,e.z);if(!this.gridCache[i])if(this.options.proj==="wgs84"){const a=qm(...Rr(e.x+n,e.y+o,e.z)),r=this._convertLnglatToCoords([a.lng,a.lat]);this.gridCache[i]={lng:r[0],lat:r[1]}}else if(this.options.tileType==="bd09"){const a=Um(...this.transformBaidu.pixelToLnglat(0,0,e.x+n,e.y+o,e.z)),r=this._convertLnglatToCoords([a.lng,a.lat]);this.gridCache[i]={lng:r[0],lat:r[1]}}else{const a=this._convertLnglatToCoords(Rr(e.x+n,e.y+o,e.z));this.gridCache[i]={lng:a[0],lat:a[1]}}}tileDistance(e,n){return Math.sqrt(Math.pow(e.x-n[0],2)+Math.pow(e.y-n[1],2))}createTileKey(e,n,o){return e instanceof Object?`${e.z}/${e.x}/${e.y}`:`${o}/${e}/${n}`}deepFormatTileNumber(e,n){return e>=0&&e<n?e:(e>0&&e>=n?e=e-n:e<0&&(e=e+n),this.deepFormatTileNumber(e,n))}createTile(e,n){let o=Math.ceil(this.map.getZoom());o>this.options.tileMaxZoom&&(o=this.options.tileMaxZoom);const i=Math.pow(2,o);let a=n.x,r=n.y;a=this.deepFormatTileNumber(a,i),r=this.deepFormatTileNumber(r,i);const s={x:a,y:r,z:n.z};this.options.subdomains&&(s.s=this.options.subdomains[Math.abs(n.x+n.y)%this.options.subdomains.length]);const l=Hm(this.options.url,s),u={xyz:n,xyzKey:this.createTileKey(n),isLoad:!1,url:l,imageCanceled:!1};let p,d,c,f;this.options.tileType==="xyz"?(p=this.gridCache[this.createTileKey(n)],d=this.gridCache[this.createTileKey(n.x+1,n.y,n.z)],c=this.gridCache[this.createTileKey(n.x,n.y+1,n.z)],f=this.gridCache[this.createTileKey(n.x+1,n.y+1,n.z)]):(p=this.gridCache[this.createTileKey(n.x,n.y+1,n.z)],d=this.gridCache[this.createTileKey(n.x+1,n.y+1,n.z)],c=this.gridCache[this.createTileKey(n)],f=this.gridCache[this.createTileKey(n.x+1,n.y,n.z)]);const m=new Float32Array([p.lng,p.lat,0,1,c.lng,c.lat,0,0,d.lng,d.lat,1,1,f.lng,f.lat,1,0]),v=m.BYTES_PER_ELEMENT,h=e.createBuffer();e.bindBuffer(e.ARRAY_BUFFER,h),e.bufferData(e.ARRAY_BUFFER,m,e.STATIC_DRAW),u.buffer=h,u.PosParam={size:2,stride:v*4,offset:0},u.TextCoordParam={size:2,stride:v*4,offset:v*2};const g=new Image(256,256);return g.onload=()=>{if(u.texture=e.createTexture(),e.bindTexture(e.TEXTURE_2D,u.texture),e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,1),this.options.debug){const A=document.createElement("canvas");A.width=256,A.height=256;const b=A.getContext("2d");b.drawImage(g,0,0),b.font="25px Verdana",b.fillStyle="#ff0000",b.strokeStyle="#FF0000",b.strokeRect(0,0,256,256),b.fillText(`(${[n.x,n.y,n.z].join(",")})`,10,30),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,A)}else e.texImage2D(e.TEXTURE_2D,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,g);u.isLoad=!0,this.showTiles.findIndex(A=>A===u)>=0&&this.requestRender()},g.onerror=()=>{u.imageCanceled||(u.imageError=!0)},g.crossOrigin="anonymous",g.src=l,u.image=g,u}setVertex(e,n){e.uniformMatrix4fv(e.getUniformLocation(n,"u_ProjectionMatrix"),!1,this._projectionMatrix.toArray()),e.uniformMatrix4fv(e.getUniformLocation(n,"u_ViewMatrix4"),!1,this._viewMatrix4.toArray()),e.uniformMatrix4fv(e.getUniformLocation(n,"u_MvpMatrix4"),!1,this._mvpMatrix4.toArray()),e.uniform1f(e.getUniformLocation(n,"u_isOrtho"),this.isOrtho)}requestRender(){this.map&&(this.map.getContext().setDirty(),this.map.setNeedUpdate(!0))}show(){this.isLayerShow=!0,this.update(),this.layer.show()}hide(){this.isLayerShow=!1,this.layer.hide()}getzIndex(){return this.layer.getzIndex()}setzIndex(e){this.options.zIndex=e,this.layer.setzIndex(e)}getOpacity(){return this.layer.getOpacity()}setOpacity(e){this.options.opacity=e,this.layer.setOpacity(e)}getZooms(){return this.layer.getZooms()}setZooms(e){this.options.zooms=e,this.layer.setZooms(e)}setMask(e){this._destroyMaskCache(),this._createMask(e),this.options.mask=e,this.requestRender()}getMask(){return this.options.mask}getMap(){return this.map}_destroyMaskCache(){this.maskCache.forEach(e=>{this.gl.deleteBuffer(e.vertexBuffer),this.gl.deleteBuffer(e.indexBuffer)}),this.maskCache=[]}_destroyTile(e){e.buffer&&this.gl.deleteBuffer(e.buffer),e.texture&&this.gl.deleteTexture(e.texture)}_clearAllCacheTile(){this.tileCache.forEach(e=>{this._destroyTile(e)}),this.tileCache=[]}_clearShowTile(){this.showTiles.forEach(e=>{this.tileCache.findIndex(n=>n.xyzKey===e.xyzKey)<0&&this._destroyTile(e)}),this.showTiles=[]}destroy(){this.isLayerShow=!1,this.map.remove(this.layer),this.map.off("dragging",this.mapCallback),this.map.off("moveend",this.mapCallback),this.map.off("zoomchange",this.mapCallback),this.map.off("rotatechange",this.mapCallback),this._destroyMaskCache(),this._clearShowTile(),this._clearAllCacheTile(),this.gridCache={},this.transformBaidu=null,this.mapCallback=null,this.gl.deleteProgram(this.program),this.gl.deleteProgram(this.maskProgram),this.program=null,this.maskProgram=null,this.options=void 0,this.customCoords=void 0,this.center=void 0,this.layer=null,this.gl=null,this.map=null}}const Km=R({url:{required:!0,type:String},subdomains:{type:Array},tileType:{type:String,default:"xyz",validator:t=>["xyz","bd09"].indexOf(t)!==-1},proj:{type:String,default:"gcj02",validator:t=>["wgs84","gcj02","bd09"].indexOf(t)!==-1},zooms:{type:Object},opacity:{type:Number},zIndex:{type:Number,default:120},mask:{type:Array},cacheSize:{type:Number,default:512},debug:{type:Boolean,default:!1},tileMaxZoom:{type:Number},altitude:{type:Number}});var qe=y.defineComponent({name:"ElAmapLayerCustomXyz",inheritAttrs:!1,__name:"CustomXyz",props:Km,emits:["init"],setup(t,{expose:e,emit:n}){const o=n;let i;const{$$getInstance:a}=B((r,s)=>new Promise(l=>{i=new Xm(s,r),l(i)}),{emits:o,destroyComponent(){i&&(i.destroy(),i=null)}});return e({$$getInstance:a}),(r,s)=>(y.openBlock(),y.createElementBlock("div"))}});qe.__file="src/vue-amap/packages/layer/data/CustomXyz/CustomXyz.vue",qe.install=t=>(t.component(qe.name,qe),t);const qr=qe;var Jm=[li,ui,ci,pi,hi,di,fi,mi,yi,gi,vi,bi,_i,Mi,Ai,xi,Ei,Ci,wi,Si,Oi,ki,Li,$i,Ii,Pi,Ti,Ri,Bi,Ni,Fi,Di,ji,zi,Wi,qi,Ui,Zi,Gi,Yi,Vi,Hi,Xi,Ki,Ji,wa,qr],Ur=_o([...Jm]);function Qm(){return new Promise(t=>{AMap.plugin("AMap.CitySearch",function(){const e=new AMap.CitySearch;t({getLocalCity:()=>new Promise((n,o)=>{e.getLocalCity(function(i,a){i==="complete"&&a.info==="OK"?n(a):o({status:i,result:a})})})})})})}function t0(){return new Promise(t=>{AMap.plugin("AMap.Weather",function(){const e=new AMap.Weather;t({getLive:n=>new Promise((o,i)=>{e.getLive(n,function(a,r){!a&&r.info==="OK"?o(r):i({result:r})})}),getForecast:n=>new Promise((o,i)=>{e.getForecast(n,function(a,r){!a&&r.info==="OK"?o(r):i({result:r})})})})})})}function e0(t){return new Promise(e=>{AMap.plugin("AMap.Geolocation",function(){const n=new AMap.Geolocation(t);e({getCurrentPosition:()=>new Promise((o,i)=>{n.getCurrentPosition(function(a,r){a==="complete"&&r.info==="SUCCESS"?o(r):i({status:a,result:r})})}),getCityInfo:()=>new Promise((o,i)=>{n.getCityInfo(function(a,r){a==="complete"&&r.info==="SUCCESS"?o(r):i({status:a,result:r})})})})})})}const n0=Ur.install;_.ElAmap=li,_.ElAmapBezierCurve=zi,_.ElAmapCircle=Wi,_.ElAmapCircleMarker=Xi,_.ElAmapControlControlBar=ui,_.ElAmapControlGeolocation=Hi,_.ElAmapControlHawkEye=ci,_.ElAmapControlMapType=pi,_.ElAmapControlScale=hi,_.ElAmapControlToolBar=di,_.ElAmapElasticMarker=Ri,_.ElAmapEllipse=qi,_.ElAmapGeojson=Ui,_.ElAmapInfoWindow=mi,_.ElAmapLabelMarker=Bi,_.ElAmapLayerBuildings=Ei,_.ElAmapLayerCanvas=yi,_.ElAmapLayerCustom=gi,_.ElAmapLayerCustomXyz=qr,_.ElAmapLayerDefault=Ci,_.ElAmapLayerDistrict=wi,_.ElAmapLayerDistrictCluster=wa,_.ElAmapLayerFlexible=vi,_.ElAmapLayerGlCustom=bi,_.ElAmapLayerHeatMap=_i,_.ElAmapLayerImage=Mi,_.ElAmapLayerIndoorMap=Si,_.ElAmapLayerLabels=Ai,_.ElAmapLayerMapboxVectorTile=Ii,_.ElAmapLayerRoadNet=Oi,_.ElAmapLayerSatellite=ki,_.ElAmapLayerTile=Li,_.ElAmapLayerTiles3d=Vi,_.ElAmapLayerTraffic=$i,_.ElAmapLayerVector=xi,_.ElAmapLayerVideo=Ki,_.ElAmapLayerWms=Pi,_.ElAmapLayerWmts=Ti,_.ElAmapMarker=Ni,_.ElAmapMarkerCluster=Fi,_.ElAmapMassMarks=Di,_.ElAmapMouseTool=Ji,_.ElAmapPolygon=Zi,_.ElAmapPolyline=Gi,_.ElAmapRectangle=Yi,_.ElAmapSearchBox=fi,_.ElAmapText=ji,_.bd09_To_gcj02=Co,_.bd09_To_gps84=ns,_.bindInstanceEvent=Ye,_.buildProps=R,_.commonProps=Oo,_.convertEventToLowerCase=Ue,_.convertLnglat=Ge,_.default=Ur,_.eventReg=Ze,_.gcj02_To_bd09=Eo,_.gcj02_To_gps84=xo,_.gps84_To_bd09=os,_.gps84_To_gcj02=Ao,_.guid=Rt,_.initAMapApiLoader=Qu,_.install=n0,_.isIndoorMapInstance=Mo,_.isLabelsLayerInstance=Vr,_.isMapInstance=J,_.isOverlayGroupInstance=Q,_.isVectorLayerInstance=et,_.lngLatTo=Jr,_.loadScript=On,_.lonLatToTileNumbers=ts,_.makeInstaller=_o,_.pixelTo=Kr,_.provideKey=Nt,_.registerMixin=as,_.removeInstanceEvent=Ln,_.resetJsApi=Ju,_.tileNumbersToLonLat=es,_.toBounds=Qr,_.toLngLat=Bt,_.toPixel=Hr,_.toSize=Xr,_.upperCamelCase=kn,_.useCitySearch=Qm,_.useGeolocation=e0,_.useRegister=B,_.useWeather=t0,Object.defineProperty(_,"__esModule",{value:!0})});
//# sourceMappingURL=index.min.js.map
